import{r as P}from"./index.CVf8TyFT.js";var Gt={exports:{}},Xe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jn=P,kn=Symbol.for("react.element"),Sn=Symbol.for("react.fragment"),Cn=Object.prototype.hasOwnProperty,An=jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,En={key:!0,ref:!0,__self:!0,__source:!0};function Ht(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Cn.call(t,r)&&!En.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:kn,type:e,key:a,ref:o,props:i,_owner:An.current}}Xe.Fragment=Sn;Xe.jsx=Ht;Xe.jsxs=Ht;Gt.exports=Xe;var s=Gt.exports;const qt=({doc:e,isOpen:t,onClose:n})=>{const[r,i]=P.useState(!1),[a,o]=P.useState(!1),l=p=>{const d=`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${p.filepath}`;return`https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(d)}`},u=p=>{p.key==="Escape"&&n()},c=(p,d=200)=>!p||p.length<=d?p||"":p.substring(0,d)+"...",h=p=>`${(p/1048576).toFixed(1)} MB`,w=p=>{try{return new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Unknown date"}},m=async()=>{if(!(typeof window>"u"))try{const p=e.title||e.filename,d=`https://lonardonifabio.github.io/tech_documents/document/${e.id}`,x=(k=>{if(!k)return"";const D=k.match(/^[^.!?]*[.!?]/);return D?D[0].trim():k.length>100?k.substring(0,97)+"...":k})(e.summary);let _=`🚀 Sharing an insightful AI/Data Science resource!

`;_+=`**${p}**
`,x&&(_+=`${x}

`),e.key_concepts&&e.key_concepts.length>0&&(_+=`💡 Key concepts: ${e.key_concepts.slice(0,2).join(", ")}

`),_+=`🤖 Explore with AI: ${d}

`,_+=`📚 Discover 1100+ AI & Data Science Documents:
`,_+=`🌐 https://lonardonifabio.github.io/tech_documents/

`,e.keywords.slice(0,5).forEach(k=>{_+=`#${k.replace(/\s+/g,"")} `}),_+="#ArtificialIntelligence #DataScience #MachineLearning";const b=encodeURIComponent(_);if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){if(navigator.share)try{await navigator.share({title:`${p}`,text:_,url:d});return}catch(D){console.log("Native sharing failed, using LinkedIn:",D)}const k=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(d)}&text=${b}`;window.open(k,"_blank")}else{const k=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(d)}&text=${b}`;window.open(k,"_blank","width=600,height=600")}}catch(p){console.error("LinkedIn sharing failed:",p)}},y=async()=>{if(typeof window>"u")return;const p=e.title||e.filename,d=`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,g=e.summary||"No summary available",x=`I'd like to discuss this document with you:

Title: ${p}

Summary: ${g}

Document URL: ${d}

Please help me understand and analyze this document.`;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&navigator.share)try{await navigator.share({title:`Talk with AI about: ${p}`,text:x,url:d})}catch{try{await navigator.clipboard.writeText(x),alert("Document information copied to clipboard! You can now paste it into ChatGPT, Gemini, or any AI assistant app.")}catch{alert(`Copy this text to share with your AI assistant:

${x}`)}}else try{await navigator.clipboard.writeText(x),alert("Document information copied to clipboard! You can now paste it into ChatGPT, Gemini, or any AI assistant.")}catch{alert(`Copy this text to share with your AI assistant:

${x}`)}};return P.useEffect(()=>{if(t&&typeof document<"u")return document.addEventListener("keydown",u),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",u),document.body.style.overflow="unset"}},[t]),t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-full max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-800 truncate pr-4",children:e.title||e.filename}),s.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100",title:"Close preview (ESC)",children:"×"})]}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsx("div",{className:"w-80 bg-gray-50 border-r flex flex-col",children:s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📄 Title"}),s.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:e.title||e.filename||"No title available"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"👥 Authors"}),e.authors&&e.authors.length>0?s.jsx("div",{className:"space-y-1",children:e.authors.map((p,d)=>s.jsx("p",{className:"text-sm text-gray-900",children:p},d))}):s.jsx("p",{className:"text-sm text-gray-500 italic",children:"No author information available"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📝 Summary"}),e.summary?s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:a?e.summary:c(e.summary,200)}),e.summary.length>200&&s.jsx("button",{onClick:()=>o(!a),className:"text-blue-600 hover:text-blue-800 text-sm mt-2 font-medium",children:a?"Show less":"Read more"})]}):s.jsx("p",{className:"text-sm text-gray-500 italic",children:"No summary available"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"💡 Key Concepts"}),e.key_concepts&&e.key_concepts.length>0?s.jsx("div",{className:"space-y-2",children:e.key_concepts.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-blue-500",children:s.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:p})},d))}):s.jsx("p",{className:"text-sm text-gray-500 italic",children:"No key concepts available"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🏷️ Keywords"}),e.keywords&&e.keywords.length>0?s.jsx("div",{className:"flex flex-wrap gap-1",children:e.keywords.map((p,d)=>s.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:p},d))}):s.jsx("p",{className:"text-sm text-gray-500 italic",children:"No keywords available"})]}),e.target_audience&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🎯 Target Audience"}),s.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:e.target_audience})]}),e.industry&&e.industry.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🏭 Industry"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.industry.map((p,d)=>s.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:p},d))})]}),e.business_functions&&e.business_functions.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"💼 Business Functions"}),s.jsx("div",{className:"space-y-1",children:e.business_functions.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-green-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.companies&&e.companies.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🏢 Companies"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.companies.map((p,d)=>s.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-medium",children:p},d))})]}),e.technologies&&e.technologies.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"⚙️ Technologies"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.technologies.map((p,d)=>s.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-xs font-medium",children:p},d))})]}),e.use_cases&&e.use_cases.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"💼 Use Cases"}),s.jsx("div",{className:"space-y-1",children:e.use_cases.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-violet-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.processes&&e.processes.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🔄 Processes"}),s.jsx("div",{className:"space-y-1",children:e.processes.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-yellow-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.technical_terms&&e.technical_terms.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🔧 Technical Terms"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.technical_terms.map((p,d)=>s.jsx("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium",children:p},d))})]}),e.methodologies&&e.methodologies.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📋 Methodologies"}),s.jsx("div",{className:"space-y-1",children:e.methodologies.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-cyan-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.tools_mentioned&&e.tools_mentioned.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🛠️ Tools Mentioned"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:e.tools_mentioned.map((p,d)=>s.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:p},d))})]}),e.prerequisites&&e.prerequisites.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📚 Prerequisites"}),s.jsx("div",{className:"space-y-1",children:e.prerequisites.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-pink-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.learning_objectives&&e.learning_objectives.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🎓 Learning Objectives"}),s.jsx("div",{className:"space-y-1",children:e.learning_objectives.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-emerald-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.benefits_mentioned&&e.benefits_mentioned.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"✅ Benefits"}),s.jsx("div",{className:"space-y-1",children:e.benefits_mentioned.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-green-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.challenges_addressed&&e.challenges_addressed.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"⚠️ Challenges Addressed"}),s.jsx("div",{className:"space-y-1",children:e.challenges_addressed.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-red-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.best_practices&&e.best_practices.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"⭐ Best Practices"}),s.jsx("div",{className:"space-y-1",children:e.best_practices.map((p,d)=>s.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-amber-500",children:s.jsx("p",{className:"text-sm text-gray-900",children:p})},d))})]}),e.questions_and_answers&&e.questions_and_answers.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"❓ Questions & Answers"}),s.jsx("div",{className:"space-y-2",children:e.questions_and_answers.map((p,d)=>s.jsx("div",{className:"bg-white p-3 rounded border border-gray-200",children:s.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:p})},d))})]}),s.jsxs("div",{className:"pt-4 border-t",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📊 Document Info"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Category:"}),s.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs",children:e.category||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Difficulty:"}),s.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs",children:e.difficulty||"Unknown"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"File Size:"}),s.jsx("span",{className:"text-gray-900",children:h(e.file_size)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Upload Date:"}),s.jsx("span",{className:"text-gray-900",children:w(e.upload_date)})]})]})]}),s.jsxs("div",{className:"pt-4 border-t space-y-3",children:[s.jsxs("button",{onClick:y,className:"w-full bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white px-4 py-2 rounded-lg transition-all duration-200 text-center text-sm font-medium flex items-center justify-center gap-2 md:hidden shadow-lg",title:"Talk with your AI",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"🤖 Talk with your AI"]}),s.jsxs("button",{onClick:m,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 text-center text-sm font-medium flex items-center justify-center gap-2",title:"Share on LinkedIn",children:[s.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"📤 Share on LinkedIn"]}),s.jsx("a",{href:`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors duration-200 text-center block text-sm font-medium",children:"📥 Download PDF"})]})]})}),s.jsx("div",{className:"flex-1 bg-white",children:r?s.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Unable to load PDF"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"The PDF could not be displayed in the viewer."}),s.jsx("a",{href:`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Download PDF"})]})}):s.jsx("iframe",{src:l(e),className:"w-full h-full border-0",onError:()=>i(!0),title:`Preview of ${e.title||e.filename}`})})]})]})}):null},Tn=({doc:e,autoOpen:t=!1})=>{const[n,r]=P.useState(!1),[i,a]=P.useState(t),o=g=>`/tech_documents/preview/${g.id}.jpg`,l=g=>{const x={AI:{gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",icon:"🤖"},"Machine Learning":{gradient:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",icon:"🧠"},"Data Science":{gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",icon:"📊"},Business:{gradient:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",icon:"💼"},Technology:{gradient:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",icon:"⚙️"},Research:{gradient:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)",icon:"🔬"}},_=x[g.category]||x.Technology;return{background:_.gradient,icon:_.icon}},u=(g,x=40)=>g.length<=x?g:g.substring(0,x-3)+"...",c=(g,x=150)=>g.length<=x?g:g.substring(0,x)+"...",h=g=>new Date(g).toLocaleDateString("en-US"),w=g=>`${(g/1048576).toFixed(1)} MB`,m=g=>{const _=`https://lonardonifabio.github.io/tech_documents/document/${g.id}`,E=g.title||g.filename,A=(z=>{if(!z)return"";const U=z.match(/^[^.!?]*[.!?]/);return U?U[0].trim():z.length>100?z.substring(0,97)+"...":z})(g.summary);let k=`🚀 Sharing an insightful AI/Data Science resource!

`;k+=`**${E}**
`,A&&(k+=`${A}

`),g.key_concepts&&g.key_concepts.length>0&&(k+=`💡 Key concepts: ${g.key_concepts.slice(0,2).join(", ")}

`),k+=`🤖 Explore with AI: ${_}

`,k+=`📚 Discover 1100+ AI & Data Science Documents:
`,k+=`🌐 https://lonardonifabio.github.io/tech_documents/

`,g.keywords.slice(0,5).forEach(z=>{k+=`#${z.replace(/\s+/g,"")} `}),k+="#ArtificialIntelligence #DataScience #MachineLearning";const S=encodeURIComponent(k);if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){const z=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(_)}&text=${S}`;window.open(z,"_blank")}else{const z=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(_)}&text=${S}`;window.open(z,"linkedin-share","width=600,height=600,scrollbars=yes,resizable=yes")}},y=n?e.summary:c(e.summary),p=e.title||e.filename,d=o(e);return l(e),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"border rounded-lg hover:shadow-xl transition-all duration-300 bg-white document-card overflow-hidden h-full flex flex-col",children:[s.jsxs("div",{className:"h-32 w-full relative overflow-hidden",children:[s.jsx("div",{className:"cursor-pointer h-full relative",onClick:()=>a(!0),title:"Click to preview PDF",children:s.jsx("img",{src:d,alt:`Preview of ${p}`,className:"w-full h-full object-cover",style:{backgroundColor:"#f9fafb"}})}),s.jsx("div",{className:"absolute top-2 right-2 z-20",children:s.jsx("span",{className:"bg-white bg-opacity-90 text-gray-800 px-2 py-1 rounded text-xs font-medium",children:e.category})})]}),s.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[s.jsx("h3",{className:"font-semibold text-base mb-2 text-gray-800 line-clamp-2 leading-tight",title:p,children:u(p,60)}),e.authors&&e.authors.length>0&&s.jsx("div",{className:"mb-2",children:s.jsxs("p",{className:"text-sm text-gray-500",children:[s.jsx("span",{className:"font-medium",children:"Authors:"})," ",e.authors.join(", ")]})}),s.jsxs("div",{className:"mb-4 flex-1",children:[s.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:y}),e.summary.length>150&&s.jsx("button",{onClick:()=>r(!n),className:"text-blue-600 text-xs mt-1 hover:underline focus:outline-none font-medium",children:n?"Show less":"Read more"})]}),s.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:e.keywords.map(g=>s.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:g},g))}),s.jsxs("div",{className:"mt-auto space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center text-sm",children:[s.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:e.difficulty}),s.jsx("span",{className:"text-xs text-gray-500",children:h(e.upload_date)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-xs text-gray-500",children:w(e.file_size)}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("button",{onClick:()=>a(!0),className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-medium hover:bg-green-700 transition-colors duration-200",children:"Preview"}),s.jsx("button",{onClick:()=>m(e),className:"bg-blue-600 text-white px-2 py-1 rounded-full text-xs font-medium hover:bg-blue-700 transition-colors duration-200",title:"Share on LinkedIn",children:"Share"}),s.jsx("a",{href:`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-600 text-white px-2 py-1 rounded-full text-xs font-medium hover:bg-gray-700 transition-colors duration-200",children:"Download"})]})]})]})]})]}),s.jsx(qt,{doc:e,isOpen:i,onClose:()=>a(!1)})]})},Dn=({searchTerm:e,setSearchTerm:t,selectedCategory:n,setSelectedCategory:r,selectedDifficulty:i,setSelectedDifficulty:a,categories:o,difficulties:l})=>{const[u,c]=P.useState(!1);return s.jsxs("div",{className:"mb-8 space-y-4 bg-white p-6 rounded-lg shadow-sm border",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"🔍 Search with boolean operators: machine learning AND python OR 'data science' NOT statistics",className:"w-full p-3 pr-12 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",value:e,onChange:h=>t(h.target.value)}),s.jsx("button",{onClick:()=>c(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-blue-500 transition-colors",title:"Search help",children:"❓"})]}),u&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm",children:[s.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔍 Advanced Search Guide"}),s.jsxs("div",{className:"space-y-2 text-blue-700",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"AND:"})," ",s.jsx("span",{className:"bg-gray-200 px-1 rounded",children:"machine learning AND python"})," - Both terms must be present"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"OR:"})," ",s.jsx("span",{className:"bg-gray-200 px-1 rounded",children:"python OR javascript"})," - Either term can be present"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"NOT:"})," ",s.jsx("span",{className:"bg-gray-200 px-1 rounded",children:"data science NOT statistics"}),' - Exclude documents with "statistics"']}),s.jsxs("div",{children:[s.jsx("strong",{children:"Quotes:"})," ",s.jsx("span",{className:"bg-gray-200 px-1 rounded",children:'"machine learning"'})," - Exact phrase search"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Combine:"})," ",s.jsx("span",{className:"bg-gray-200 px-1 rounded",children:'python AND "data science" OR visualization NOT excel'})]})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("select",{className:"p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",value:n,onChange:h=>r(h.target.value),children:[s.jsx("option",{value:"",children:"📂 All categories"}),o.map(h=>s.jsx("option",{value:h,children:h},h))]}),s.jsxs("select",{className:"p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",value:i,onChange:h=>a(h.target.value),children:[s.jsx("option",{value:"",children:"🎯 All levels"}),l.map(h=>s.jsx("option",{value:h,children:h},h))]})]})]})},Mn=()=>s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Loading documents..."})]})}),$n=({error:e,onRetry:t})=>s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[s.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Loading error"}),s.jsx("p",{className:"text-gray-500 mb-4",children:e}),s.jsx("button",{onClick:t,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Retry"})]})}),In=({onKnowledgeGraphClick:e,onFilteredDocumentsChange:t})=>{const[n,r]=P.useState([]),[i,a]=P.useState([]),[o,l]=P.useState([]),[u,c]=P.useState(""),[h,w]=P.useState(""),[m,y]=P.useState(""),[p,d]=P.useState(!0),[g,x]=P.useState(null),[_,E]=P.useState(1),[b,A]=P.useState(!1),[k,D]=P.useState(null),S=20;P.useEffect(()=>{(async()=>{const N=["/tech_documents/data/documents.json","/data/documents.json","./data/documents.json"];for(const C of N)try{console.log(`Trying to fetch from: ${C}`);const M=await fetch(C);if(M.ok){const T=await M.json();console.log("Successfully loaded documents:",T);const I=T.sort((O,F)=>new Date(F.upload_date).getTime()-new Date(O.upload_date).getTime());if(r(I),a(I),d(!1),typeof window<"u"){const F=new URLSearchParams(window.location.search).get("doc");F&&D(F)}return}}catch(M){console.log(`Failed to fetch from ${C}:`,M)}x("Unable to load documents from any path"),d(!1)})()},[]);const R=(j,f)=>{if(!f.trim())return j;const N=T=>{const I=T.split(/\s+(AND|OR|NOT)\s+/i),O=[];for(let F=0;F<I.length;F++){const L=I[F].trim();if(L&&!["AND","OR","NOT"].includes(L.toUpperCase())){const B=L.startsWith('"')&&L.endsWith('"'),X=B?L.slice(1,-1):L;O.push({term:X.toLowerCase(),operator:F>0?I[F-1].toUpperCase():"AND",isQuoted:B,isNegated:F>0&&I[F-1].toUpperCase()==="NOT"})}}return O.length>0?O:[{term:T.toLowerCase(),operator:"AND",isQuoted:!1,isNegated:!1}]},C=(T,I)=>{const{term:O,isQuoted:F}=I,L=[T.filename||"",T.title||"",T.summary||"",(T.authors||[]).join(" "),(T.keywords||[]).join(" ")].map(B=>B.toLowerCase());return F?L.some(B=>B.includes(O)):O.split(/\s+/).every(X=>L.some(K=>K.includes(X)))},M=N(f);return j.filter(T=>{let I=!0,O=!1;for(const L of M){const B=C(T,L);if(L.isNegated){if(B){I=!1;break}}else O=O||B,L.operator==="AND"?I=I&&B:L.operator==="OR"&&(I=I||B)}return M.every(L=>L.isNegated)?I:I&&O})};P.useEffect(()=>{let j=n;u&&(j=R(j,u)),h&&(j=j.filter(f=>f.category===h)),m&&(j=j.filter(f=>f.difficulty===m)),a(j),E(1),t&&t(j)},[u,h,m,n,t]),P.useEffect(()=>{const f=_*S;let N=i.slice(0,f);if(k){const C=n.find(M=>M.id===k);C&&!N.find(M=>M.id===k)&&(N=[C,...N])}l(N)},[i,_,k,n]);const z=async()=>{A(!0),await new Promise(j=>setTimeout(j,500)),E(j=>j+1),A(!1)},U=o.length<i.length,V=i.length<=50,G=[...new Set(n.map(j=>j.category))],v=[...new Set(n.map(j=>j.difficulty))];return p?s.jsx(Mn,{}):g?s.jsx($n,{error:g,onRetry:()=>typeof window<"u"?window.location.reload():void 0}):s.jsx("div",{className:"min-h-screen bg-gray-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[s.jsxs("header",{className:"text-center mb-12 relative",children:[s.jsxs("div",{className:"flex items-center justify-center mb-4",children:[s.jsx("img",{src:"https://www.fabiolonardoni.it/io_ds.png",alt:"Profile",className:"w-16 h-16 rounded-full mr-4 border-2 border-gray-300"}),s.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"AI & Data Science Library"}),s.jsx("div",{className:"text-4xl ml-4",children:"🤖"})]}),s.jsx("p",{className:"text-xl text-gray-600 mb-2",children:"Automated collection of Artificial Intelligence and Data Science documents"}),s.jsxs("p",{className:"text-sm text-gray-500",children:[n.length," documents • Click any document to preview"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Developed by ",s.jsx("a",{href:"https://www.fabiolonardoni.it",className:"text-blue-500 hover:underline",children:"Fabio Lonardoni"})]})]}),s.jsx(Dn,{searchTerm:u,setSearchTerm:c,selectedCategory:h,setSelectedCategory:w,selectedDifficulty:m,setSelectedDifficulty:y,categories:G,difficulties:v}),i.length>0?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600 bg-white px-4 py-2 rounded-lg",children:["📊 Showing ",o.length," of ",i.length," documents",i.length!==n.length&&s.jsxs("span",{className:"text-gray-400",children:[" (filtered from ",n.length," total)"]})]}),s.jsxs("div",{className:`text-xs px-3 py-1 rounded-full ${V?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:["Knowledge Graph: ",V?"Available":"Unavailable"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:o.map(j=>s.jsx(Tn,{doc:j,autoOpen:k===j.id},j.id))}),U&&s.jsx("div",{className:"mt-8 text-center",children:s.jsx("button",{onClick:z,disabled:b,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium",children:b?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):`Load More (${i.length-o.length} remaining)`})})]}):s.jsxs("div",{className:"text-center py-16 bg-white rounded-lg",children:[s.jsx("div",{className:"text-6xl mb-4",children:"📭"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No documents found"}),s.jsx("p",{className:"text-gray-500",children:"Try modifying your search criteria"})]})]})})};class bt extends Map{constructor(t,n=On){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(vt(this,t))}has(t){return super.has(vt(this,t))}set(t,n){return super.set(zn(this,t),n)}delete(t){return super.delete(Pn(this,t))}}function vt({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function zn({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Pn({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function On(e){return e!==null&&typeof e=="object"?e.valueOf():e}var Ln={value:()=>{}};function Ee(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Oe(n)}function Oe(e){this._=e}function Fn(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Oe.prototype=Ee.prototype={constructor:Oe,on:function(e,t){var n=this._,r=Fn(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=Rn(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=wt(n[i],e.name,t);else if(t==null)for(i in n)n[i]=wt(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Oe(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function Rn(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function wt(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Ln,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var nt="http://www.w3.org/1999/xhtml";const _t={svg:"http://www.w3.org/2000/svg",xhtml:nt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ke(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),_t.hasOwnProperty(t)?{space:_t[t],local:e}:e}function Un(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===nt&&t.documentElement.namespaceURI===nt?t.createElement(e):t.createElementNS(n,e)}}function Bn(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Vt(e){var t=Ke(e);return(t.local?Bn:Un)(t)}function Gn(){}function ut(e){return e==null?Gn:function(){return this.querySelector(e)}}function Hn(e){typeof e!="function"&&(e=ut(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,l=r[i]=new Array(o),u,c,h=0;h<o;++h)(u=a[h])&&(c=e.call(u,u.__data__,h,a))&&("__data__"in u&&(c.__data__=u.__data__),l[h]=c);return new J(r,this._parents)}function qn(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Vn(){return[]}function Xt(e){return e==null?Vn:function(){return this.querySelectorAll(e)}}function Xn(e){return function(){return qn(e.apply(this,arguments))}}function Kn(e){typeof e=="function"?e=Xn(e):e=Xt(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],l=o.length,u,c=0;c<l;++c)(u=o[c])&&(r.push(e.call(u,u.__data__,c,o)),i.push(u));return new J(r,i)}function Kt(e){return function(){return this.matches(e)}}function Yt(e){return function(t){return t.matches(e)}}var Yn=Array.prototype.find;function Wn(e){return function(){return Yn.call(this.children,e)}}function Qn(){return this.firstElementChild}function Jn(e){return this.select(e==null?Qn:Wn(typeof e=="function"?e:Yt(e)))}var Zn=Array.prototype.filter;function er(){return Array.from(this.children)}function tr(e){return function(){return Zn.call(this.children,e)}}function nr(e){return this.selectAll(e==null?er:tr(typeof e=="function"?e:Yt(e)))}function rr(e){typeof e!="function"&&(e=Kt(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,l=r[i]=[],u,c=0;c<o;++c)(u=a[c])&&e.call(u,u.__data__,c,a)&&l.push(u);return new J(r,this._parents)}function Wt(e){return new Array(e.length)}function ir(){return new J(this._enter||this._groups.map(Wt),this._parents)}function Ue(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Ue.prototype={constructor:Ue,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function sr(e){return function(){return e}}function ar(e,t,n,r,i,a){for(var o=0,l,u=t.length,c=a.length;o<c;++o)(l=t[o])?(l.__data__=a[o],r[o]=l):n[o]=new Ue(e,a[o]);for(;o<u;++o)(l=t[o])&&(i[o]=l)}function or(e,t,n,r,i,a,o){var l,u,c=new Map,h=t.length,w=a.length,m=new Array(h),y;for(l=0;l<h;++l)(u=t[l])&&(m[l]=y=o.call(u,u.__data__,l,t)+"",c.has(y)?i[l]=u:c.set(y,u));for(l=0;l<w;++l)y=o.call(e,a[l],l,a)+"",(u=c.get(y))?(r[l]=u,u.__data__=a[l],c.delete(y)):n[l]=new Ue(e,a[l]);for(l=0;l<h;++l)(u=t[l])&&c.get(m[l])===u&&(i[l]=u)}function lr(e){return e.__data__}function cr(e,t){if(!arguments.length)return Array.from(this,lr);var n=t?or:ar,r=this._parents,i=this._groups;typeof e!="function"&&(e=sr(e));for(var a=i.length,o=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var h=r[c],w=i[c],m=w.length,y=ur(e.call(h,h&&h.__data__,c,r)),p=y.length,d=l[c]=new Array(p),g=o[c]=new Array(p),x=u[c]=new Array(m);n(h,w,d,g,x,y,t);for(var _=0,E=0,b,A;_<p;++_)if(b=d[_]){for(_>=E&&(E=_+1);!(A=g[E])&&++E<p;);b._next=A||null}}return o=new J(o,r),o._enter=l,o._exit=u,o}function ur(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function hr(){return new J(this._exit||this._groups.map(Wt),this._parents)}function dr(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function fr(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),l=new Array(i),u=0;u<o;++u)for(var c=n[u],h=r[u],w=c.length,m=l[u]=new Array(w),y,p=0;p<w;++p)(y=c[p]||h[p])&&(m[p]=y);for(;u<i;++u)l[u]=n[u];return new J(l,this._parents)}function mr(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function gr(e){e||(e=xr);function t(w,m){return w&&m?e(w.__data__,m.__data__):!w-!m}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],l=o.length,u=i[a]=new Array(l),c,h=0;h<l;++h)(c=o[h])&&(u[h]=c);u.sort(t)}return new J(i,this._parents).order()}function xr(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function pr(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function yr(){return Array.from(this)}function br(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function vr(){let e=0;for(const t of this)++e;return e}function wr(){return!this.node()}function _r(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,l;a<o;++a)(l=i[a])&&e.call(l,l.__data__,a,i);return this}function Nr(e){return function(){this.removeAttribute(e)}}function jr(e){return function(){this.removeAttributeNS(e.space,e.local)}}function kr(e,t){return function(){this.setAttribute(e,t)}}function Sr(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Cr(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Ar(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Er(e,t){var n=Ke(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?jr:Nr:typeof t=="function"?n.local?Ar:Cr:n.local?Sr:kr)(n,t))}function Qt(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Tr(e){return function(){this.style.removeProperty(e)}}function Dr(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Mr(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function $r(e,t,n){return arguments.length>1?this.each((t==null?Tr:typeof t=="function"?Mr:Dr)(e,t,n??"")):ye(this.node(),e)}function ye(e,t){return e.style.getPropertyValue(t)||Qt(e).getComputedStyle(e,null).getPropertyValue(t)}function Ir(e){return function(){delete this[e]}}function zr(e,t){return function(){this[e]=t}}function Pr(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Or(e,t){return arguments.length>1?this.each((t==null?Ir:typeof t=="function"?Pr:zr)(e,t)):this.node()[e]}function Jt(e){return e.trim().split(/^|\s+/)}function ht(e){return e.classList||new Zt(e)}function Zt(e){this._node=e,this._names=Jt(e.getAttribute("class")||"")}Zt.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function en(e,t){for(var n=ht(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function tn(e,t){for(var n=ht(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Lr(e){return function(){en(this,e)}}function Fr(e){return function(){tn(this,e)}}function Rr(e,t){return function(){(t.apply(this,arguments)?en:tn)(this,e)}}function Ur(e,t){var n=Jt(e+"");if(arguments.length<2){for(var r=ht(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Rr:t?Lr:Fr)(n,t))}function Br(){this.textContent=""}function Gr(e){return function(){this.textContent=e}}function Hr(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function qr(e){return arguments.length?this.each(e==null?Br:(typeof e=="function"?Hr:Gr)(e)):this.node().textContent}function Vr(){this.innerHTML=""}function Xr(e){return function(){this.innerHTML=e}}function Kr(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Yr(e){return arguments.length?this.each(e==null?Vr:(typeof e=="function"?Kr:Xr)(e)):this.node().innerHTML}function Wr(){this.nextSibling&&this.parentNode.appendChild(this)}function Qr(){return this.each(Wr)}function Jr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Zr(){return this.each(Jr)}function ei(e){var t=typeof e=="function"?e:Vt(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ti(){return null}function ni(e,t){var n=typeof e=="function"?e:Vt(e),r=t==null?ti:typeof t=="function"?t:ut(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ri(){var e=this.parentNode;e&&e.removeChild(this)}function ii(){return this.each(ri)}function si(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ai(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function oi(e){return this.select(e?ai:si)}function li(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ci(e){return function(t){e.call(this,t,this.__data__)}}function ui(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function hi(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function di(e,t,n){return function(){var r=this.__on,i,a=ci(t);if(r){for(var o=0,l=r.length;o<l;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function fi(e,t,n){var r=ui(e+""),i,a=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,c=l.length,h;u<c;++u)for(i=0,h=l[u];i<a;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(l=t?di:hi,i=0;i<a;++i)this.each(l(r[i],t,n));return this}function nn(e,t,n){var r=Qt(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function mi(e,t){return function(){return nn(this,e,t)}}function gi(e,t){return function(){return nn(this,e,t.apply(this,arguments))}}function xi(e,t){return this.each((typeof t=="function"?gi:mi)(e,t))}function*pi(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var rn=[null];function J(e,t){this._groups=e,this._parents=t}function Te(){return new J([[document.documentElement]],rn)}function yi(){return this}J.prototype=Te.prototype={constructor:J,select:Hn,selectAll:Kn,selectChild:Jn,selectChildren:nr,filter:rr,data:cr,enter:ir,exit:hr,join:dr,merge:fr,selection:yi,order:mr,sort:gr,call:pr,nodes:yr,node:br,size:vr,empty:wr,each:_r,attr:Er,style:$r,property:Or,classed:Ur,text:qr,html:Yr,raise:Qr,lower:Zr,append:ei,insert:ni,remove:ii,clone:oi,datum:li,on:fi,dispatch:xi,[Symbol.iterator]:pi};function ne(e){return typeof e=="string"?new J([[document.querySelector(e)]],[document.documentElement]):new J([[e]],rn)}function bi(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ae(e,t){if(e=bi(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const vi={passive:!1},je={capture:!0,passive:!1};function Je(e){e.stopImmediatePropagation()}function xe(e){e.preventDefault(),e.stopImmediatePropagation()}function sn(e){var t=e.document.documentElement,n=ne(e).on("dragstart.drag",xe,je);"onselectstart"in t?n.on("selectstart.drag",xe,je):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function an(e,t){var n=e.document.documentElement,r=ne(e).on("dragstart.drag",null);t&&(r.on("click.drag",xe,je),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Me=e=>()=>e;function rt(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:a,x:o,y:l,dx:u,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}rt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function wi(e){return!e.ctrlKey&&!e.button}function _i(){return this.parentNode}function Ni(e,t){return t??{x:e.x,y:e.y}}function ji(){return navigator.maxTouchPoints||"ontouchstart"in this}function ki(){var e=wi,t=_i,n=Ni,r=ji,i={},a=Ee("start","drag","end"),o=0,l,u,c,h,w=0;function m(b){b.on("mousedown.drag",y).filter(r).on("touchstart.drag",g).on("touchmove.drag",x,vi).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(b,A){if(!(h||!e.call(this,b,A))){var k=E(this,t.call(this,b,A),b,A,"mouse");k&&(ne(b.view).on("mousemove.drag",p,je).on("mouseup.drag",d,je),sn(b.view),Je(b),c=!1,l=b.clientX,u=b.clientY,k("start",b))}}function p(b){if(xe(b),!c){var A=b.clientX-l,k=b.clientY-u;c=A*A+k*k>w}i.mouse("drag",b)}function d(b){ne(b.view).on("mousemove.drag mouseup.drag",null),an(b.view,c),xe(b),i.mouse("end",b)}function g(b,A){if(e.call(this,b,A)){var k=b.changedTouches,D=t.call(this,b,A),S=k.length,R,z;for(R=0;R<S;++R)(z=E(this,D,b,A,k[R].identifier,k[R]))&&(Je(b),z("start",b,k[R]))}}function x(b){var A=b.changedTouches,k=A.length,D,S;for(D=0;D<k;++D)(S=i[A[D].identifier])&&(xe(b),S("drag",b,A[D]))}function _(b){var A=b.changedTouches,k=A.length,D,S;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),D=0;D<k;++D)(S=i[A[D].identifier])&&(Je(b),S("end",b,A[D]))}function E(b,A,k,D,S,R){var z=a.copy(),U=ae(R||k,A),V,G,v;if((v=n.call(b,new rt("beforestart",{sourceEvent:k,target:m,identifier:S,active:o,x:U[0],y:U[1],dx:0,dy:0,dispatch:z}),D))!=null)return V=v.x-U[0]||0,G=v.y-U[1]||0,function j(f,N,C){var M=U,T;switch(f){case"start":i[S]=j,T=o++;break;case"end":delete i[S],--o;case"drag":U=ae(C||N,A),T=o;break}z.call(f,b,new rt(f,{sourceEvent:N,subject:v,target:m,identifier:S,active:T,x:U[0]+V,y:U[1]+G,dx:U[0]-M[0],dy:U[1]-M[1],dispatch:z}),D)}}return m.filter=function(b){return arguments.length?(e=typeof b=="function"?b:Me(!!b),m):e},m.container=function(b){return arguments.length?(t=typeof b=="function"?b:Me(b),m):t},m.subject=function(b){return arguments.length?(n=typeof b=="function"?b:Me(b),m):n},m.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:Me(!!b),m):r},m.on=function(){var b=a.on.apply(a,arguments);return b===a?m:b},m.clickDistance=function(b){return arguments.length?(w=(b=+b)*b,m):Math.sqrt(w)},m}function dt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function on(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function De(){}var ke=.7,Be=1/ke,pe="\\s*([+-]?\\d+)\\s*",Se="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Si=/^#([0-9a-f]{3,8})$/,Ci=new RegExp(`^rgb\\(${pe},${pe},${pe}\\)$`),Ai=new RegExp(`^rgb\\(${re},${re},${re}\\)$`),Ei=new RegExp(`^rgba\\(${pe},${pe},${pe},${Se}\\)$`),Ti=new RegExp(`^rgba\\(${re},${re},${re},${Se}\\)$`),Di=new RegExp(`^hsl\\(${Se},${re},${re}\\)$`),Mi=new RegExp(`^hsla\\(${Se},${re},${re},${Se}\\)$`),Nt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dt(De,Ce,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:jt,formatHex:jt,formatHex8:$i,formatHsl:Ii,formatRgb:kt,toString:kt});function jt(){return this.rgb().formatHex()}function $i(){return this.rgb().formatHex8()}function Ii(){return ln(this).formatHsl()}function kt(){return this.rgb().formatRgb()}function Ce(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Si.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?St(t):n===3?new Q(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$e(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$e(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Ci.exec(e))?new Q(t[1],t[2],t[3],1):(t=Ai.exec(e))?new Q(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ei.exec(e))?$e(t[1],t[2],t[3],t[4]):(t=Ti.exec(e))?$e(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Di.exec(e))?Et(t[1],t[2]/100,t[3]/100,1):(t=Mi.exec(e))?Et(t[1],t[2]/100,t[3]/100,t[4]):Nt.hasOwnProperty(e)?St(Nt[e]):e==="transparent"?new Q(NaN,NaN,NaN,0):null}function St(e){return new Q(e>>16&255,e>>8&255,e&255,1)}function $e(e,t,n,r){return r<=0&&(e=t=n=NaN),new Q(e,t,n,r)}function zi(e){return e instanceof De||(e=Ce(e)),e?(e=e.rgb(),new Q(e.r,e.g,e.b,e.opacity)):new Q}function it(e,t,n,r){return arguments.length===1?zi(e):new Q(e,t,n,r??1)}function Q(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}dt(Q,it,on(De,{brighter(e){return e=e==null?Be:Math.pow(Be,e),new Q(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ke:Math.pow(ke,e),new Q(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Q(de(this.r),de(this.g),de(this.b),Ge(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ct,formatHex:Ct,formatHex8:Pi,formatRgb:At,toString:At}));function Ct(){return`#${he(this.r)}${he(this.g)}${he(this.b)}`}function Pi(){return`#${he(this.r)}${he(this.g)}${he(this.b)}${he((isNaN(this.opacity)?1:this.opacity)*255)}`}function At(){const e=Ge(this.opacity);return`${e===1?"rgb(":"rgba("}${de(this.r)}, ${de(this.g)}, ${de(this.b)}${e===1?")":`, ${e})`}`}function Ge(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function de(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function he(e){return e=de(e),(e<16?"0":"")+e.toString(16)}function Et(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ee(e,t,n,r)}function ln(e){if(e instanceof ee)return new ee(e.h,e.s,e.l,e.opacity);if(e instanceof De||(e=Ce(e)),!e)return new ee;if(e instanceof ee)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,l=a-i,u=(a+i)/2;return l?(t===a?o=(n-r)/l+(n<r)*6:n===a?o=(r-t)/l+2:o=(t-n)/l+4,l/=u<.5?a+i:2-a-i,o*=60):l=u>0&&u<1?0:o,new ee(o,l,u,e.opacity)}function Oi(e,t,n,r){return arguments.length===1?ln(e):new ee(e,t,n,r??1)}function ee(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}dt(ee,Oi,on(De,{brighter(e){return e=e==null?Be:Math.pow(Be,e),new ee(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ke:Math.pow(ke,e),new ee(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Q(Ze(e>=240?e-240:e+120,i,r),Ze(e,i,r),Ze(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ee(Tt(this.h),Ie(this.s),Ie(this.l),Ge(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ge(this.opacity);return`${e===1?"hsl(":"hsla("}${Tt(this.h)}, ${Ie(this.s)*100}%, ${Ie(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Tt(e){return e=(e||0)%360,e<0?e+360:e}function Ie(e){return Math.max(0,Math.min(1,e||0))}function Ze(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const cn=e=>()=>e;function Li(e,t){return function(n){return e+n*t}}function Fi(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ri(e){return(e=+e)==1?un:function(t,n){return n-t?Fi(t,n,e):cn(isNaN(t)?n:t)}}function un(e,t){var n=t-e;return n?Li(e,n):cn(isNaN(e)?t:e)}const Dt=function e(t){var n=Ri(t);function r(i,a){var o=n((i=it(i)).r,(a=it(a)).r),l=n(i.g,a.g),u=n(i.b,a.b),c=un(i.opacity,a.opacity);return function(h){return i.r=o(h),i.g=l(h),i.b=u(h),i.opacity=c(h),i+""}}return r.gamma=e,r}(1);function ce(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var st=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,et=new RegExp(st.source,"g");function Ui(e){return function(){return e}}function Bi(e){return function(t){return e(t)+""}}function Gi(e,t){var n=st.lastIndex=et.lastIndex=0,r,i,a,o=-1,l=[],u=[];for(e=e+"",t=t+"";(r=st.exec(e))&&(i=et.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),l[o]?l[o]+=a:l[++o]=a),(r=r[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,u.push({i:o,x:ce(r,i)})),n=et.lastIndex;return n<t.length&&(a=t.slice(n),l[o]?l[o]+=a:l[++o]=a),l.length<2?u[0]?Bi(u[0].x):Ui(t):(t=u.length,function(c){for(var h=0,w;h<t;++h)l[(w=u[h]).i]=w.x(c);return l.join("")})}var Mt=180/Math.PI,at={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hn(e,t,n,r,i,a){var o,l,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,u/=l),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Mt,skewX:Math.atan(u)*Mt,scaleX:o,scaleY:l}}var ze;function Hi(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?at:hn(t.a,t.b,t.c,t.d,t.e,t.f)}function qi(e){return e==null||(ze||(ze=document.createElementNS("http://www.w3.org/2000/svg","g")),ze.setAttribute("transform",e),!(e=ze.transform.baseVal.consolidate()))?at:(e=e.matrix,hn(e.a,e.b,e.c,e.d,e.e,e.f))}function dn(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function a(c,h,w,m,y,p){if(c!==w||h!==m){var d=y.push("translate(",null,t,null,n);p.push({i:d-4,x:ce(c,w)},{i:d-2,x:ce(h,m)})}else(w||m)&&y.push("translate("+w+t+m+n)}function o(c,h,w,m){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),m.push({i:w.push(i(w)+"rotate(",null,r)-2,x:ce(c,h)})):h&&w.push(i(w)+"rotate("+h+r)}function l(c,h,w,m){c!==h?m.push({i:w.push(i(w)+"skewX(",null,r)-2,x:ce(c,h)}):h&&w.push(i(w)+"skewX("+h+r)}function u(c,h,w,m,y,p){if(c!==w||h!==m){var d=y.push(i(y)+"scale(",null,",",null,")");p.push({i:d-4,x:ce(c,w)},{i:d-2,x:ce(h,m)})}else(w!==1||m!==1)&&y.push(i(y)+"scale("+w+","+m+")")}return function(c,h){var w=[],m=[];return c=e(c),h=e(h),a(c.translateX,c.translateY,h.translateX,h.translateY,w,m),o(c.rotate,h.rotate,w,m),l(c.skewX,h.skewX,w,m),u(c.scaleX,c.scaleY,h.scaleX,h.scaleY,w,m),c=h=null,function(y){for(var p=-1,d=m.length,g;++p<d;)w[(g=m[p]).i]=g.x(y);return w.join("")}}}var Vi=dn(Hi,"px, ","px)","deg)"),Xi=dn(qi,", ",")",")"),Ki=1e-12;function $t(e){return((e=Math.exp(e))+1/e)/2}function Yi(e){return((e=Math.exp(e))-1/e)/2}function Wi(e){return((e=Math.exp(2*e))-1)/(e+1)}const Qi=function e(t,n,r){function i(a,o){var l=a[0],u=a[1],c=a[2],h=o[0],w=o[1],m=o[2],y=h-l,p=w-u,d=y*y+p*p,g,x;if(d<Ki)x=Math.log(m/c)/t,g=function(D){return[l+D*y,u+D*p,c*Math.exp(t*D*x)]};else{var _=Math.sqrt(d),E=(m*m-c*c+r*d)/(2*c*n*_),b=(m*m-c*c-r*d)/(2*m*n*_),A=Math.log(Math.sqrt(E*E+1)-E),k=Math.log(Math.sqrt(b*b+1)-b);x=(k-A)/t,g=function(D){var S=D*x,R=$t(A),z=c/(n*_)*(R*Wi(t*S+A)-Yi(A));return[l+z*y,u+z*p,c*R/$t(t*S+A)]}}return g.duration=x*1e3*t/Math.SQRT2,g}return i.rho=function(a){var o=Math.max(.001,+a),l=o*o,u=l*l;return e(o,l,u)},i}(Math.SQRT2,2,4);var be=0,_e=0,ve=0,fn=1e3,He,Ne,qe=0,me=0,Ye=0,Ae=typeof performance=="object"&&performance.now?performance:Date,mn=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ft(){return me||(mn(Ji),me=Ae.now()+Ye)}function Ji(){me=0}function Ve(){this._call=this._time=this._next=null}Ve.prototype=mt.prototype={constructor:Ve,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ft():+n)+(t==null?0:+t),!this._next&&Ne!==this&&(Ne?Ne._next=this:He=this,Ne=this),this._call=e,this._time=n,ot()},stop:function(){this._call&&(this._call=null,this._time=1/0,ot())}};function mt(e,t,n){var r=new Ve;return r.restart(e,t,n),r}function Zi(){ft(),++be;for(var e=He,t;e;)(t=me-e._time)>=0&&e._call.call(void 0,t),e=e._next;--be}function It(){me=(qe=Ae.now())+Ye,be=_e=0;try{Zi()}finally{be=0,ts(),me=0}}function es(){var e=Ae.now(),t=e-qe;t>fn&&(Ye-=t,qe=e)}function ts(){for(var e,t=He,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:He=n);Ne=e,ot(r)}function ot(e){if(!be){_e&&(_e=clearTimeout(_e));var t=e-me;t>24?(e<1/0&&(_e=setTimeout(It,e-Ae.now()-Ye)),ve&&(ve=clearInterval(ve))):(ve||(qe=Ae.now(),ve=setInterval(es,fn)),be=1,mn(It))}}function zt(e,t,n){var r=new Ve;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var ns=Ee("start","end","cancel","interrupt"),rs=[],gn=0,Pt=1,lt=2,Le=3,Ot=4,ct=5,Fe=6;function We(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;is(e,n,{name:t,index:r,group:i,on:ns,tween:rs,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:gn})}function gt(e,t){var n=te(e,t);if(n.state>gn)throw new Error("too late; already scheduled");return n}function ie(e,t){var n=te(e,t);if(n.state>Le)throw new Error("too late; already running");return n}function te(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function is(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=mt(a,0,n.time);function a(c){n.state=Pt,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var h,w,m,y;if(n.state!==Pt)return u();for(h in r)if(y=r[h],y.name===n.name){if(y.state===Le)return zt(o);y.state===Ot?(y.state=Fe,y.timer.stop(),y.on.call("interrupt",e,e.__data__,y.index,y.group),delete r[h]):+h<t&&(y.state=Fe,y.timer.stop(),y.on.call("cancel",e,e.__data__,y.index,y.group),delete r[h])}if(zt(function(){n.state===Le&&(n.state=Ot,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=lt,n.on.call("start",e,e.__data__,n.index,n.group),n.state===lt){for(n.state=Le,i=new Array(m=n.tween.length),h=0,w=-1;h<m;++h)(y=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++w]=y);i.length=w+1}}function l(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=ct,1),w=-1,m=i.length;++w<m;)i[w].call(e,h);n.state===ct&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=Fe,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function Re(e,t){var n=e.__transition,r,i,a=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>lt&&r.state<ct,r.state=Fe,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function ss(e){return this.each(function(){Re(this,e)})}function as(e,t){var n,r;return function(){var i=ie(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,l=r.length;o<l;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function os(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=ie(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var l={name:t,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===t){i[u]=l;break}u===c&&i.push(l)}a.tween=i}}function ls(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=te(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?as:os)(n,e,t))}function xt(e,t,n){var r=e._id;return e.each(function(){var i=ie(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return te(i,r).value[t]}}function xn(e,t){var n;return(typeof t=="number"?ce:t instanceof Ce?Dt:(n=Ce(t))?(t=n,Dt):Gi)(e,t)}function cs(e){return function(){this.removeAttribute(e)}}function us(e){return function(){this.removeAttributeNS(e.space,e.local)}}function hs(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function ds(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function fs(e,t,n){var r,i,a;return function(){var o,l=n(this),u;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),u=l+"",o===u?null:o===r&&u===i?a:(i=u,a=t(r=o,l)))}}function ms(e,t,n){var r,i,a;return function(){var o,l=n(this),u;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),u=l+"",o===u?null:o===r&&u===i?a:(i=u,a=t(r=o,l)))}}function gs(e,t){var n=Ke(e),r=n==="transform"?Xi:xn;return this.attrTween(e,typeof t=="function"?(n.local?ms:fs)(n,r,xt(this,"attr."+e,t)):t==null?(n.local?us:cs)(n):(n.local?ds:hs)(n,r,t))}function xs(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ps(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ys(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&ps(e,a)),n}return i._value=t,i}function bs(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&xs(e,a)),n}return i._value=t,i}function vs(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Ke(e);return this.tween(n,(r.local?ys:bs)(r,t))}function ws(e,t){return function(){gt(this,e).delay=+t.apply(this,arguments)}}function _s(e,t){return t=+t,function(){gt(this,e).delay=t}}function Ns(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ws:_s)(t,e)):te(this.node(),t).delay}function js(e,t){return function(){ie(this,e).duration=+t.apply(this,arguments)}}function ks(e,t){return t=+t,function(){ie(this,e).duration=t}}function Ss(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?js:ks)(t,e)):te(this.node(),t).duration}function Cs(e,t){if(typeof t!="function")throw new Error;return function(){ie(this,e).ease=t}}function As(e){var t=this._id;return arguments.length?this.each(Cs(t,e)):te(this.node(),t).ease}function Es(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ie(this,e).ease=n}}function Ts(e){if(typeof e!="function")throw new Error;return this.each(Es(this._id,e))}function Ds(e){typeof e!="function"&&(e=Kt(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,l=r[i]=[],u,c=0;c<o;++c)(u=a[c])&&e.call(u,u.__data__,c,a)&&l.push(u);return new le(r,this._parents,this._name,this._id)}function Ms(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),l=0;l<a;++l)for(var u=t[l],c=n[l],h=u.length,w=o[l]=new Array(h),m,y=0;y<h;++y)(m=u[y]||c[y])&&(w[y]=m);for(;l<r;++l)o[l]=t[l];return new le(o,this._parents,this._name,this._id)}function $s(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Is(e,t,n){var r,i,a=$s(t)?gt:ie;return function(){var o=a(this,e),l=o.on;l!==r&&(i=(r=l).copy()).on(t,n),o.on=i}}function zs(e,t){var n=this._id;return arguments.length<2?te(this.node(),n).on.on(e):this.each(Is(n,e,t))}function Ps(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Os(){return this.on("end.remove",Ps(this._id))}function Ls(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ut(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var l=r[o],u=l.length,c=a[o]=new Array(u),h,w,m=0;m<u;++m)(h=l[m])&&(w=e.call(h,h.__data__,m,l))&&("__data__"in h&&(w.__data__=h.__data__),c[m]=w,We(c[m],t,n,m,c,te(h,n)));return new le(a,this._parents,t,n)}function Fs(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Xt(e));for(var r=this._groups,i=r.length,a=[],o=[],l=0;l<i;++l)for(var u=r[l],c=u.length,h,w=0;w<c;++w)if(h=u[w]){for(var m=e.call(h,h.__data__,w,u),y,p=te(h,n),d=0,g=m.length;d<g;++d)(y=m[d])&&We(y,t,n,d,m,p);a.push(m),o.push(h)}return new le(a,o,t,n)}var Rs=Te.prototype.constructor;function Us(){return new Rs(this._groups,this._parents)}function Bs(e,t){var n,r,i;return function(){var a=ye(this,e),o=(this.style.removeProperty(e),ye(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function pn(e){return function(){this.style.removeProperty(e)}}function Gs(e,t,n){var r,i=n+"",a;return function(){var o=ye(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function Hs(e,t,n){var r,i,a;return function(){var o=ye(this,e),l=n(this),u=l+"";return l==null&&(u=l=(this.style.removeProperty(e),ye(this,e))),o===u?null:o===r&&u===i?a:(i=u,a=t(r=o,l))}}function qs(e,t){var n,r,i,a="style."+t,o="end."+a,l;return function(){var u=ie(this,e),c=u.on,h=u.value[a]==null?l||(l=pn(t)):void 0;(c!==n||i!==h)&&(r=(n=c).copy()).on(o,i=h),u.on=r}}function Vs(e,t,n){var r=(e+="")=="transform"?Vi:xn;return t==null?this.styleTween(e,Bs(e,r)).on("end.style."+e,pn(e)):typeof t=="function"?this.styleTween(e,Hs(e,r,xt(this,"style."+e,t))).each(qs(this._id,e)):this.styleTween(e,Gs(e,r,t),n).on("end.style."+e,null)}function Xs(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Ks(e,t,n){var r,i;function a(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&Xs(e,o,n)),r}return a._value=t,a}function Ys(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Ks(e,t,n??""))}function Ws(e){return function(){this.textContent=e}}function Qs(e){return function(){var t=e(this);this.textContent=t??""}}function Js(e){return this.tween("text",typeof e=="function"?Qs(xt(this,"text",e)):Ws(e==null?"":e+""))}function Zs(e){return function(t){this.textContent=e.call(this,t)}}function ea(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&Zs(i)),t}return r._value=e,r}function ta(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,ea(e))}function na(){for(var e=this._name,t=this._id,n=yn(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],l=o.length,u,c=0;c<l;++c)if(u=o[c]){var h=te(u,t);We(u,e,n,c,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new le(r,this._parents,e,n)}function ra(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var l={value:o},u={value:function(){--i===0&&a()}};n.each(function(){var c=ie(this,r),h=c.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(u)),c.on=t}),i===0&&a()})}var ia=0;function le(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function yn(){return++ia}var se=Te.prototype;le.prototype={constructor:le,select:Ls,selectAll:Fs,selectChild:se.selectChild,selectChildren:se.selectChildren,filter:Ds,merge:Ms,selection:Us,transition:na,call:se.call,nodes:se.nodes,node:se.node,size:se.size,empty:se.empty,each:se.each,on:zs,attr:gs,attrTween:vs,style:Vs,styleTween:Ys,text:Js,textTween:ta,remove:Os,tween:ls,delay:Ns,duration:Ss,ease:As,easeVarying:Ts,end:ra,[Symbol.iterator]:se[Symbol.iterator]};function sa(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var aa={time:null,delay:0,duration:250,ease:sa};function oa(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function la(e){var t,n;e instanceof le?(t=e._id,e=e._name):(t=yn(),(n=aa).time=ft(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],l=o.length,u,c=0;c<l;++c)(u=o[c])&&We(u,e,t,c,o,n||oa(u,t));return new le(r,this._parents,e,t)}Te.prototype.interrupt=ss;Te.prototype.transition=la;function ca(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,l,u=0,c=0;for(a=0;a<o;++a)l=n[a],u+=l.x,c+=l.y;for(u=(u/o-e)*r,c=(c/o-t)*r,a=0;a<o;++a)l=n[a],l.x-=u,l.y-=c}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function ua(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return bn(this.cover(t,n),t,n,e)}function bn(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},l=e._x0,u=e._y0,c=e._x1,h=e._y1,w,m,y,p,d,g,x,_;if(!a)return e._root=o,e;for(;a.length;)if((d=t>=(w=(l+c)/2))?l=w:c=w,(g=n>=(m=(u+h)/2))?u=m:h=m,i=a,!(a=a[x=g<<1|d]))return i[x]=o,e;if(y=+e._x.call(null,a.data),p=+e._y.call(null,a.data),t===y&&n===p)return o.next=a,i?i[x]=o:e._root=o,e;do i=i?i[x]=new Array(4):e._root=new Array(4),(d=t>=(w=(l+c)/2))?l=w:c=w,(g=n>=(m=(u+h)/2))?u=m:h=m;while((x=g<<1|d)===(_=(p>=m)<<1|y>=w));return i[_]=a,i[x]=o,e}function ha(e){var t,n,r=e.length,i,a,o=new Array(r),l=new Array(r),u=1/0,c=1/0,h=-1/0,w=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,l[n]=a,i<u&&(u=i),i>h&&(h=i),a<c&&(c=a),a>w&&(w=a));if(u>h||c>w)return this;for(this.cover(u,c).cover(h,w),n=0;n<r;++n)bn(this,o[n],l[n],e[n]);return this}function da(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,l=this._root,u,c;n>e||e>=i||r>t||t>=a;)switch(c=(t<r)<<1|e<n,u=new Array(4),u[c]=l,l=u,o*=2,c){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function fa(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function ma(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Y(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function ga(e,t,n){var r,i=this._x0,a=this._y0,o,l,u,c,h=this._x1,w=this._y1,m=[],y=this._root,p,d;for(y&&m.push(new Y(y,i,a,h,w)),n==null?n=1/0:(i=e-n,a=t-n,h=e+n,w=t+n,n*=n);p=m.pop();)if(!(!(y=p.node)||(o=p.x0)>h||(l=p.y0)>w||(u=p.x1)<i||(c=p.y1)<a))if(y.length){var g=(o+u)/2,x=(l+c)/2;m.push(new Y(y[3],g,x,u,c),new Y(y[2],o,x,g,c),new Y(y[1],g,l,u,x),new Y(y[0],o,l,g,x)),(d=(t>=x)<<1|e>=g)&&(p=m[m.length-1],m[m.length-1]=m[m.length-1-d],m[m.length-1-d]=p)}else{var _=e-+this._x.call(null,y.data),E=t-+this._y.call(null,y.data),b=_*_+E*E;if(b<n){var A=Math.sqrt(n=b);i=e-A,a=t-A,h=e+A,w=t+A,r=y.data}}return r}function xa(e){if(isNaN(h=+this._x.call(null,e))||isNaN(w=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,l=this._y0,u=this._x1,c=this._y1,h,w,m,y,p,d,g,x;if(!n)return this;if(n.length)for(;;){if((p=h>=(m=(o+u)/2))?o=m:u=m,(d=w>=(y=(l+c)/2))?l=y:c=y,t=n,!(n=n[g=d<<1|p]))return this;if(!n.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(r=t,x=g)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[g]=a:delete t[g],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[x]=n:this._root=n),this):(this._root=a,this)}function pa(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function ya(){return this._root}function ba(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function va(e){var t=[],n,r=this._root,i,a,o,l,u;for(r&&t.push(new Y(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,l=n.x1,u=n.y1)&&r.length){var c=(a+l)/2,h=(o+u)/2;(i=r[3])&&t.push(new Y(i,c,h,l,u)),(i=r[2])&&t.push(new Y(i,a,h,c,u)),(i=r[1])&&t.push(new Y(i,c,o,l,h)),(i=r[0])&&t.push(new Y(i,a,o,c,h))}return this}function wa(e){var t=[],n=[],r;for(this._root&&t.push(new Y(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,l=r.y0,u=r.x1,c=r.y1,h=(o+u)/2,w=(l+c)/2;(a=i[0])&&t.push(new Y(a,o,l,h,w)),(a=i[1])&&t.push(new Y(a,h,l,u,w)),(a=i[2])&&t.push(new Y(a,o,w,h,c)),(a=i[3])&&t.push(new Y(a,h,w,u,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function _a(e){return e[0]}function Na(e){return arguments.length?(this._x=e,this):this._x}function ja(e){return e[1]}function ka(e){return arguments.length?(this._y=e,this):this._y}function pt(e,t,n){var r=new yt(t??_a,n??ja,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function yt(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Lt(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var W=pt.prototype=yt.prototype;W.copy=function(){var e=new yt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Lt(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=Lt(r));return e};W.add=ua;W.addAll=ha;W.cover=da;W.data=fa;W.extent=ma;W.find=ga;W.remove=xa;W.removeAll=pa;W.root=ya;W.size=ba;W.visit=va;W.visitAfter=wa;W.x=Na;W.y=ka;function fe(e){return function(){return e}}function ue(e){return(e()-.5)*1e-6}function Sa(e){return e.x+e.vx}function Ca(e){return e.y+e.vy}function Aa(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=fe(e==null?1:+e));function o(){for(var c,h=t.length,w,m,y,p,d,g,x=0;x<a;++x)for(w=pt(t,Sa,Ca).visitAfter(l),c=0;c<h;++c)m=t[c],d=n[m.index],g=d*d,y=m.x+m.vx,p=m.y+m.vy,w.visit(_);function _(E,b,A,k,D){var S=E.data,R=E.r,z=d+R;if(S){if(S.index>m.index){var U=y-S.x-S.vx,V=p-S.y-S.vy,G=U*U+V*V;G<z*z&&(U===0&&(U=ue(r),G+=U*U),V===0&&(V=ue(r),G+=V*V),G=(z-(G=Math.sqrt(G)))/G*i,m.vx+=(U*=G)*(z=(R*=R)/(g+R)),m.vy+=(V*=G)*z,S.vx-=U*(z=1-z),S.vy-=V*z)}return}return b>y+z||k<y-z||A>p+z||D<p-z}}function l(c){if(c.data)return c.r=n[c.data.index];for(var h=c.r=0;h<4;++h)c[h]&&c[h].r>c.r&&(c.r=c[h].r)}function u(){if(t){var c,h=t.length,w;for(n=new Array(h),c=0;c<h;++c)w=t[c],n[w.index]=+e(w,c,t)}}return o.initialize=function(c,h){t=c,r=h,u()},o.iterations=function(c){return arguments.length?(a=+c,o):a},o.strength=function(c){return arguments.length?(i=+c,o):i},o.radius=function(c){return arguments.length?(e=typeof c=="function"?c:fe(+c),u(),o):e},o}function Ea(e){return e.index}function Ft(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Ta(e){var t=Ea,n=w,r,i=fe(30),a,o,l,u,c,h=1;e==null&&(e=[]);function w(g){return 1/Math.min(l[g.source.index],l[g.target.index])}function m(g){for(var x=0,_=e.length;x<h;++x)for(var E=0,b,A,k,D,S,R,z;E<_;++E)b=e[E],A=b.source,k=b.target,D=k.x+k.vx-A.x-A.vx||ue(c),S=k.y+k.vy-A.y-A.vy||ue(c),R=Math.sqrt(D*D+S*S),R=(R-a[E])/R*g*r[E],D*=R,S*=R,k.vx-=D*(z=u[E]),k.vy-=S*z,A.vx+=D*(z=1-z),A.vy+=S*z}function y(){if(o){var g,x=o.length,_=e.length,E=new Map(o.map((A,k)=>[t(A,k,o),A])),b;for(g=0,l=new Array(x);g<_;++g)b=e[g],b.index=g,typeof b.source!="object"&&(b.source=Ft(E,b.source)),typeof b.target!="object"&&(b.target=Ft(E,b.target)),l[b.source.index]=(l[b.source.index]||0)+1,l[b.target.index]=(l[b.target.index]||0)+1;for(g=0,u=new Array(_);g<_;++g)b=e[g],u[g]=l[b.source.index]/(l[b.source.index]+l[b.target.index]);r=new Array(_),p(),a=new Array(_),d()}}function p(){if(o)for(var g=0,x=e.length;g<x;++g)r[g]=+n(e[g],g,e)}function d(){if(o)for(var g=0,x=e.length;g<x;++g)a[g]=+i(e[g],g,e)}return m.initialize=function(g,x){o=g,c=x,y()},m.links=function(g){return arguments.length?(e=g,y(),m):e},m.id=function(g){return arguments.length?(t=g,m):t},m.iterations=function(g){return arguments.length?(h=+g,m):h},m.strength=function(g){return arguments.length?(n=typeof g=="function"?g:fe(+g),p(),m):n},m.distance=function(g){return arguments.length?(i=typeof g=="function"?g:fe(+g),d(),m):i},m}const Da=1664525,Ma=1013904223,Rt=4294967296;function $a(){let e=1;return()=>(e=(Da*e+Ma)%Rt)/Rt}function Ia(e){return e.x}function za(e){return e.y}var Pa=10,Oa=Math.PI*(3-Math.sqrt(5));function La(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,l=new Map,u=mt(w),c=Ee("tick","end"),h=$a();e==null&&(e=[]);function w(){m(),c.call("tick",t),n<r&&(u.stop(),c.call("end",t))}function m(d){var g,x=e.length,_;d===void 0&&(d=1);for(var E=0;E<d;++E)for(n+=(a-n)*i,l.forEach(function(b){b(n)}),g=0;g<x;++g)_=e[g],_.fx==null?_.x+=_.vx*=o:(_.x=_.fx,_.vx=0),_.fy==null?_.y+=_.vy*=o:(_.y=_.fy,_.vy=0);return t}function y(){for(var d=0,g=e.length,x;d<g;++d){if(x=e[d],x.index=d,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),isNaN(x.x)||isNaN(x.y)){var _=Pa*Math.sqrt(.5+d),E=d*Oa;x.x=_*Math.cos(E),x.y=_*Math.sin(E)}(isNaN(x.vx)||isNaN(x.vy))&&(x.vx=x.vy=0)}}function p(d){return d.initialize&&d.initialize(e,h),d}return y(),t={tick:m,restart:function(){return u.restart(w),t},stop:function(){return u.stop(),t},nodes:function(d){return arguments.length?(e=d,y(),l.forEach(p),t):e},alpha:function(d){return arguments.length?(n=+d,t):n},alphaMin:function(d){return arguments.length?(r=+d,t):r},alphaDecay:function(d){return arguments.length?(i=+d,t):+i},alphaTarget:function(d){return arguments.length?(a=+d,t):a},velocityDecay:function(d){return arguments.length?(o=1-d,t):1-o},randomSource:function(d){return arguments.length?(h=d,l.forEach(p),t):h},force:function(d,g){return arguments.length>1?(g==null?l.delete(d):l.set(d,p(g)),t):l.get(d)},find:function(d,g,x){var _=0,E=e.length,b,A,k,D,S;for(x==null?x=1/0:x*=x,_=0;_<E;++_)D=e[_],b=d-D.x,A=g-D.y,k=b*b+A*A,k<x&&(S=D,x=k);return S},on:function(d,g){return arguments.length>1?(c.on(d,g),t):c.on(d)}}}function Fa(){var e,t,n,r,i=fe(-30),a,o=1,l=1/0,u=.81;function c(y){var p,d=e.length,g=pt(e,Ia,za).visitAfter(w);for(r=y,p=0;p<d;++p)t=e[p],g.visit(m)}function h(){if(e){var y,p=e.length,d;for(a=new Array(p),y=0;y<p;++y)d=e[y],a[d.index]=+i(d,y,e)}}function w(y){var p=0,d,g,x=0,_,E,b;if(y.length){for(_=E=b=0;b<4;++b)(d=y[b])&&(g=Math.abs(d.value))&&(p+=d.value,x+=g,_+=g*d.x,E+=g*d.y);y.x=_/x,y.y=E/x}else{d=y,d.x=d.data.x,d.y=d.data.y;do p+=a[d.data.index];while(d=d.next)}y.value=p}function m(y,p,d,g){if(!y.value)return!0;var x=y.x-t.x,_=y.y-t.y,E=g-p,b=x*x+_*_;if(E*E/u<b)return b<l&&(x===0&&(x=ue(n),b+=x*x),_===0&&(_=ue(n),b+=_*_),b<o&&(b=Math.sqrt(o*b)),t.vx+=x*y.value*r/b,t.vy+=_*y.value*r/b),!0;if(y.length||b>=l)return;(y.data!==t||y.next)&&(x===0&&(x=ue(n),b+=x*x),_===0&&(_=ue(n),b+=_*_),b<o&&(b=Math.sqrt(o*b)));do y.data!==t&&(E=a[y.data.index]*r/b,t.vx+=x*E,t.vy+=_*E);while(y=y.next)}return c.initialize=function(y,p){e=y,n=p,h()},c.strength=function(y){return arguments.length?(i=typeof y=="function"?y:fe(+y),h(),c):i},c.distanceMin=function(y){return arguments.length?(o=y*y,c):Math.sqrt(o)},c.distanceMax=function(y){return arguments.length?(l=y*y,c):Math.sqrt(l)},c.theta=function(y){return arguments.length?(u=y*y,c):Math.sqrt(u)},c}function Ra(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}const Ut=Symbol("implicit");function vn(){var e=new bt,t=[],n=[],r=Ut;function i(a){let o=e.get(a);if(o===void 0){if(r!==Ut)return r;e.set(a,o=t.push(a)-1)}return n[o%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new bt;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return vn(t,n).unknown(r)},Ra.apply(i,arguments),i}const Pe=e=>()=>e;function Ua(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function oe(e,t,n){this.k=e,this.x=t,this.y=n}oe.prototype={constructor:oe,scale:function(e){return e===1?this:new oe(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new oe(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var wn=new oe(1,0,0);oe.prototype;function tt(e){e.stopImmediatePropagation()}function we(e){e.preventDefault(),e.stopImmediatePropagation()}function Ba(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ga(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Bt(){return this.__zoom||wn}function Ha(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function qa(){return navigator.maxTouchPoints||"ontouchstart"in this}function Va(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Xa(){var e=Ba,t=Ga,n=Va,r=Ha,i=qa,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,u=Qi,c=Ee("start","zoom","end"),h,w,m,y=500,p=150,d=0,g=10;function x(v){v.property("__zoom",Bt).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",z).filter(i).on("touchstart.zoom",U).on("touchmove.zoom",V).on("touchend.zoom touchcancel.zoom",G).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(v,j,f,N){var C=v.selection?v.selection():v;C.property("__zoom",Bt),v!==C?A(v,j,f,N):C.interrupt().each(function(){k(this,arguments).event(N).start().zoom(null,typeof j=="function"?j.apply(this,arguments):j).end()})},x.scaleBy=function(v,j,f,N){x.scaleTo(v,function(){var C=this.__zoom.k,M=typeof j=="function"?j.apply(this,arguments):j;return C*M},f,N)},x.scaleTo=function(v,j,f,N){x.transform(v,function(){var C=t.apply(this,arguments),M=this.__zoom,T=f==null?b(C):typeof f=="function"?f.apply(this,arguments):f,I=M.invert(T),O=typeof j=="function"?j.apply(this,arguments):j;return n(E(_(M,O),T,I),C,o)},f,N)},x.translateBy=function(v,j,f,N){x.transform(v,function(){return n(this.__zoom.translate(typeof j=="function"?j.apply(this,arguments):j,typeof f=="function"?f.apply(this,arguments):f),t.apply(this,arguments),o)},null,N)},x.translateTo=function(v,j,f,N,C){x.transform(v,function(){var M=t.apply(this,arguments),T=this.__zoom,I=N==null?b(M):typeof N=="function"?N.apply(this,arguments):N;return n(wn.translate(I[0],I[1]).scale(T.k).translate(typeof j=="function"?-j.apply(this,arguments):-j,typeof f=="function"?-f.apply(this,arguments):-f),M,o)},N,C)};function _(v,j){return j=Math.max(a[0],Math.min(a[1],j)),j===v.k?v:new oe(j,v.x,v.y)}function E(v,j,f){var N=j[0]-f[0]*v.k,C=j[1]-f[1]*v.k;return N===v.x&&C===v.y?v:new oe(v.k,N,C)}function b(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function A(v,j,f,N){v.on("start.zoom",function(){k(this,arguments).event(N).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(N).end()}).tween("zoom",function(){var C=this,M=arguments,T=k(C,M).event(N),I=t.apply(C,M),O=f==null?b(I):typeof f=="function"?f.apply(C,M):f,F=Math.max(I[1][0]-I[0][0],I[1][1]-I[0][1]),L=C.__zoom,B=typeof j=="function"?j.apply(C,M):j,X=u(L.invert(O).concat(F/L.k),B.invert(O).concat(F/B.k));return function(K){if(K===1)K=B;else{var Z=X(K),$=F/Z[2];K=new oe($,O[0]-Z[0]*$,O[1]-Z[1]*$)}T.zoom(null,K)}})}function k(v,j,f){return!f&&v.__zooming||new D(v,j)}function D(v,j){this.that=v,this.args=j,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,j),this.taps=0}D.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,j){return this.mouse&&v!=="mouse"&&(this.mouse[1]=j.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=j.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=j.invert(this.touch1[0])),this.that.__zoom=j,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var j=ne(this.that).datum();c.call(v,this.that,new Ua(v,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:c}),j)}};function S(v,...j){if(!e.apply(this,arguments))return;var f=k(this,j).event(v),N=this.__zoom,C=Math.max(a[0],Math.min(a[1],N.k*Math.pow(2,r.apply(this,arguments)))),M=ae(v);if(f.wheel)(f.mouse[0][0]!==M[0]||f.mouse[0][1]!==M[1])&&(f.mouse[1]=N.invert(f.mouse[0]=M)),clearTimeout(f.wheel);else{if(N.k===C)return;f.mouse=[M,N.invert(M)],Re(this),f.start()}we(v),f.wheel=setTimeout(T,p),f.zoom("mouse",n(E(_(N,C),f.mouse[0],f.mouse[1]),f.extent,o));function T(){f.wheel=null,f.end()}}function R(v,...j){if(m||!e.apply(this,arguments))return;var f=v.currentTarget,N=k(this,j,!0).event(v),C=ne(v.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",F,!0),M=ae(v,f),T=v.clientX,I=v.clientY;sn(v.view),tt(v),N.mouse=[M,this.__zoom.invert(M)],Re(this),N.start();function O(L){if(we(L),!N.moved){var B=L.clientX-T,X=L.clientY-I;N.moved=B*B+X*X>d}N.event(L).zoom("mouse",n(E(N.that.__zoom,N.mouse[0]=ae(L,f),N.mouse[1]),N.extent,o))}function F(L){C.on("mousemove.zoom mouseup.zoom",null),an(L.view,N.moved),we(L),N.event(L).end()}}function z(v,...j){if(e.apply(this,arguments)){var f=this.__zoom,N=ae(v.changedTouches?v.changedTouches[0]:v,this),C=f.invert(N),M=f.k*(v.shiftKey?.5:2),T=n(E(_(f,M),N,C),t.apply(this,j),o);we(v),l>0?ne(this).transition().duration(l).call(A,T,N,v):ne(this).call(x.transform,T,N,v)}}function U(v,...j){if(e.apply(this,arguments)){var f=v.touches,N=f.length,C=k(this,j,v.changedTouches.length===N).event(v),M,T,I,O;for(tt(v),T=0;T<N;++T)I=f[T],O=ae(I,this),O=[O,this.__zoom.invert(O),I.identifier],C.touch0?!C.touch1&&C.touch0[2]!==O[2]&&(C.touch1=O,C.taps=0):(C.touch0=O,M=!0,C.taps=1+!!h);h&&(h=clearTimeout(h)),M&&(C.taps<2&&(w=O[0],h=setTimeout(function(){h=null},y)),Re(this),C.start())}}function V(v,...j){if(this.__zooming){var f=k(this,j).event(v),N=v.changedTouches,C=N.length,M,T,I,O;for(we(v),M=0;M<C;++M)T=N[M],I=ae(T,this),f.touch0&&f.touch0[2]===T.identifier?f.touch0[0]=I:f.touch1&&f.touch1[2]===T.identifier&&(f.touch1[0]=I);if(T=f.that.__zoom,f.touch1){var F=f.touch0[0],L=f.touch0[1],B=f.touch1[0],X=f.touch1[1],K=(K=B[0]-F[0])*K+(K=B[1]-F[1])*K,Z=(Z=X[0]-L[0])*Z+(Z=X[1]-L[1])*Z;T=_(T,Math.sqrt(K/Z)),I=[(F[0]+B[0])/2,(F[1]+B[1])/2],O=[(L[0]+X[0])/2,(L[1]+X[1])/2]}else if(f.touch0)I=f.touch0[0],O=f.touch0[1];else return;f.zoom("touch",n(E(T,I,O),f.extent,o))}}function G(v,...j){if(this.__zooming){var f=k(this,j).event(v),N=v.changedTouches,C=N.length,M,T;for(tt(v),m&&clearTimeout(m),m=setTimeout(function(){m=null},y),M=0;M<C;++M)T=N[M],f.touch0&&f.touch0[2]===T.identifier?delete f.touch0:f.touch1&&f.touch1[2]===T.identifier&&delete f.touch1;if(f.touch1&&!f.touch0&&(f.touch0=f.touch1,delete f.touch1),f.touch0)f.touch0[1]=this.__zoom.invert(f.touch0[0]);else if(f.end(),f.taps===2&&(T=ae(T,this),Math.hypot(w[0]-T[0],w[1]-T[1])<g)){var I=ne(this).on("dblclick.zoom");I&&I.apply(this,arguments)}}}return x.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:Pe(+v),x):r},x.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Pe(!!v),x):e},x.touchable=function(v){return arguments.length?(i=typeof v=="function"?v:Pe(!!v),x):i},x.extent=function(v){return arguments.length?(t=typeof v=="function"?v:Pe([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),x):t},x.scaleExtent=function(v){return arguments.length?(a[0]=+v[0],a[1]=+v[1],x):[a[0],a[1]]},x.translateExtent=function(v){return arguments.length?(o[0][0]=+v[0][0],o[1][0]=+v[1][0],o[0][1]=+v[0][1],o[1][1]=+v[1][1],x):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},x.constrain=function(v){return arguments.length?(n=v,x):n},x.duration=function(v){return arguments.length?(l=+v,x):l},x.interpolate=function(v){return arguments.length?(u=v,x):u},x.on=function(){var v=c.on.apply(c,arguments);return v===c?x:v},x.clickDistance=function(v){return arguments.length?(d=(v=+v)*v,x):Math.sqrt(d)},x.tapDistance=function(v){return arguments.length?(g=+v,x):g},x}class ge{constructor(){this.ollamaUrl="http://localhost:11434",this.model="mistral",this.cache=new Map}static getInstance(){return ge.instance||(ge.instance=new ge),ge.instance}async checkOllamaConnection(){try{const t=new AbortController,n=setTimeout(()=>t.abort(),5e3),r=await fetch(`${this.ollamaUrl}/api/tags`,{method:"GET",headers:{"Content-Type":"application/json"},signal:t.signal,mode:"cors"});if(clearTimeout(n),r.ok){const a=(await r.json()).models||[],o=a.some(l=>l.name&&(l.name.toLowerCase().includes("mistral")||l.name.toLowerCase().includes("llama")||l.name.toLowerCase().includes("phi3")));return console.log("Ollama models available:",a.map(l=>l.name)),o}return!1}catch(t){return t instanceof Error?t.name==="AbortError"?console.log("Ollama connection timeout after 5 seconds"):t.message.includes("CORS")?console.log('CORS error - make sure Ollama is running with OLLAMA_ORIGINS="*"'):t.message.includes("NetworkError")||t.message.includes("Failed to fetch")?console.log("Network error - Ollama not running on localhost:11434"):console.log("Ollama connection failed:",t.message):console.log("Ollama connection failed:",t),!1}}async generateEmbedding(t){const n=this.hashString(t).toString();if(this.cache.has(n))return this.cache.get(n);try{const r=await fetch(`${this.ollamaUrl}/api/embeddings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,prompt:t})});if(!r.ok)throw new Error(`Ollama API error: ${r.status}`);const i=await r.json();return this.cache.set(n,i.embedding),i.embedding}catch(r){return console.warn("Failed to generate embedding via Ollama:",r),this.generateFallbackEmbedding(t)}}async generateDocumentEmbedding(t){const n=`${t.title} ${t.summary} ${t.keywords.join(" ")} ${t.category}`;return this.generateEmbedding(n)}async detectTopic(t){try{const n=`Analyze this document and classify it into ONE of these categories: Machine Learning, Deep Learning, Data Science, AI Ethics, Business Intelligence, Natural Language Processing, Computer Vision, Reinforcement Learning, Statistics, Programming, Business Strategy, or Other.

Document: ${t.title}
Summary: ${t.summary}
Keywords: ${t.keywords.join(", ")}

Respond with only the category name:`,r=await fetch(`${this.ollamaUrl}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,prompt:n,stream:!1})});if(r.ok){const a=(await r.json()).response.trim();return this.validateTopic(a)}}catch(n){console.warn("Failed to detect topic via Ollama:",n)}return this.detectTopicFallback(t)}validateTopic(t){const n=["Machine Learning","Deep Learning","Data Science","AI Ethics","Business Intelligence","Natural Language Processing","Computer Vision","Reinforcement Learning","Statistics","Programming","Business Strategy"],r=t.trim();return n.find(a=>a.toLowerCase()===r.toLowerCase()||r.toLowerCase().includes(a.toLowerCase()))||"Other"}detectTopicFallback(t){const n=`${t.title} ${t.summary} ${t.keywords.join(" ")}`.toLowerCase(),r={"Machine Learning":["machine learning","ml","algorithm","model","training","supervised","unsupervised"],"Deep Learning":["deep learning","neural network","cnn","rnn","transformer","pytorch","tensorflow"],"Data Science":["data science","analytics","visualization","pandas","numpy","statistics"],"AI Ethics":["ethics","bias","fairness","responsible ai","governance","regulation"],"Business Intelligence":["business","strategy","management","leadership","productivity"],"Natural Language Processing":["nlp","text","language","chatbot","sentiment","tokenization"],"Computer Vision":["computer vision","image","opencv","detection","recognition"],Programming:["python","code","programming","development","software"],Statistics:["statistics","probability","regression","hypothesis","distribution"]};let i="Other",a=0;for(const[o,l]of Object.entries(r)){const u=l.reduce((c,h)=>c+(n.includes(h)?1:0),0);u>a&&(a=u,i=o)}return i}generateFallbackEmbedding(t){const n=t.toLowerCase().split(/\s+/),r=new Array(384).fill(0);n.forEach((a,o)=>{const l=this.hashString(a);for(let u=0;u<r.length;u++)r[u]+=Math.sin(l+u+o)*.1});const i=Math.sqrt(r.reduce((a,o)=>a+o*o,0));return r.map(a=>a/(i||1))}hashString(t){let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return Math.abs(n)}calculateSimilarity(t,n){if(t.length!==n.length)return 0;let r=0,i=0,a=0;for(let l=0;l<t.length;l++)r+=t[l]*n[l],i+=t[l]*t[l],a+=n[l]*n[l];const o=Math.sqrt(i)*Math.sqrt(a);return o===0?0:r/o}async processDocuments(t){const n={};for(const r of t)try{const[i,a]=await Promise.all([this.generateDocumentEmbedding(r),this.detectTopic(r)]);n[r.id]={embedding:i,topic:a,topicConfidence:.8}}catch(i){console.warn(`Failed to process document ${r.id}:`,i),n[r.id]={embedding:this.generateFallbackEmbedding(r.summary),topic:this.detectTopicFallback(r),topicConfidence:.5}}return n}generateTopicClusters(t){const n={};Object.entries(t).forEach(([i,a])=>{n[a.topic]||(n[a.topic]=[]),n[a.topic].push(i)});const r=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE","#85C1E9","#F8C471","#82E0AA","#F1948A","#85C1E9","#D7BDE2"];return Object.entries(n).map(([i,a],o)=>{const l=a.map(c=>t[c].embedding),u=this.calculateCentroid(l);return{topic:i,color:r[o%r.length],documents:a,centroid:u}})}calculateCentroid(t){if(t.length===0)return[];const n=t[0].length,r=new Array(n).fill(0);return t.forEach(i=>{i.forEach((a,o)=>{r[o]+=a})}),r.map(i=>i/t.length)}async saveEmbeddings(t){try{localStorage.setItem("document-embeddings",JSON.stringify(t)),console.log("Embeddings saved to cache successfully")}catch(n){console.warn("Failed to save embeddings to cache:",n)}}loadCachedEmbeddings(){try{const t=localStorage.getItem("document-embeddings");return t?JSON.parse(t):null}catch{return null}}}const Ka=({documents:e,width:t=800,height:n=600,onNodeClick:r,onNodeHover:i})=>{const a=P.useRef(null),[o,l]=P.useState(!1),[u,c]=P.useState(null),[h,w]=P.useState([]),[m,y]=P.useState(null),[p,d]=P.useState(null),[g,x]=P.useState([]),[_,E]=P.useState(null),[b,A]=P.useState(!1),[k,D]=P.useState([]),S=ge.getInstance();P.useEffect(()=>{(async()=>{const N=await S.checkOllamaConnection();A(N)})()},[S]),P.useEffect(()=>{let f=e;e.length>100&&(p&&(f=f.filter(N=>N.category===p)),g.length>0&&(f=f.filter(N=>g.some(C=>N.keywords.some(M=>M.toLowerCase().includes(C.toLowerCase()))))),f.length>50&&(f=f.sort((N,C)=>C.file_size-N.file_size).slice(0,50))),D(f)},[e,p,g]);const R=[...new Set(e.map(f=>f.category))],U=e.flatMap(f=>f.keywords).reduce((f,N)=>(f[N]=(f[N]||0)+1,f),{}),V=Object.entries(U).sort(([,f],[,N])=>N-f).map(([f])=>f);P.useEffect(()=>{(async()=>{if(e.length===0)return;l(!0);const N=S.loadCachedEmbeddings();if(N&&Object.keys(N).length>0){c(N);const C=S.generateTopicClusters(N);w(C),l(!1);return}try{const C=await S.processDocuments(e);c(C);const M=S.generateTopicClusters(C);w(M),await S.saveEmbeddings(C)}catch(C){console.error("Failed to generate embeddings:",C)}finally{l(!1)}})()},[e]);const G=P.useCallback(()=>{if(!u)return{nodes:[],links:[]};const N=(k.length>0?k:e).map(T=>{const I=u[T.id];return{...T,embedding:I?.embedding,topic:I?.topic||"Other"}}),C=[],M=.3;for(let T=0;T<N.length;T++)for(let I=T+1;I<N.length;I++){const O=N[T],F=N[I];if(O.embedding&&F.embedding){const L=S.calculateSimilarity(O.embedding,F.embedding);L>M&&C.push({source:O.id,target:F.id,similarity:L,weight:L})}}return{nodes:N,links:C}},[e,u,h,k,S]);P.useEffect(()=>{if(!a.current||!u)return;const f=ne(a.current);f.selectAll("*").remove();const N=G();if(N.nodes.length===0)return;const C={top:20,right:20,bottom:20,left:20},M=t-C.left-C.right,T=n-C.top-C.bottom,I=f.attr("width",t).attr("height",n).append("g").attr("transform",`translate(${C.left},${C.top})`),O=Xa().scaleExtent([.1,4]).on("zoom",$=>{I.attr("transform",$.transform)});f.call(O);const F=La(N.nodes).force("link",Ta(N.links).id($=>$.id).distance($=>80/($.weight+.1)).strength($=>$.weight*.5)).force("charge",Fa().strength(-200)).force("center",ca(M/2,T/2)).force("collision",Aa().radius(20)).alphaDecay(.05).velocityDecay(.8),L=vn().domain(h.map($=>$.topic)).range(h.map($=>$.color)),B=I.append("g").attr("class","links").selectAll("line").data(N.links).enter().append("line").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",$=>Math.sqrt($.weight*5)),X=I.append("g").attr("class","nodes").selectAll("circle").data(N.nodes).enter().append("circle").attr("r",$=>Math.sqrt($.file_size/1e5)+8).attr("fill",$=>L($.topic||"Other")).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer").style("opacity",$=>m?$.topic===m?1:.3:1),K=I.append("g").attr("class","labels").selectAll("text").data(N.nodes).enter().append("text").text($=>$.title.length>20?$.title.substring(0,20)+"...":$.title).attr("font-size","10px").attr("font-family","Arial, sans-serif").attr("text-anchor","middle").attr("dy","0.35em").attr("pointer-events","none").style("opacity",$=>m?$.topic===m?1:.3:.8),Z=ki().on("start",($,H)=>{$.active||F.alphaTarget(.3).restart(),H.fx=H.x,H.fy=H.y}).on("drag",($,H)=>{H.fx=$.x,H.fy=$.y}).on("end",($,H)=>{$.active||F.alphaTarget(0),H.fx=null,H.fy=null});return X.call(Z),X.on("mouseover",($,H)=>{E(H),i?.(H);const Qe=new Set;N.links.forEach(q=>{(q.source===H.id||typeof q.source=="object"&&q.source.id===H.id)&&Qe.add(typeof q.target=="string"?q.target:q.target.id),(q.target===H.id||typeof q.target=="object"&&q.target.id===H.id)&&Qe.add(typeof q.source=="string"?q.source:q.source.id)}),X.style("opacity",q=>q.id===H.id||Qe.has(q.id)?1:.3),B.style("opacity",q=>{const _n=typeof q.source=="string"?q.source:q.source.id,Nn=typeof q.target=="string"?q.target:q.target.id;return _n===H.id||Nn===H.id?1:.1})}).on("mouseout",()=>{E(null),i?.(null),X.style("opacity",$=>m?$.topic===m?1:.3:1),B.style("opacity",.6)}).on("click",($,H)=>{$.stopPropagation(),r?.(H)}),F.on("tick",()=>{B.attr("x1",$=>$.source.x).attr("y1",$=>$.source.y).attr("x2",$=>$.target.x).attr("y2",$=>$.target.y),X.attr("cx",$=>$.x).attr("cy",$=>$.y),K.attr("x",$=>$.x).attr("y",$=>$.y+30)}),()=>{F.stop()}},[u,G,t,n,m,r,i,h]);const v=f=>{y(m===f?null:f)},j=async()=>{l(!0);try{localStorage.removeItem("document-embeddings");const f=await S.processDocuments(e);c(f);const N=S.generateTopicClusters(f);w(N),await S.saveEmbeddings(f)}catch(f){console.error("Failed to regenerate embeddings:",f)}finally{l(!1)}};return s.jsxs("div",{className:"knowledge-graph-container w-full",children:[e.length>100&&s.jsx("div",{className:"mb-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-orange-800",children:[s.jsx("span",{className:"text-sm font-medium",children:"⚡ Performance Mode:"}),s.jsxs("span",{className:"text-sm",children:["Large dataset detected (",e.length," documents).",k.length>0?` Showing ${k.length} filtered documents for optimal performance.`:" Use filters below to improve performance."]})]})}),e.length>100&&s.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border",children:[s.jsx("div",{className:"text-sm font-medium mb-3",children:"📊 Performance Filters (Required for large datasets):"}),s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:"Filter by Category:"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>d(null),className:`px-3 py-1 text-xs rounded border ${p===null?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"All Categories"}),R.map(f=>s.jsx("button",{onClick:()=>d(f),className:`px-3 py-1 text-xs rounded border ${p===f?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:f},f))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:"Filter by Tags:"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>x([]),className:`px-3 py-1 text-xs rounded border ${g.length===0?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Clear Tags"}),V.map(f=>s.jsxs("button",{onClick:()=>{g.includes(f)?x(g.filter(N=>N!==f)):x([...g,f])},className:`px-3 py-1 text-xs rounded border ${g.includes(f)?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[f," (",U[f],")"]},f))]})]})]}),!u&&!o&&s.jsx("div",{className:"mb-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:s.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"🚀 Generate Knowledge Graph Connections"}),s.jsx("p",{className:"text-gray-700 mb-4 max-w-2xl mx-auto",children:"Click the button below to analyze your documents with AI and create intelligent connections. This will generate embeddings that power the knowledge graph visualization."})]}),s.jsxs("button",{onClick:j,disabled:o,className:"inline-flex items-center gap-2 px-8 py-4 text-lg font-semibold bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),o?"Generating Connections...":"Generate Embeddings & Connections"]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:["⚡ This process analyzes ",e.length," documents and may take a few moments"]})]})}),u&&s.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"AI Status:"}),s.jsx("span",{className:`text-sm px-2 py-1 rounded ${b?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:b?"✅ Ollama Connected":"⚠️ Offline Mode"}),s.jsx("span",{className:"text-xs text-gray-500",children:b?"Using Mistral AI for high-quality embeddings":"Using keyword-based fallback embeddings"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:j,disabled:o,className:"inline-flex items-center gap-1 px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),o?"Regenerating...":"Regenerate Connections"]}),s.jsx("span",{className:"text-xs text-gray-500",children:"Click to refresh embeddings and update connections"})]})]}),h.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsx("div",{className:"text-sm font-medium mb-2",children:"Filter by Topic:"}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{onClick:()=>v(null),className:`px-3 py-1 text-sm rounded border ${m===null?"bg-gray-800 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"All Topics"}),h.map(f=>s.jsxs("button",{onClick:()=>v(f.topic),className:`px-3 py-1 text-sm rounded border ${m===f.topic?"text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,style:{backgroundColor:m===f.topic?f.color:void 0,borderColor:f.color},children:[f.topic," (",f.documents.length,")"]},f.topic))]})]}),o&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),s.jsx("div",{className:"text-sm text-gray-600",children:b?"Generating AI embeddings...":"Processing documents..."})]})}),!o&&u&&s.jsxs("div",{className:"relative",children:[s.jsx("svg",{ref:a,className:"border rounded-lg bg-white"}),_&&s.jsxs("div",{className:"absolute top-4 left-4 bg-white p-3 rounded-lg shadow-lg border max-w-xs z-10",children:[s.jsx("h4",{className:"font-semibold text-sm mb-1",children:_.title}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[_.summary.substring(0,100),"..."]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.jsx("span",{className:"px-2 py-1 rounded",style:{backgroundColor:h.find(f=>f.topic===_.topic)?.color+"20",color:h.find(f=>f.topic===_.topic)?.color},children:_.topic}),s.jsxs("span",{className:"text-gray-500",children:[(_.file_size/1024/1024).toFixed(1)," MB"]})]})]})]}),h.length>0&&!o&&s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-sm font-medium mb-2",children:"Topic Legend:"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 text-xs",children:h.map(f=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:f.color}}),s.jsx("span",{children:f.topic})]},f.topic))})]})]})};class Ya extends P.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("ErrorBoundary caught an error:",t,n)}render(){return this.state.hasError?this.props.fallback||s.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-red-800 mb-3",children:[s.jsx("span",{className:"text-lg",children:"⚠️"}),s.jsx("h3",{className:"font-semibold",children:"Something went wrong"})]}),s.jsx("p",{className:"text-red-700 text-sm mb-4",children:"An error occurred while rendering this component."}),s.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-4 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Try Again"})]}):this.props.children}}const Qa=({initialView:e="library"})=>{const[t,n]=P.useState([]),[r,i]=P.useState([]),[a,o]=P.useState(e),[l,u]=P.useState(null),[c,h]=P.useState(!0),[w,m]=P.useState(!1),[y,p]=P.useState(null),d=r.length>0?r.length<=50:t.length<=50;P.useEffect(()=>{(async()=>{try{const z=["/tech_documents/data/documents.json","/data/documents.json","./data/documents.json"];let U=null;for(const V of z)try{const G=await fetch(V);if(G.ok){U=await G.json();break}}catch(G){console.warn(`Failed to load from ${V}:`,G)}U?n(U):(console.error("Could not load documents from any path"),n([]))}catch(S){console.error("Error loading documents:",S),n([])}finally{h(!1)}})()},[]),P.useEffect(()=>{typeof window<"u"&&"serviceWorker"in navigator&&navigator.serviceWorker.register("/tech_documents/sw.js").then(S=>{console.log("Service Worker registered:",S)}).catch(S=>{console.warn("Service Worker registration failed:",S)})},[]);const g=D=>D.map(S=>({...S,title:S.title||S.filename,authors:S.authors||[],content_preview:S.content_preview||S.summary.substring(0,200)+"..."})),x=D=>{u(D);const S=t.find(R=>R.id===D.id);S&&(p(S),m(!0))},_=()=>{m(!1),p(null)},E=D=>{},b=()=>{o("graph")},A=D=>{const S=`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${D}`;return`https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(S)}`},k=D=>`https://github.com/lonardonifabio/tech_documents/blob/main/${D}`;return c?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("div",{className:"text-lg text-gray-600",children:"Loading document library..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("header",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center py-4 gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"AI & Data Science Document Library"}),s.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:[t.length," documents • Interactive knowledge graph powered by AI"]})]}),s.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1 w-full sm:w-auto",children:[s.jsxs("button",{onClick:()=>o("library"),className:`flex-1 sm:flex-none px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors ${a==="library"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[s.jsx("span",{className:"hidden sm:inline",children:"📚 Library View"}),s.jsx("span",{className:"sm:hidden",children:"📚 Library"})]}),s.jsxs("button",{onClick:()=>o("graph"),disabled:!d,className:`flex-1 sm:flex-none px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors ${a==="graph"?"bg-white text-gray-900 shadow-sm":d?"text-gray-600 hover:text-gray-900":"text-gray-400 cursor-not-allowed"}`,title:d?"Open Knowledge Graph":`Knowledge Graph unavailable (${r.length>0?r.length:t.length} results > 50 limit)`,children:[s.jsxs("span",{className:"hidden sm:inline",children:["🕸️ Knowledge Graph",!d&&s.jsxs("span",{className:"ml-1 text-xs",children:["(",r.length>0?r.length:t.length,"/50)"]})]}),s.jsxs("span",{className:"sm:hidden",children:["🕸️ Graph",!d&&s.jsxs("span",{className:"ml-1 text-xs",children:["(",r.length>0?r.length:t.length,"/50)"]})]})]})]})]})})}),s.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a==="library"?s.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:s.jsx(In,{onKnowledgeGraphClick:b,onFilteredDocumentsChange:i})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("button",{onClick:()=>o("library"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:text-blue-800 transition-colors",children:"← Back to Library"}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Showing knowledge graph for ",r.length>0?r.length:t.length," documents",r.length>0&&r.length!==t.length&&s.jsxs("span",{className:"text-gray-400",children:[" (filtered from ",t.length," total)"]})]})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Interactive Knowledge Graph"}),s.jsxs("p",{className:"text-gray-600 text-sm mb-4",children:["Explore document relationships based on AI-generated embeddings. Documents are clustered by topic and connected by semantic similarity.",s.jsxs("span",{className:"block mt-2 text-blue-600 font-medium",children:["📊 Input: ",t.length," documents from search results"]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),s.jsx("span",{children:"Node size = File size"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),s.jsx("span",{children:"Colors = AI-detected topics"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-8 h-0.5 bg-gray-400"}),s.jsx("span",{children:"Links = Semantic similarity"})]})]})]}),l&&s.jsxs("div",{className:"ml-6 p-4 bg-gray-50 rounded-lg max-w-sm",children:[s.jsx("h3",{className:"font-medium text-sm mb-2",children:"Selected Document:"}),s.jsx("p",{className:"text-sm font-semibold mb-1",children:l.title}),s.jsxs("p",{className:"text-xs text-gray-600 mb-3",children:[l.summary.substring(0,100),"..."]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("a",{href:A(l.filepath),target:"_blank",rel:"noopener noreferrer",className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",children:"View PDF"}),s.jsx("a",{href:k(l.filepath),target:"_blank",rel:"noopener noreferrer",className:"text-xs border border-gray-300 text-gray-700 px-2 py-1 rounded hover:bg-gray-50",children:"GitHub"})]})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-6",children:s.jsx(Ya,{fallback:s.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-red-800 mb-3",children:[s.jsx("span",{className:"text-lg",children:"⚠️"}),s.jsx("h3",{className:"font-semibold",children:"Knowledge Graph Error"})]}),s.jsx("p",{className:"text-red-700 text-sm mb-4",children:"The knowledge graph failed to load. This might be due to:"}),s.jsxs("ul",{className:"text-red-700 text-sm mb-4 list-disc list-inside",children:[s.jsx("li",{children:"Ollama not running locally (required for AI embeddings)"}),s.jsx("li",{children:"CORS configuration issues"}),s.jsx("li",{children:"Large dataset processing errors"}),s.jsx("li",{children:"Browser compatibility issues"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>typeof window<"u"?window.location.reload():void 0,className:"px-4 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Reload Page"}),s.jsx("button",{onClick:()=>o("library"),className:"px-4 py-2 border border-red-300 text-red-700 text-sm rounded hover:bg-red-50 transition-colors",children:"Back to Library"})]})]}),children:s.jsx(Ka,{documents:g(r.length>0?r:t),width:typeof window<"u"?Math.min(window.innerWidth-100,1e3):1e3,height:typeof window<"u"?Math.min(window.innerHeight-300,700):700,onNodeClick:x,onNodeHover:E})})}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"How to Use the Knowledge Graph"}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-800",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"🖱️ Interactions:"}),s.jsxs("ul",{className:"space-y-1 text-blue-700",children:[s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Click"})," nodes to open document preview popup"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Hover"})," to see document previews"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Drag"})," nodes to reposition them"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Scroll"})," to zoom in/out"]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"🎯 Features:"}),s.jsxs("ul",{className:"space-y-1 text-blue-700",children:[s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Category filtering"})," to focus on specific areas"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Tag filtering"})," based on available keywords"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Topic filtering"})," by AI-detected themes"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Semantic connections"})," show related documents"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Offline support"})," via service worker caching"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"AI-powered"})," topic detection and clustering"]})]})]})]})]})]})}),s.jsx("footer",{className:"bg-white border-t mt-12",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center text-sm text-gray-600",children:[s.jsx("div",{children:s.jsxs("p",{children:["Powered by"," ",s.jsx("a",{href:"https://d3js.org/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"D3.js"})," ","and"," ",s.jsx("a",{href:"https://ollama.ai/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Ollama"})," ","• Built with"," ",s.jsx("a",{href:"https://astro.build/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Astro"})," ","and"," ",s.jsx("a",{href:"https://reactjs.org/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"React"})]})}),s.jsx("div",{className:"mt-2 md:mt-0",children:s.jsx("p",{children:"Interactive Knowledge Graph • Bundle size optimized • Works offline"})})]})})}),y&&s.jsx(qt,{doc:y,isOpen:w,onClose:_})]})};export{Qa as default};
