import{j as i}from"./jsx-runtime.TBa3i5EZ.js";import{r as z}from"./index.CVf8TyFT.js";const Ut=({doc:e,isOpen:t,onClose:n})=>{const[r,s]=z.useState(!1),[a,o]=z.useState(!1),l=d=>{const f=`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${d.filepath}`;return`https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(f)}`},u=d=>{d.key==="Escape"&&n()},c=(d,f=200)=>!d||d.length<=f?d||"":d.substring(0,f)+"...",h=d=>`${(d/1048576).toFixed(1)} MB`,v=d=>{try{return new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Unknown date"}},g=d=>{const f=d.title||d.filename,p=d.content_preview,N=d.keywords.slice(0,5),S=`https://lonardonifabio.github.io/tech_documents/document/${d.id}`;let x=`🚀 Just shared an insightful resource with my LinkedIn network!
`;return x+=`📄 **${f}**
`,x+=`🤖 Explore it with AI-powered assistance: ${S}

`,p&&(x+=`🔍 **Content Preview:**
${p}
`),x+=`
`,x+=`📊 **Explore 1100+ AI & Data Science Documents:**
`,x+=`🌐 Visit: https://lonardonifabio.github.io/tech_documents/
`,x+=`
`,N.forEach(A=>{x+=`#${A.replace(/\s+/g,"")} `}),x},y=async()=>{if(!(typeof window>"u"))try{const d=e.title||e.filename,f=`https://lonardonifabio.github.io/tech_documents/document/${e.id}`;let p=`🚀 Sharing an insightful AI/Data Science resource!

`;if(p+=`📄 **${d}**

`,e.summary){const T=e.summary.length>200?e.summary.substring(0,197)+"...":e.summary;p+=`📝 ${T}

`}e.key_concepts&&e.key_concepts.length>0&&(p+=`💡 Key concepts: ${e.key_concepts.slice(0,2).join(", ")}

`),p+=`🎯 Category: ${e.category} | Level: ${e.difficulty}

`,p+=`🤖 Explore with AI: ${f}

`,p+=`📚 Discover 1100+ AI & Data Science Documents:
`,p+=`🌐 https://lonardonifabio.github.io/tech_documents/

`,e.keywords.slice(0,5).forEach(T=>{p+=`#${T.replace(/\s+/g,"")} `}),p+="#ArtificialIntelligence #DataScience #MachineLearning";const S=encodeURIComponent(p),x=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(f)}&text=${S}`;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?window.open(x,"_blank"):window.open(x,"_blank","width=600,height=600"),setTimeout(()=>{alert(`✅ LinkedIn sharing opened!

🎨 The post will now show a custom preview image generated specifically for this document.

📝 The post content is pre-filled with document details and hashtags.`)},500)}catch(d){console.error("LinkedIn sharing failed:",d),e.title||e.filename;const f=`https://lonardonifabio.github.io/tech_documents/document/${e.id}`,p=g(e),N=encodeURIComponent(p),S=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(f)}&text=${N}`;window.open(S,"_blank")}},w=async()=>{if(typeof window>"u")return;const d=e.title||e.filename,f=`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,p=e.summary||"No summary available",N=`I'd like to discuss this document with you:

Title: ${d}

Summary: ${p}

Document URL: ${f}

Please help me understand and analyze this document.`;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&navigator.share)try{await navigator.share({title:`Talk with AI about: ${d}`,text:N,url:f})}catch{console.log("Native sharing failed, falling back to clipboard");try{await navigator.clipboard.writeText(N),alert("Document information copied to clipboard! You can now paste it into ChatGPT, Gemini, or any AI assistant app.")}catch{alert(`Copy this text to share with your AI assistant:

${N}`)}}else try{await navigator.clipboard.writeText(N),alert("Document information copied to clipboard! You can now paste it into ChatGPT, Gemini, or any AI assistant.")}catch{alert(`Copy this text to share with your AI assistant:

${N}`)}};return z.useEffect(()=>{if(t&&typeof document<"u")return document.addEventListener("keydown",u),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",u),document.body.style.overflow="unset"}},[t]),t?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-full max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-800 truncate pr-4",children:e.title||e.filename}),i.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100",title:"Close preview (ESC)",children:"×"})]}),i.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i.jsx("div",{className:"w-80 bg-gray-50 border-r flex flex-col",children:i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📄 Title"}),i.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:e.title||e.filename||"No title available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"👥 Authors"}),e.authors&&e.authors.length>0?i.jsx("div",{className:"space-y-1",children:e.authors.map((d,f)=>i.jsx("p",{className:"text-sm text-gray-900",children:d},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No author information available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📝 Summary"}),e.summary?i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:a?e.summary:c(e.summary,200)}),e.summary.length>200&&i.jsx("button",{onClick:()=>o(!a),className:"text-blue-600 hover:text-blue-800 text-sm mt-2 font-medium",children:a?"Show less":"Read more"})]}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No summary available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"💡 Key Concepts"}),e.key_concepts&&e.key_concepts.length>0?i.jsx("div",{className:"space-y-2",children:e.key_concepts.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-blue-500",children:i.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No key concepts available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🎯 Target Audience"}),e.target_audience?i.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:e.target_audience}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No target audience information available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🏭 Industry"}),e.industry&&e.industry.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:e.industry.map((d,f)=>i.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:d},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No industry information available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"💼 Business Functions"}),e.business_functions&&e.business_functions.length>0?i.jsx("div",{className:"space-y-1",children:e.business_functions.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-green-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No business functions information available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🏢 Companies"}),e.companies&&e.companies.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:e.companies.map((d,f)=>i.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-medium",children:d},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No companies mentioned"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"⚙️ Technologies"}),e.technologies&&e.technologies.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:e.technologies.map((d,f)=>i.jsx("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-xs font-medium",children:d},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No technologies mentioned"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🏷️ Keywords"}),e.keywords&&e.keywords.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:e.keywords.map((d,f)=>i.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:d},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No keywords available"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🔄 Processes"}),e.processes&&e.processes.length>0?i.jsx("div",{className:"space-y-1",children:e.processes.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-yellow-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No processes described"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🔧 Technical Terms"}),e.technical_terms&&e.technical_terms.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:e.technical_terms.map((d,f)=>i.jsx("span",{className:"bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium",children:d},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No technical terms identified"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📋 Methodologies"}),e.methodologies&&e.methodologies.length>0?i.jsx("div",{className:"space-y-1",children:e.methodologies.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-cyan-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No methodologies described"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🛠️ Tools Mentioned"}),e.tools_mentioned&&e.tools_mentioned.length>0?i.jsx("div",{className:"flex flex-wrap gap-1",children:e.tools_mentioned.map((d,f)=>i.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:d},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No specific tools mentioned"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📚 Prerequisites"}),e.prerequisites&&e.prerequisites.length>0?i.jsx("div",{className:"space-y-1",children:e.prerequisites.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-pink-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No prerequisites specified"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"🎓 Learning Objectives"}),e.learning_objectives&&e.learning_objectives.length>0?i.jsx("div",{className:"space-y-1",children:e.learning_objectives.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-emerald-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No learning objectives specified"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"💼 Use Cases"}),e.use_cases&&e.use_cases.length>0?i.jsx("div",{className:"space-y-1",children:e.use_cases.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-violet-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No use cases described"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"✅ Benefits"}),e.benefits_mentioned&&e.benefits_mentioned.length>0?i.jsx("div",{className:"space-y-1",children:e.benefits_mentioned.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-green-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No benefits highlighted"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"⚠️ Challenges Addressed"}),e.challenges_addressed&&e.challenges_addressed.length>0?i.jsx("div",{className:"space-y-1",children:e.challenges_addressed.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-red-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No challenges addressed"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"⭐ Best Practices"}),e.best_practices&&e.best_practices.length>0?i.jsx("div",{className:"space-y-1",children:e.best_practices.map((d,f)=>i.jsx("div",{className:"bg-white p-2 rounded border-l-2 border-amber-500",children:i.jsx("p",{className:"text-sm text-gray-900",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No best practices mentioned"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"❓ Questions & Answers"}),e.questions_and_answers&&e.questions_and_answers.length>0?i.jsx("div",{className:"space-y-2",children:e.questions_and_answers.map((d,f)=>i.jsx("div",{className:"bg-white p-3 rounded border border-gray-200",children:i.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:d})},f))}):i.jsx("p",{className:"text-sm text-gray-500 italic",children:"No Q&A available"})]}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"📊 Document Info"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Category:"}),i.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs",children:e.category||"Unknown"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Difficulty:"}),i.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs",children:e.difficulty||"Unknown"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"File Size:"}),i.jsx("span",{className:"text-gray-900",children:h(e.file_size)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Upload Date:"}),i.jsx("span",{className:"text-gray-900",children:v(e.upload_date)})]})]})]}),i.jsxs("div",{className:"pt-4 border-t space-y-3",children:[i.jsxs("button",{onClick:w,className:"w-full bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white px-4 py-2 rounded-lg transition-all duration-200 text-center text-sm font-medium flex items-center justify-center gap-2 md:hidden shadow-lg",title:"Talk with your AI",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"🤖 Talk with your AI"]}),i.jsxs("button",{onClick:y,className:"w-full bg-linkedin text-white px-4 py-2 rounded-lg hover:bg-linkedin-dark transition-colors duration-200 text-center text-sm font-medium flex items-center justify-center gap-2",title:"Share on LinkedIn with document preview",children:[i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),"📤 Share on LinkedIn"]}),i.jsx("a",{href:`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,target:"_blank",rel:"noopener noreferrer",className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 text-center block text-sm font-medium",children:"📥 Download PDF"})]})]})}),i.jsx("div",{className:"flex-1 bg-white",children:r?i.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Unable to load PDF"}),i.jsx("p",{className:"text-gray-500 mb-4",children:"The PDF could not be displayed in the viewer."}),i.jsx("a",{href:`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Download PDF"})]})}):i.jsx("iframe",{src:l(e),className:"w-full h-full border-0",onError:()=>s(!0),title:`Preview of ${e.title||e.filename}`})})]})]})}):null},wn=({doc:e,autoOpen:t=!1})=>{const[n,r]=z.useState(!1),[s,a]=z.useState(t),o=w=>{const d={AI:{gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",icon:"🤖"},"Machine Learning":{gradient:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",icon:"🧠"},"Data Science":{gradient:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",icon:"📊"},Business:{gradient:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",icon:"💼"},Technology:{gradient:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",icon:"⚙️"},Research:{gradient:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)",icon:"🔬"}},f=d[w.category]||d.Technology;return{background:f.gradient,icon:f.icon}},l=(w,d=40)=>w.length<=d?w:w.substring(0,d-3)+"...",u=(w,d=150)=>w.length<=d?w:w.substring(0,d)+"...",c=w=>new Date(w).toLocaleDateString("en-US"),h=w=>`${(w/1048576).toFixed(1)} MB`,v=n?e.summary:u(e.summary),g=e.title||e.filename,y=o(e);return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"border rounded-lg hover:shadow-xl transition-all duration-300 bg-white document-card overflow-hidden h-full flex flex-col",children:[i.jsxs("div",{className:"h-32 w-full relative overflow-hidden",children:[i.jsx("div",{className:"document-preview cursor-pointer h-full",style:{background:y.background},onClick:()=>a(!0),title:"Click to preview PDF",children:i.jsxs("div",{className:"relative z-10 text-center",children:[i.jsx("div",{className:"text-3xl mb-1",children:y.icon}),i.jsx("div",{className:"text-xs font-medium opacity-90",children:l(g,20)}),i.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Click to preview"})]})}),i.jsx("div",{className:"absolute top-2 right-2 z-20",children:i.jsx("span",{className:"bg-white bg-opacity-90 text-gray-800 px-2 py-1 rounded text-xs font-medium",children:e.category})})]}),i.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[i.jsx("h3",{className:"font-semibold text-base mb-2 text-gray-800 line-clamp-2 leading-tight",title:g,children:l(g,60)}),e.authors&&e.authors.length>0&&i.jsx("div",{className:"mb-2",children:i.jsxs("p",{className:"text-sm text-gray-500",children:[i.jsx("span",{className:"font-medium",children:"Authors:"})," ",e.authors.join(", ")]})}),i.jsxs("div",{className:"mb-4 flex-1",children:[i.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:v}),e.summary.length>150&&i.jsx("button",{onClick:()=>r(!n),className:"text-blue-600 text-xs mt-1 hover:underline focus:outline-none font-medium",children:n?"Show less":"Read more"})]}),i.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:e.keywords.map(w=>i.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:w},w))}),i.jsxs("div",{className:"mt-auto space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:e.difficulty}),i.jsx("span",{className:"text-xs text-gray-500",children:c(e.upload_date)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-xs text-gray-500",children:h(e.file_size)}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>a(!0),className:"bg-green-600 text-white px-3 py-1 rounded-full text-xs font-medium hover:bg-green-700 transition-colors duration-200",children:"Preview"}),i.jsx("a",{href:`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-medium hover:bg-blue-700 transition-colors duration-200",children:"Download"})]})]})]})]})]}),i.jsx(Ut,{doc:e,isOpen:s,onClose:()=>a(!1)})]})},_n=({searchTerm:e,setSearchTerm:t,selectedCategory:n,setSelectedCategory:r,selectedDifficulty:s,setSelectedDifficulty:a,categories:o,difficulties:l})=>{const[u,c]=z.useState(!1);return i.jsxs("div",{className:"mb-8 space-y-4 bg-white p-6 rounded-lg shadow-sm border",children:[i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:"text",placeholder:"🔍 Search with boolean operators: machine learning AND python OR 'data science' NOT statistics",className:"w-full p-3 pr-12 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",value:e,onChange:h=>t(h.target.value)}),i.jsx("button",{onClick:()=>c(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-blue-500 transition-colors",title:"Search help",children:"❓"})]}),u&&i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm",children:[i.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"🔍 Advanced Search Guide"}),i.jsxs("div",{className:"space-y-2 text-blue-700",children:[i.jsxs("div",{children:[i.jsx("strong",{children:"AND:"})," ",i.jsx("span",{className:"bg-gray-200 px-1 rounded",children:"machine learning AND python"})," - Both terms must be present"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"OR:"})," ",i.jsx("span",{className:"bg-gray-200 px-1 rounded",children:"python OR javascript"})," - Either term can be present"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"NOT:"})," ",i.jsx("span",{className:"bg-gray-200 px-1 rounded",children:"data science NOT statistics"}),' - Exclude documents with "statistics"']}),i.jsxs("div",{children:[i.jsx("strong",{children:"Quotes:"})," ",i.jsx("span",{className:"bg-gray-200 px-1 rounded",children:'"machine learning"'})," - Exact phrase search"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Combine:"})," ",i.jsx("span",{className:"bg-gray-200 px-1 rounded",children:'python AND "data science" OR visualization NOT excel'})]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.jsxs("select",{className:"p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",value:n,onChange:h=>r(h.target.value),children:[i.jsx("option",{value:"",children:"📂 All categories"}),o.map(h=>i.jsx("option",{value:h,children:h},h))]}),i.jsxs("select",{className:"p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 bg-white",value:s,onChange:h=>a(h.target.value),children:[i.jsx("option",{value:"",children:"🎯 All levels"}),l.map(h=>i.jsx("option",{value:h,children:h},h))]})]})]})},Nn=()=>i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600 text-lg",children:"Loading documents..."})]})}),jn=({error:e,onRetry:t})=>i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[i.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Loading error"}),i.jsx("p",{className:"text-gray-500 mb-4",children:e}),i.jsx("button",{onClick:t,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Retry"})]})}),kn=({onKnowledgeGraphClick:e,onFilteredDocumentsChange:t})=>{const[n,r]=z.useState([]),[s,a]=z.useState([]),[o,l]=z.useState([]),[u,c]=z.useState(""),[h,v]=z.useState(""),[g,y]=z.useState(""),[w,d]=z.useState(!0),[f,p]=z.useState(null),[N,S]=z.useState(1),[x,A]=z.useState(!1),[T,I]=z.useState(null),C=20;z.useEffect(()=>{(async()=>{const _=["/tech_documents/data/documents.json","/data/documents.json","./data/documents.json"];for(const k of _)try{console.log(`Trying to fetch from: ${k}`);const D=await fetch(k);if(D.ok){const E=await D.json();console.log("Successfully loaded documents:",E);const $=E.sort((P,F)=>new Date(F.upload_date).getTime()-new Date(P.upload_date).getTime());if(r($),a($),d(!1),typeof window<"u"){const F=new URLSearchParams(window.location.search).get("doc");F&&I(F)}return}}catch(D){console.log(`Failed to fetch from ${k}:`,D)}p("Unable to load documents from any path"),d(!1)})()},[]);const R=(j,m)=>{if(!m.trim())return j;const _=E=>{const $=E.split(/\s+(AND|OR|NOT)\s+/i),P=[];for(let F=0;F<$.length;F++){const L=$[F].trim();if(L&&!["AND","OR","NOT"].includes(L.toUpperCase())){const U=L.startsWith('"')&&L.endsWith('"'),X=U?L.slice(1,-1):L;P.push({term:X.toLowerCase(),operator:F>0?$[F-1].toUpperCase():"AND",isQuoted:U,isNegated:F>0&&$[F-1].toUpperCase()==="NOT"})}}return P.length>0?P:[{term:E.toLowerCase(),operator:"AND",isQuoted:!1,isNegated:!1}]},k=(E,$)=>{const{term:P,isQuoted:F}=$,L=[E.filename||"",E.title||"",E.summary||"",(E.authors||[]).join(" "),(E.keywords||[]).join(" ")].map(U=>U.toLowerCase());return F?L.some(U=>U.includes(P)):P.split(/\s+/).every(X=>L.some(K=>K.includes(X)))},D=_(m);return j.filter(E=>{let $=!0,P=!1;for(const L of D){const U=k(E,L);if(L.isNegated){if(U){$=!1;break}}else P=P||U,L.operator==="AND"?$=$&&U:L.operator==="OR"&&($=$||U)}return D.every(L=>L.isNegated)?$:$&&P})};z.useEffect(()=>{let j=n;u&&(j=R(j,u)),h&&(j=j.filter(m=>m.category===h)),g&&(j=j.filter(m=>m.difficulty===g)),a(j),S(1),t&&t(j)},[u,h,g,n,t]),z.useEffect(()=>{const m=N*C;let _=s.slice(0,m);if(T){const k=n.find(D=>D.id===T);k&&!_.find(D=>D.id===T)&&(_=[k,..._])}l(_)},[s,N,T,n]);const O=async()=>{A(!0),await new Promise(j=>setTimeout(j,500)),S(j=>j+1),A(!1)},B=o.length<s.length,V=s.length<=50,G=[...new Set(n.map(j=>j.category))],b=[...new Set(n.map(j=>j.difficulty))];return w?i.jsx(Nn,{}):f?i.jsx(jn,{error:f,onRetry:()=>typeof window<"u"?window.location.reload():void 0}):i.jsx("div",{className:"min-h-screen bg-gray-50",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[i.jsxs("header",{className:"text-center mb-12 relative",children:[i.jsxs("div",{className:"flex items-center justify-center mb-4",children:[i.jsx("img",{src:"https://www.fabiolonardoni.it/io_ds.png",alt:"Profile",className:"w-16 h-16 rounded-full mr-4 border-2 border-gray-300"}),i.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"AI & Data Science Library"}),i.jsx("div",{className:"text-4xl ml-4",children:"🤖"})]}),i.jsx("p",{className:"text-xl text-gray-600 mb-2",children:"Automated collection of Artificial Intelligence and Data Science documents"}),i.jsxs("p",{className:"text-sm text-gray-500",children:[n.length," documents • Click any document to preview"]}),i.jsxs("p",{className:"text-sm text-gray-500",children:["Developed by ",i.jsx("a",{href:"https://www.fabiolonardoni.it",className:"text-blue-500 hover:underline",children:"Fabio Lonardoni"})]})]}),i.jsx(_n,{searchTerm:u,setSearchTerm:c,selectedCategory:h,setSelectedCategory:v,selectedDifficulty:g,setSelectedDifficulty:y,categories:G,difficulties:b}),s.length>0?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[i.jsxs("div",{className:"text-sm text-gray-600 bg-white px-4 py-2 rounded-lg",children:["📊 Showing ",o.length," of ",s.length," documents",s.length!==n.length&&i.jsxs("span",{className:"text-gray-400",children:[" (filtered from ",n.length," total)"]})]}),i.jsxs("div",{className:`text-xs px-3 py-1 rounded-full ${V?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:["Knowledge Graph: ",V?"Available":"Unavailable"]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:o.map(j=>i.jsx(wn,{doc:j,autoOpen:T===j.id},j.id))}),B&&i.jsx("div",{className:"mt-8 text-center",children:i.jsx("button",{onClick:O,disabled:x,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium",children:x?i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Loading..."]}):`Load More (${s.length-o.length} remaining)`})})]}):i.jsxs("div",{className:"text-center py-16 bg-white rounded-lg",children:[i.jsx("div",{className:"text-6xl mb-4",children:"📭"}),i.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No documents found"}),i.jsx("p",{className:"text-gray-500",children:"Try modifying your search criteria"})]})]})})};class yt extends Map{constructor(t,n=An){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,s]of t)this.set(r,s)}get(t){return super.get(bt(this,t))}has(t){return super.has(bt(this,t))}set(t,n){return super.set(Cn(this,t),n)}delete(t){return super.delete(Sn(this,t))}}function bt({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function Cn({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Sn({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function An(e){return e!==null&&typeof e=="object"?e.valueOf():e}var Tn={value:()=>{}};function Te(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Le(n)}function Le(e){this._=e}function En(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Le.prototype=Te.prototype={constructor:Le,on:function(e,t){var n=this._,r=En(e+"",n),s,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((s=(e=r[a]).type)&&(s=Dn(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(s=(e=r[a]).type)n[s]=vt(n[s],e.name,t);else if(t==null)for(s in n)n[s]=vt(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Le(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,a;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,s=a.length;r<s;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,a=r.length;s<a;++s)r[s].value.apply(t,n)}};function Dn(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function vt(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=Tn,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var tt="http://www.w3.org/1999/xhtml";const wt={svg:"http://www.w3.org/2000/svg",xhtml:tt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xe(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),wt.hasOwnProperty(t)?{space:wt[t],local:e}:e}function Mn(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===tt&&t.documentElement.namespaceURI===tt?t.createElement(e):t.createElementNS(n,e)}}function $n(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Gt(e){var t=Xe(e);return(t.local?$n:Mn)(t)}function In(){}function ct(e){return e==null?In:function(){return this.querySelector(e)}}function zn(e){typeof e!="function"&&(e=ct(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var a=t[s],o=a.length,l=r[s]=new Array(o),u,c,h=0;h<o;++h)(u=a[h])&&(c=e.call(u,u.__data__,h,a))&&("__data__"in u&&(c.__data__=u.__data__),l[h]=c);return new J(r,this._parents)}function Pn(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ln(){return[]}function Ht(e){return e==null?Ln:function(){return this.querySelectorAll(e)}}function On(e){return function(){return Pn(e.apply(this,arguments))}}function Fn(e){typeof e=="function"?e=On(e):e=Ht(e);for(var t=this._groups,n=t.length,r=[],s=[],a=0;a<n;++a)for(var o=t[a],l=o.length,u,c=0;c<l;++c)(u=o[c])&&(r.push(e.call(u,u.__data__,c,o)),s.push(u));return new J(r,s)}function qt(e){return function(){return this.matches(e)}}function Vt(e){return function(t){return t.matches(e)}}var Rn=Array.prototype.find;function Bn(e){return function(){return Rn.call(this.children,e)}}function Un(){return this.firstElementChild}function Gn(e){return this.select(e==null?Un:Bn(typeof e=="function"?e:Vt(e)))}var Hn=Array.prototype.filter;function qn(){return Array.from(this.children)}function Vn(e){return function(){return Hn.call(this.children,e)}}function Xn(e){return this.selectAll(e==null?qn:Vn(typeof e=="function"?e:Vt(e)))}function Kn(e){typeof e!="function"&&(e=qt(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var a=t[s],o=a.length,l=r[s]=[],u,c=0;c<o;++c)(u=a[c])&&e.call(u,u.__data__,c,a)&&l.push(u);return new J(r,this._parents)}function Xt(e){return new Array(e.length)}function Yn(){return new J(this._enter||this._groups.map(Xt),this._parents)}function Be(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Be.prototype={constructor:Be,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Wn(e){return function(){return e}}function Qn(e,t,n,r,s,a){for(var o=0,l,u=t.length,c=a.length;o<c;++o)(l=t[o])?(l.__data__=a[o],r[o]=l):n[o]=new Be(e,a[o]);for(;o<u;++o)(l=t[o])&&(s[o]=l)}function Jn(e,t,n,r,s,a,o){var l,u,c=new Map,h=t.length,v=a.length,g=new Array(h),y;for(l=0;l<h;++l)(u=t[l])&&(g[l]=y=o.call(u,u.__data__,l,t)+"",c.has(y)?s[l]=u:c.set(y,u));for(l=0;l<v;++l)y=o.call(e,a[l],l,a)+"",(u=c.get(y))?(r[l]=u,u.__data__=a[l],c.delete(y)):n[l]=new Be(e,a[l]);for(l=0;l<h;++l)(u=t[l])&&c.get(g[l])===u&&(s[l]=u)}function Zn(e){return e.__data__}function er(e,t){if(!arguments.length)return Array.from(this,Zn);var n=t?Jn:Qn,r=this._parents,s=this._groups;typeof e!="function"&&(e=Wn(e));for(var a=s.length,o=new Array(a),l=new Array(a),u=new Array(a),c=0;c<a;++c){var h=r[c],v=s[c],g=v.length,y=tr(e.call(h,h&&h.__data__,c,r)),w=y.length,d=l[c]=new Array(w),f=o[c]=new Array(w),p=u[c]=new Array(g);n(h,v,d,f,p,y,t);for(var N=0,S=0,x,A;N<w;++N)if(x=d[N]){for(N>=S&&(S=N+1);!(A=f[S])&&++S<w;);x._next=A||null}}return o=new J(o,r),o._enter=l,o._exit=u,o}function tr(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function nr(){return new J(this._exit||this._groups.map(Xt),this._parents)}function rr(e,t,n){var r=this.enter(),s=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?a.remove():n(a),r&&s?r.merge(s).order():s}function ir(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,a=r.length,o=Math.min(s,a),l=new Array(s),u=0;u<o;++u)for(var c=n[u],h=r[u],v=c.length,g=l[u]=new Array(v),y,w=0;w<v;++w)(y=c[w]||h[w])&&(g[w]=y);for(;u<s;++u)l[u]=n[u];return new J(l,this._parents)}function sr(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,a=r[s],o;--s>=0;)(o=r[s])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function ar(e){e||(e=or);function t(v,g){return v&&g?e(v.__data__,g.__data__):!v-!g}for(var n=this._groups,r=n.length,s=new Array(r),a=0;a<r;++a){for(var o=n[a],l=o.length,u=s[a]=new Array(l),c,h=0;h<l;++h)(c=o[h])&&(u[h]=c);u.sort(t)}return new J(s,this._parents).order()}function or(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function lr(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function cr(){return Array.from(this)}function ur(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,a=r.length;s<a;++s){var o=r[s];if(o)return o}return null}function hr(){let e=0;for(const t of this)++e;return e}function dr(){return!this.node()}function fr(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],a=0,o=s.length,l;a<o;++a)(l=s[a])&&e.call(l,l.__data__,a,s);return this}function mr(e){return function(){this.removeAttribute(e)}}function gr(e){return function(){this.removeAttributeNS(e.space,e.local)}}function xr(e,t){return function(){this.setAttribute(e,t)}}function pr(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function yr(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function br(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function vr(e,t){var n=Xe(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?gr:mr:typeof t=="function"?n.local?br:yr:n.local?pr:xr)(n,t))}function Kt(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function wr(e){return function(){this.style.removeProperty(e)}}function _r(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Nr(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function jr(e,t,n){return arguments.length>1?this.each((t==null?wr:typeof t=="function"?Nr:_r)(e,t,n??"")):ye(this.node(),e)}function ye(e,t){return e.style.getPropertyValue(t)||Kt(e).getComputedStyle(e,null).getPropertyValue(t)}function kr(e){return function(){delete this[e]}}function Cr(e,t){return function(){this[e]=t}}function Sr(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Ar(e,t){return arguments.length>1?this.each((t==null?kr:typeof t=="function"?Sr:Cr)(e,t)):this.node()[e]}function Yt(e){return e.trim().split(/^|\s+/)}function ut(e){return e.classList||new Wt(e)}function Wt(e){this._node=e,this._names=Yt(e.getAttribute("class")||"")}Wt.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Qt(e,t){for(var n=ut(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function Jt(e,t){for(var n=ut(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function Tr(e){return function(){Qt(this,e)}}function Er(e){return function(){Jt(this,e)}}function Dr(e,t){return function(){(t.apply(this,arguments)?Qt:Jt)(this,e)}}function Mr(e,t){var n=Yt(e+"");if(arguments.length<2){for(var r=ut(this.node()),s=-1,a=n.length;++s<a;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?Dr:t?Tr:Er)(n,t))}function $r(){this.textContent=""}function Ir(e){return function(){this.textContent=e}}function zr(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Pr(e){return arguments.length?this.each(e==null?$r:(typeof e=="function"?zr:Ir)(e)):this.node().textContent}function Lr(){this.innerHTML=""}function Or(e){return function(){this.innerHTML=e}}function Fr(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Rr(e){return arguments.length?this.each(e==null?Lr:(typeof e=="function"?Fr:Or)(e)):this.node().innerHTML}function Br(){this.nextSibling&&this.parentNode.appendChild(this)}function Ur(){return this.each(Br)}function Gr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Hr(){return this.each(Gr)}function qr(e){var t=typeof e=="function"?e:Gt(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Vr(){return null}function Xr(e,t){var n=typeof e=="function"?e:Gt(e),r=t==null?Vr:typeof t=="function"?t:ct(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Kr(){var e=this.parentNode;e&&e.removeChild(this)}function Yr(){return this.each(Kr)}function Wr(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Qr(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Jr(e){return this.select(e?Qr:Wr)}function Zr(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ei(e){return function(t){e.call(this,t,this.__data__)}}function ti(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function ni(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,a;n<s;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function ri(e,t,n){return function(){var r=this.__on,s,a=ei(t);if(r){for(var o=0,l=r.length;o<l;++o)if((s=r[o]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=a,s.options=n),s.value=t;return}}this.addEventListener(e.type,a,n),s={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(s):this.__on=[s]}}function ii(e,t,n){var r=ti(e+""),s,a=r.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,c=l.length,h;u<c;++u)for(s=0,h=l[u];s<a;++s)if((o=r[s]).type===h.type&&o.name===h.name)return h.value}return}for(l=t?ri:ni,s=0;s<a;++s)this.each(l(r[s],t,n));return this}function Zt(e,t,n){var r=Kt(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function si(e,t){return function(){return Zt(this,e,t)}}function ai(e,t){return function(){return Zt(this,e,t.apply(this,arguments))}}function oi(e,t){return this.each((typeof t=="function"?ai:si)(e,t))}function*li(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,a=r.length,o;s<a;++s)(o=r[s])&&(yield o)}var en=[null];function J(e,t){this._groups=e,this._parents=t}function Ee(){return new J([[document.documentElement]],en)}function ci(){return this}J.prototype=Ee.prototype={constructor:J,select:zn,selectAll:Fn,selectChild:Gn,selectChildren:Xn,filter:Kn,data:er,enter:Yn,exit:nr,join:rr,merge:ir,selection:ci,order:sr,sort:ar,call:lr,nodes:cr,node:ur,size:hr,empty:dr,each:fr,attr:vr,style:jr,property:Ar,classed:Mr,text:Pr,html:Rr,raise:Ur,lower:Hr,append:qr,insert:Xr,remove:Yr,clone:Jr,datum:Zr,on:ii,dispatch:oi,[Symbol.iterator]:li};function ne(e){return typeof e=="string"?new J([[document.querySelector(e)]],[document.documentElement]):new J([[e]],en)}function ui(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ae(e,t){if(e=ui(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const hi={passive:!1},je={capture:!0,passive:!1};function Qe(e){e.stopImmediatePropagation()}function xe(e){e.preventDefault(),e.stopImmediatePropagation()}function tn(e){var t=e.document.documentElement,n=ne(e).on("dragstart.drag",xe,je);"onselectstart"in t?n.on("selectstart.drag",xe,je):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function nn(e,t){var n=e.document.documentElement,r=ne(e).on("dragstart.drag",null);t&&(r.on("click.drag",xe,je),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Me=e=>()=>e;function nt(e,{sourceEvent:t,subject:n,target:r,identifier:s,active:a,x:o,y:l,dx:u,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}nt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function di(e){return!e.ctrlKey&&!e.button}function fi(){return this.parentNode}function mi(e,t){return t??{x:e.x,y:e.y}}function gi(){return navigator.maxTouchPoints||"ontouchstart"in this}function xi(){var e=di,t=fi,n=mi,r=gi,s={},a=Te("start","drag","end"),o=0,l,u,c,h,v=0;function g(x){x.on("mousedown.drag",y).filter(r).on("touchstart.drag",f).on("touchmove.drag",p,hi).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(x,A){if(!(h||!e.call(this,x,A))){var T=S(this,t.call(this,x,A),x,A,"mouse");T&&(ne(x.view).on("mousemove.drag",w,je).on("mouseup.drag",d,je),tn(x.view),Qe(x),c=!1,l=x.clientX,u=x.clientY,T("start",x))}}function w(x){if(xe(x),!c){var A=x.clientX-l,T=x.clientY-u;c=A*A+T*T>v}s.mouse("drag",x)}function d(x){ne(x.view).on("mousemove.drag mouseup.drag",null),nn(x.view,c),xe(x),s.mouse("end",x)}function f(x,A){if(e.call(this,x,A)){var T=x.changedTouches,I=t.call(this,x,A),C=T.length,R,O;for(R=0;R<C;++R)(O=S(this,I,x,A,T[R].identifier,T[R]))&&(Qe(x),O("start",x,T[R]))}}function p(x){var A=x.changedTouches,T=A.length,I,C;for(I=0;I<T;++I)(C=s[A[I].identifier])&&(xe(x),C("drag",x,A[I]))}function N(x){var A=x.changedTouches,T=A.length,I,C;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),I=0;I<T;++I)(C=s[A[I].identifier])&&(Qe(x),C("end",x,A[I]))}function S(x,A,T,I,C,R){var O=a.copy(),B=ae(R||T,A),V,G,b;if((b=n.call(x,new nt("beforestart",{sourceEvent:T,target:g,identifier:C,active:o,x:B[0],y:B[1],dx:0,dy:0,dispatch:O}),I))!=null)return V=b.x-B[0]||0,G=b.y-B[1]||0,function j(m,_,k){var D=B,E;switch(m){case"start":s[C]=j,E=o++;break;case"end":delete s[C],--o;case"drag":B=ae(k||_,A),E=o;break}O.call(m,x,new nt(m,{sourceEvent:_,subject:b,target:g,identifier:C,active:E,x:B[0]+V,y:B[1]+G,dx:B[0]-D[0],dy:B[1]-D[1],dispatch:O}),I)}}return g.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Me(!!x),g):e},g.container=function(x){return arguments.length?(t=typeof x=="function"?x:Me(x),g):t},g.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Me(x),g):n},g.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:Me(!!x),g):r},g.on=function(){var x=a.on.apply(a,arguments);return x===a?g:x},g.clickDistance=function(x){return arguments.length?(v=(x=+x)*x,g):Math.sqrt(v)},g}function ht(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function rn(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function De(){}var ke=.7,Ue=1/ke,pe="\\s*([+-]?\\d+)\\s*",Ce="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",re="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pi=/^#([0-9a-f]{3,8})$/,yi=new RegExp(`^rgb\\(${pe},${pe},${pe}\\)$`),bi=new RegExp(`^rgb\\(${re},${re},${re}\\)$`),vi=new RegExp(`^rgba\\(${pe},${pe},${pe},${Ce}\\)$`),wi=new RegExp(`^rgba\\(${re},${re},${re},${Ce}\\)$`),_i=new RegExp(`^hsl\\(${Ce},${re},${re}\\)$`),Ni=new RegExp(`^hsla\\(${Ce},${re},${re},${Ce}\\)$`),_t={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ht(De,Se,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Nt,formatHex:Nt,formatHex8:ji,formatHsl:ki,formatRgb:jt,toString:jt});function Nt(){return this.rgb().formatHex()}function ji(){return this.rgb().formatHex8()}function ki(){return sn(this).formatHsl()}function jt(){return this.rgb().formatRgb()}function Se(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pi.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?kt(t):n===3?new Q(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$e(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$e(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yi.exec(e))?new Q(t[1],t[2],t[3],1):(t=bi.exec(e))?new Q(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vi.exec(e))?$e(t[1],t[2],t[3],t[4]):(t=wi.exec(e))?$e(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_i.exec(e))?At(t[1],t[2]/100,t[3]/100,1):(t=Ni.exec(e))?At(t[1],t[2]/100,t[3]/100,t[4]):_t.hasOwnProperty(e)?kt(_t[e]):e==="transparent"?new Q(NaN,NaN,NaN,0):null}function kt(e){return new Q(e>>16&255,e>>8&255,e&255,1)}function $e(e,t,n,r){return r<=0&&(e=t=n=NaN),new Q(e,t,n,r)}function Ci(e){return e instanceof De||(e=Se(e)),e?(e=e.rgb(),new Q(e.r,e.g,e.b,e.opacity)):new Q}function rt(e,t,n,r){return arguments.length===1?Ci(e):new Q(e,t,n,r??1)}function Q(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ht(Q,rt,rn(De,{brighter(e){return e=e==null?Ue:Math.pow(Ue,e),new Q(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ke:Math.pow(ke,e),new Q(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Q(de(this.r),de(this.g),de(this.b),Ge(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ct,formatHex:Ct,formatHex8:Si,formatRgb:St,toString:St}));function Ct(){return`#${he(this.r)}${he(this.g)}${he(this.b)}`}function Si(){return`#${he(this.r)}${he(this.g)}${he(this.b)}${he((isNaN(this.opacity)?1:this.opacity)*255)}`}function St(){const e=Ge(this.opacity);return`${e===1?"rgb(":"rgba("}${de(this.r)}, ${de(this.g)}, ${de(this.b)}${e===1?")":`, ${e})`}`}function Ge(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function de(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function he(e){return e=de(e),(e<16?"0":"")+e.toString(16)}function At(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ee(e,t,n,r)}function sn(e){if(e instanceof ee)return new ee(e.h,e.s,e.l,e.opacity);if(e instanceof De||(e=Se(e)),!e)return new ee;if(e instanceof ee)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,l=a-s,u=(a+s)/2;return l?(t===a?o=(n-r)/l+(n<r)*6:n===a?o=(r-t)/l+2:o=(t-n)/l+4,l/=u<.5?a+s:2-a-s,o*=60):l=u>0&&u<1?0:o,new ee(o,l,u,e.opacity)}function Ai(e,t,n,r){return arguments.length===1?sn(e):new ee(e,t,n,r??1)}function ee(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ht(ee,Ai,rn(De,{brighter(e){return e=e==null?Ue:Math.pow(Ue,e),new ee(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ke:Math.pow(ke,e),new ee(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new Q(Je(e>=240?e-240:e+120,s,r),Je(e,s,r),Je(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new ee(Tt(this.h),Ie(this.s),Ie(this.l),Ge(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ge(this.opacity);return`${e===1?"hsl(":"hsla("}${Tt(this.h)}, ${Ie(this.s)*100}%, ${Ie(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Tt(e){return e=(e||0)%360,e<0?e+360:e}function Ie(e){return Math.max(0,Math.min(1,e||0))}function Je(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const an=e=>()=>e;function Ti(e,t){return function(n){return e+n*t}}function Ei(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Di(e){return(e=+e)==1?on:function(t,n){return n-t?Ei(t,n,e):an(isNaN(t)?n:t)}}function on(e,t){var n=t-e;return n?Ti(e,n):an(isNaN(e)?t:e)}const Et=function e(t){var n=Di(t);function r(s,a){var o=n((s=rt(s)).r,(a=rt(a)).r),l=n(s.g,a.g),u=n(s.b,a.b),c=on(s.opacity,a.opacity);return function(h){return s.r=o(h),s.g=l(h),s.b=u(h),s.opacity=c(h),s+""}}return r.gamma=e,r}(1);function ce(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var it=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ze=new RegExp(it.source,"g");function Mi(e){return function(){return e}}function $i(e){return function(t){return e(t)+""}}function Ii(e,t){var n=it.lastIndex=Ze.lastIndex=0,r,s,a,o=-1,l=[],u=[];for(e=e+"",t=t+"";(r=it.exec(e))&&(s=Ze.exec(t));)(a=s.index)>n&&(a=t.slice(n,a),l[o]?l[o]+=a:l[++o]=a),(r=r[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,u.push({i:o,x:ce(r,s)})),n=Ze.lastIndex;return n<t.length&&(a=t.slice(n),l[o]?l[o]+=a:l[++o]=a),l.length<2?u[0]?$i(u[0].x):Mi(t):(t=u.length,function(c){for(var h=0,v;h<t;++h)l[(v=u[h]).i]=v.x(c);return l.join("")})}var Dt=180/Math.PI,st={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ln(e,t,n,r,s,a){var o,l,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,u/=l),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:s,translateY:a,rotate:Math.atan2(t,e)*Dt,skewX:Math.atan(u)*Dt,scaleX:o,scaleY:l}}var ze;function zi(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?st:ln(t.a,t.b,t.c,t.d,t.e,t.f)}function Pi(e){return e==null||(ze||(ze=document.createElementNS("http://www.w3.org/2000/svg","g")),ze.setAttribute("transform",e),!(e=ze.transform.baseVal.consolidate()))?st:(e=e.matrix,ln(e.a,e.b,e.c,e.d,e.e,e.f))}function cn(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function a(c,h,v,g,y,w){if(c!==v||h!==g){var d=y.push("translate(",null,t,null,n);w.push({i:d-4,x:ce(c,v)},{i:d-2,x:ce(h,g)})}else(v||g)&&y.push("translate("+v+t+g+n)}function o(c,h,v,g){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),g.push({i:v.push(s(v)+"rotate(",null,r)-2,x:ce(c,h)})):h&&v.push(s(v)+"rotate("+h+r)}function l(c,h,v,g){c!==h?g.push({i:v.push(s(v)+"skewX(",null,r)-2,x:ce(c,h)}):h&&v.push(s(v)+"skewX("+h+r)}function u(c,h,v,g,y,w){if(c!==v||h!==g){var d=y.push(s(y)+"scale(",null,",",null,")");w.push({i:d-4,x:ce(c,v)},{i:d-2,x:ce(h,g)})}else(v!==1||g!==1)&&y.push(s(y)+"scale("+v+","+g+")")}return function(c,h){var v=[],g=[];return c=e(c),h=e(h),a(c.translateX,c.translateY,h.translateX,h.translateY,v,g),o(c.rotate,h.rotate,v,g),l(c.skewX,h.skewX,v,g),u(c.scaleX,c.scaleY,h.scaleX,h.scaleY,v,g),c=h=null,function(y){for(var w=-1,d=g.length,f;++w<d;)v[(f=g[w]).i]=f.x(y);return v.join("")}}}var Li=cn(zi,"px, ","px)","deg)"),Oi=cn(Pi,", ",")",")"),Fi=1e-12;function Mt(e){return((e=Math.exp(e))+1/e)/2}function Ri(e){return((e=Math.exp(e))-1/e)/2}function Bi(e){return((e=Math.exp(2*e))-1)/(e+1)}const Ui=function e(t,n,r){function s(a,o){var l=a[0],u=a[1],c=a[2],h=o[0],v=o[1],g=o[2],y=h-l,w=v-u,d=y*y+w*w,f,p;if(d<Fi)p=Math.log(g/c)/t,f=function(I){return[l+I*y,u+I*w,c*Math.exp(t*I*p)]};else{var N=Math.sqrt(d),S=(g*g-c*c+r*d)/(2*c*n*N),x=(g*g-c*c-r*d)/(2*g*n*N),A=Math.log(Math.sqrt(S*S+1)-S),T=Math.log(Math.sqrt(x*x+1)-x);p=(T-A)/t,f=function(I){var C=I*p,R=Mt(A),O=c/(n*N)*(R*Bi(t*C+A)-Ri(A));return[l+O*y,u+O*w,c*R/Mt(t*C+A)]}}return f.duration=p*1e3*t/Math.SQRT2,f}return s.rho=function(a){var o=Math.max(.001,+a),l=o*o,u=l*l;return e(o,l,u)},s}(Math.SQRT2,2,4);var be=0,_e=0,ve=0,un=1e3,He,Ne,qe=0,me=0,Ke=0,Ae=typeof performance=="object"&&performance.now?performance:Date,hn=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function dt(){return me||(hn(Gi),me=Ae.now()+Ke)}function Gi(){me=0}function Ve(){this._call=this._time=this._next=null}Ve.prototype=ft.prototype={constructor:Ve,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?dt():+n)+(t==null?0:+t),!this._next&&Ne!==this&&(Ne?Ne._next=this:He=this,Ne=this),this._call=e,this._time=n,at()},stop:function(){this._call&&(this._call=null,this._time=1/0,at())}};function ft(e,t,n){var r=new Ve;return r.restart(e,t,n),r}function Hi(){dt(),++be;for(var e=He,t;e;)(t=me-e._time)>=0&&e._call.call(void 0,t),e=e._next;--be}function $t(){me=(qe=Ae.now())+Ke,be=_e=0;try{Hi()}finally{be=0,Vi(),me=0}}function qi(){var e=Ae.now(),t=e-qe;t>un&&(Ke-=t,qe=e)}function Vi(){for(var e,t=He,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:He=n);Ne=e,at(r)}function at(e){if(!be){_e&&(_e=clearTimeout(_e));var t=e-me;t>24?(e<1/0&&(_e=setTimeout($t,e-Ae.now()-Ke)),ve&&(ve=clearInterval(ve))):(ve||(qe=Ae.now(),ve=setInterval(qi,un)),be=1,hn($t))}}function It(e,t,n){var r=new Ve;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var Xi=Te("start","end","cancel","interrupt"),Ki=[],dn=0,zt=1,ot=2,Oe=3,Pt=4,lt=5,Fe=6;function Ye(e,t,n,r,s,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;Yi(e,n,{name:t,index:r,group:s,on:Xi,tween:Ki,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:dn})}function mt(e,t){var n=te(e,t);if(n.state>dn)throw new Error("too late; already scheduled");return n}function ie(e,t){var n=te(e,t);if(n.state>Oe)throw new Error("too late; already running");return n}function te(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Yi(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=ft(a,0,n.time);function a(c){n.state=zt,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var h,v,g,y;if(n.state!==zt)return u();for(h in r)if(y=r[h],y.name===n.name){if(y.state===Oe)return It(o);y.state===Pt?(y.state=Fe,y.timer.stop(),y.on.call("interrupt",e,e.__data__,y.index,y.group),delete r[h]):+h<t&&(y.state=Fe,y.timer.stop(),y.on.call("cancel",e,e.__data__,y.index,y.group),delete r[h])}if(It(function(){n.state===Oe&&(n.state=Pt,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=ot,n.on.call("start",e,e.__data__,n.index,n.group),n.state===ot){for(n.state=Oe,s=new Array(g=n.tween.length),h=0,v=-1;h<g;++h)(y=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(s[++v]=y);s.length=v+1}}function l(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=lt,1),v=-1,g=s.length;++v<g;)s[v].call(e,h);n.state===lt&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){n.state=Fe,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function Re(e,t){var n=e.__transition,r,s,a=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){a=!1;continue}s=r.state>ot&&r.state<lt,r.state=Fe,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function Wi(e){return this.each(function(){Re(this,e)})}function Qi(e,t){var n,r;return function(){var s=ie(this,e),a=s.tween;if(a!==n){r=n=a;for(var o=0,l=r.length;o<l;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}s.tween=r}}function Ji(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var a=ie(this,e),o=a.tween;if(o!==r){s=(r=o).slice();for(var l={name:t,value:n},u=0,c=s.length;u<c;++u)if(s[u].name===t){s[u]=l;break}u===c&&s.push(l)}a.tween=s}}function Zi(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=te(this.node(),n).tween,s=0,a=r.length,o;s<a;++s)if((o=r[s]).name===e)return o.value;return null}return this.each((t==null?Qi:Ji)(n,e,t))}function gt(e,t,n){var r=e._id;return e.each(function(){var s=ie(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return te(s,r).value[t]}}function fn(e,t){var n;return(typeof t=="number"?ce:t instanceof Se?Et:(n=Se(t))?(t=n,Et):Ii)(e,t)}function es(e){return function(){this.removeAttribute(e)}}function ts(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ns(e,t,n){var r,s=n+"",a;return function(){var o=this.getAttribute(e);return o===s?null:o===r?a:a=t(r=o,n)}}function rs(e,t,n){var r,s=n+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===s?null:o===r?a:a=t(r=o,n)}}function is(e,t,n){var r,s,a;return function(){var o,l=n(this),u;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),u=l+"",o===u?null:o===r&&u===s?a:(s=u,a=t(r=o,l)))}}function ss(e,t,n){var r,s,a;return function(){var o,l=n(this),u;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),u=l+"",o===u?null:o===r&&u===s?a:(s=u,a=t(r=o,l)))}}function as(e,t){var n=Xe(e),r=n==="transform"?Oi:fn;return this.attrTween(e,typeof t=="function"?(n.local?ss:is)(n,r,gt(this,"attr."+e,t)):t==null?(n.local?ts:es)(n):(n.local?rs:ns)(n,r,t))}function os(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ls(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function cs(e,t){var n,r;function s(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&ls(e,a)),n}return s._value=t,s}function us(e,t){var n,r;function s(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&os(e,a)),n}return s._value=t,s}function hs(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Xe(e);return this.tween(n,(r.local?cs:us)(r,t))}function ds(e,t){return function(){mt(this,e).delay=+t.apply(this,arguments)}}function fs(e,t){return t=+t,function(){mt(this,e).delay=t}}function ms(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ds:fs)(t,e)):te(this.node(),t).delay}function gs(e,t){return function(){ie(this,e).duration=+t.apply(this,arguments)}}function xs(e,t){return t=+t,function(){ie(this,e).duration=t}}function ps(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?gs:xs)(t,e)):te(this.node(),t).duration}function ys(e,t){if(typeof t!="function")throw new Error;return function(){ie(this,e).ease=t}}function bs(e){var t=this._id;return arguments.length?this.each(ys(t,e)):te(this.node(),t).ease}function vs(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ie(this,e).ease=n}}function ws(e){if(typeof e!="function")throw new Error;return this.each(vs(this._id,e))}function _s(e){typeof e!="function"&&(e=qt(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var a=t[s],o=a.length,l=r[s]=[],u,c=0;c<o;++c)(u=a[c])&&e.call(u,u.__data__,c,a)&&l.push(u);return new le(r,this._parents,this._name,this._id)}function Ns(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,a=Math.min(r,s),o=new Array(r),l=0;l<a;++l)for(var u=t[l],c=n[l],h=u.length,v=o[l]=new Array(h),g,y=0;y<h;++y)(g=u[y]||c[y])&&(v[y]=g);for(;l<r;++l)o[l]=t[l];return new le(o,this._parents,this._name,this._id)}function js(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function ks(e,t,n){var r,s,a=js(t)?mt:ie;return function(){var o=a(this,e),l=o.on;l!==r&&(s=(r=l).copy()).on(t,n),o.on=s}}function Cs(e,t){var n=this._id;return arguments.length<2?te(this.node(),n).on.on(e):this.each(ks(n,e,t))}function Ss(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function As(){return this.on("end.remove",Ss(this._id))}function Ts(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ct(e));for(var r=this._groups,s=r.length,a=new Array(s),o=0;o<s;++o)for(var l=r[o],u=l.length,c=a[o]=new Array(u),h,v,g=0;g<u;++g)(h=l[g])&&(v=e.call(h,h.__data__,g,l))&&("__data__"in h&&(v.__data__=h.__data__),c[g]=v,Ye(c[g],t,n,g,c,te(h,n)));return new le(a,this._parents,t,n)}function Es(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ht(e));for(var r=this._groups,s=r.length,a=[],o=[],l=0;l<s;++l)for(var u=r[l],c=u.length,h,v=0;v<c;++v)if(h=u[v]){for(var g=e.call(h,h.__data__,v,u),y,w=te(h,n),d=0,f=g.length;d<f;++d)(y=g[d])&&Ye(y,t,n,d,g,w);a.push(g),o.push(h)}return new le(a,o,t,n)}var Ds=Ee.prototype.constructor;function Ms(){return new Ds(this._groups,this._parents)}function $s(e,t){var n,r,s;return function(){var a=ye(this,e),o=(this.style.removeProperty(e),ye(this,e));return a===o?null:a===n&&o===r?s:s=t(n=a,r=o)}}function mn(e){return function(){this.style.removeProperty(e)}}function Is(e,t,n){var r,s=n+"",a;return function(){var o=ye(this,e);return o===s?null:o===r?a:a=t(r=o,n)}}function zs(e,t,n){var r,s,a;return function(){var o=ye(this,e),l=n(this),u=l+"";return l==null&&(u=l=(this.style.removeProperty(e),ye(this,e))),o===u?null:o===r&&u===s?a:(s=u,a=t(r=o,l))}}function Ps(e,t){var n,r,s,a="style."+t,o="end."+a,l;return function(){var u=ie(this,e),c=u.on,h=u.value[a]==null?l||(l=mn(t)):void 0;(c!==n||s!==h)&&(r=(n=c).copy()).on(o,s=h),u.on=r}}function Ls(e,t,n){var r=(e+="")=="transform"?Li:fn;return t==null?this.styleTween(e,$s(e,r)).on("end.style."+e,mn(e)):typeof t=="function"?this.styleTween(e,zs(e,r,gt(this,"style."+e,t))).each(Ps(this._id,e)):this.styleTween(e,Is(e,r,t),n).on("end.style."+e,null)}function Os(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Fs(e,t,n){var r,s;function a(){var o=t.apply(this,arguments);return o!==s&&(r=(s=o)&&Os(e,o,n)),r}return a._value=t,a}function Rs(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Fs(e,t,n??""))}function Bs(e){return function(){this.textContent=e}}function Us(e){return function(){var t=e(this);this.textContent=t??""}}function Gs(e){return this.tween("text",typeof e=="function"?Us(gt(this,"text",e)):Bs(e==null?"":e+""))}function Hs(e){return function(t){this.textContent=e.call(this,t)}}function qs(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&Hs(s)),t}return r._value=e,r}function Vs(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,qs(e))}function Xs(){for(var e=this._name,t=this._id,n=gn(),r=this._groups,s=r.length,a=0;a<s;++a)for(var o=r[a],l=o.length,u,c=0;c<l;++c)if(u=o[c]){var h=te(u,t);Ye(u,e,n,c,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new le(r,this._parents,e,n)}function Ks(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(a,o){var l={value:o},u={value:function(){--s===0&&a()}};n.each(function(){var c=ie(this,r),h=c.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(u)),c.on=t}),s===0&&a()})}var Ys=0;function le(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function gn(){return++Ys}var se=Ee.prototype;le.prototype={constructor:le,select:Ts,selectAll:Es,selectChild:se.selectChild,selectChildren:se.selectChildren,filter:_s,merge:Ns,selection:Ms,transition:Xs,call:se.call,nodes:se.nodes,node:se.node,size:se.size,empty:se.empty,each:se.each,on:Cs,attr:as,attrTween:hs,style:Ls,styleTween:Rs,text:Gs,textTween:Vs,remove:As,tween:Zi,delay:ms,duration:ps,ease:bs,easeVarying:ws,end:Ks,[Symbol.iterator]:se[Symbol.iterator]};function Ws(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Qs={time:null,delay:0,duration:250,ease:Ws};function Js(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Zs(e){var t,n;e instanceof le?(t=e._id,e=e._name):(t=gn(),(n=Qs).time=dt(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,a=0;a<s;++a)for(var o=r[a],l=o.length,u,c=0;c<l;++c)(u=o[c])&&Ye(u,e,t,c,o,n||Js(u,t));return new le(r,this._parents,e,t)}Ee.prototype.interrupt=Wi;Ee.prototype.transition=Zs;function ea(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function s(){var a,o=n.length,l,u=0,c=0;for(a=0;a<o;++a)l=n[a],u+=l.x,c+=l.y;for(u=(u/o-e)*r,c=(c/o-t)*r,a=0;a<o;++a)l=n[a],l.x-=u,l.y-=c}return s.initialize=function(a){n=a},s.x=function(a){return arguments.length?(e=+a,s):e},s.y=function(a){return arguments.length?(t=+a,s):t},s.strength=function(a){return arguments.length?(r=+a,s):r},s}function ta(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return xn(this.cover(t,n),t,n,e)}function xn(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var s,a=e._root,o={data:r},l=e._x0,u=e._y0,c=e._x1,h=e._y1,v,g,y,w,d,f,p,N;if(!a)return e._root=o,e;for(;a.length;)if((d=t>=(v=(l+c)/2))?l=v:c=v,(f=n>=(g=(u+h)/2))?u=g:h=g,s=a,!(a=a[p=f<<1|d]))return s[p]=o,e;if(y=+e._x.call(null,a.data),w=+e._y.call(null,a.data),t===y&&n===w)return o.next=a,s?s[p]=o:e._root=o,e;do s=s?s[p]=new Array(4):e._root=new Array(4),(d=t>=(v=(l+c)/2))?l=v:c=v,(f=n>=(g=(u+h)/2))?u=g:h=g;while((p=f<<1|d)===(N=(w>=g)<<1|y>=v));return s[N]=a,s[p]=o,e}function na(e){var t,n,r=e.length,s,a,o=new Array(r),l=new Array(r),u=1/0,c=1/0,h=-1/0,v=-1/0;for(n=0;n<r;++n)isNaN(s=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=s,l[n]=a,s<u&&(u=s),s>h&&(h=s),a<c&&(c=a),a>v&&(v=a));if(u>h||c>v)return this;for(this.cover(u,c).cover(h,v),n=0;n<r;++n)xn(this,o[n],l[n],e[n]);return this}function ra(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,s=this._x1,a=this._y1;if(isNaN(n))s=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=s-n||1,l=this._root,u,c;n>e||e>=s||r>t||t>=a;)switch(c=(t<r)<<1|e<n,u=new Array(4),u[c]=l,l=u,o*=2,c){case 0:s=n+o,a=r+o;break;case 1:n=s-o,a=r+o;break;case 2:s=n+o,r=a-o;break;case 3:n=s-o,r=a-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=s,this._y1=a,this}function ia(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function sa(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Y(e,t,n,r,s){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=s}function aa(e,t,n){var r,s=this._x0,a=this._y0,o,l,u,c,h=this._x1,v=this._y1,g=[],y=this._root,w,d;for(y&&g.push(new Y(y,s,a,h,v)),n==null?n=1/0:(s=e-n,a=t-n,h=e+n,v=t+n,n*=n);w=g.pop();)if(!(!(y=w.node)||(o=w.x0)>h||(l=w.y0)>v||(u=w.x1)<s||(c=w.y1)<a))if(y.length){var f=(o+u)/2,p=(l+c)/2;g.push(new Y(y[3],f,p,u,c),new Y(y[2],o,p,f,c),new Y(y[1],f,l,u,p),new Y(y[0],o,l,f,p)),(d=(t>=p)<<1|e>=f)&&(w=g[g.length-1],g[g.length-1]=g[g.length-1-d],g[g.length-1-d]=w)}else{var N=e-+this._x.call(null,y.data),S=t-+this._y.call(null,y.data),x=N*N+S*S;if(x<n){var A=Math.sqrt(n=x);s=e-A,a=t-A,h=e+A,v=t+A,r=y.data}}return r}function oa(e){if(isNaN(h=+this._x.call(null,e))||isNaN(v=+this._y.call(null,e)))return this;var t,n=this._root,r,s,a,o=this._x0,l=this._y0,u=this._x1,c=this._y1,h,v,g,y,w,d,f,p;if(!n)return this;if(n.length)for(;;){if((w=h>=(g=(o+u)/2))?o=g:u=g,(d=v>=(y=(l+c)/2))?l=y:c=y,t=n,!(n=n[f=d<<1|w]))return this;if(!n.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(r=t,p=f)}for(;n.data!==e;)if(s=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,s?(a?s.next=a:delete s.next,this):t?(a?t[f]=a:delete t[f],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[p]=n:this._root=n),this):(this._root=a,this)}function la(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function ca(){return this._root}function ua(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function ha(e){var t=[],n,r=this._root,s,a,o,l,u;for(r&&t.push(new Y(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,l=n.x1,u=n.y1)&&r.length){var c=(a+l)/2,h=(o+u)/2;(s=r[3])&&t.push(new Y(s,c,h,l,u)),(s=r[2])&&t.push(new Y(s,a,h,c,u)),(s=r[1])&&t.push(new Y(s,c,o,l,h)),(s=r[0])&&t.push(new Y(s,a,o,c,h))}return this}function da(e){var t=[],n=[],r;for(this._root&&t.push(new Y(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var s=r.node;if(s.length){var a,o=r.x0,l=r.y0,u=r.x1,c=r.y1,h=(o+u)/2,v=(l+c)/2;(a=s[0])&&t.push(new Y(a,o,l,h,v)),(a=s[1])&&t.push(new Y(a,h,l,u,v)),(a=s[2])&&t.push(new Y(a,o,v,h,c)),(a=s[3])&&t.push(new Y(a,h,v,u,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function fa(e){return e[0]}function ma(e){return arguments.length?(this._x=e,this):this._x}function ga(e){return e[1]}function xa(e){return arguments.length?(this._y=e,this):this._y}function xt(e,t,n){var r=new pt(t??fa,n??ga,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function pt(e,t,n,r,s,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=s,this._y1=a,this._root=void 0}function Lt(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var W=xt.prototype=pt.prototype;W.copy=function(){var e=new pt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Lt(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var s=0;s<4;++s)(r=t.source[s])&&(r.length?n.push({source:r,target:t.target[s]=new Array(4)}):t.target[s]=Lt(r));return e};W.add=ta;W.addAll=na;W.cover=ra;W.data=ia;W.extent=sa;W.find=aa;W.remove=oa;W.removeAll=la;W.root=ca;W.size=ua;W.visit=ha;W.visitAfter=da;W.x=ma;W.y=xa;function fe(e){return function(){return e}}function ue(e){return(e()-.5)*1e-6}function pa(e){return e.x+e.vx}function ya(e){return e.y+e.vy}function ba(e){var t,n,r,s=1,a=1;typeof e!="function"&&(e=fe(e==null?1:+e));function o(){for(var c,h=t.length,v,g,y,w,d,f,p=0;p<a;++p)for(v=xt(t,pa,ya).visitAfter(l),c=0;c<h;++c)g=t[c],d=n[g.index],f=d*d,y=g.x+g.vx,w=g.y+g.vy,v.visit(N);function N(S,x,A,T,I){var C=S.data,R=S.r,O=d+R;if(C){if(C.index>g.index){var B=y-C.x-C.vx,V=w-C.y-C.vy,G=B*B+V*V;G<O*O&&(B===0&&(B=ue(r),G+=B*B),V===0&&(V=ue(r),G+=V*V),G=(O-(G=Math.sqrt(G)))/G*s,g.vx+=(B*=G)*(O=(R*=R)/(f+R)),g.vy+=(V*=G)*O,C.vx-=B*(O=1-O),C.vy-=V*O)}return}return x>y+O||T<y-O||A>w+O||I<w-O}}function l(c){if(c.data)return c.r=n[c.data.index];for(var h=c.r=0;h<4;++h)c[h]&&c[h].r>c.r&&(c.r=c[h].r)}function u(){if(t){var c,h=t.length,v;for(n=new Array(h),c=0;c<h;++c)v=t[c],n[v.index]=+e(v,c,t)}}return o.initialize=function(c,h){t=c,r=h,u()},o.iterations=function(c){return arguments.length?(a=+c,o):a},o.strength=function(c){return arguments.length?(s=+c,o):s},o.radius=function(c){return arguments.length?(e=typeof c=="function"?c:fe(+c),u(),o):e},o}function va(e){return e.index}function Ot(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function wa(e){var t=va,n=v,r,s=fe(30),a,o,l,u,c,h=1;e==null&&(e=[]);function v(f){return 1/Math.min(l[f.source.index],l[f.target.index])}function g(f){for(var p=0,N=e.length;p<h;++p)for(var S=0,x,A,T,I,C,R,O;S<N;++S)x=e[S],A=x.source,T=x.target,I=T.x+T.vx-A.x-A.vx||ue(c),C=T.y+T.vy-A.y-A.vy||ue(c),R=Math.sqrt(I*I+C*C),R=(R-a[S])/R*f*r[S],I*=R,C*=R,T.vx-=I*(O=u[S]),T.vy-=C*O,A.vx+=I*(O=1-O),A.vy+=C*O}function y(){if(o){var f,p=o.length,N=e.length,S=new Map(o.map((A,T)=>[t(A,T,o),A])),x;for(f=0,l=new Array(p);f<N;++f)x=e[f],x.index=f,typeof x.source!="object"&&(x.source=Ot(S,x.source)),typeof x.target!="object"&&(x.target=Ot(S,x.target)),l[x.source.index]=(l[x.source.index]||0)+1,l[x.target.index]=(l[x.target.index]||0)+1;for(f=0,u=new Array(N);f<N;++f)x=e[f],u[f]=l[x.source.index]/(l[x.source.index]+l[x.target.index]);r=new Array(N),w(),a=new Array(N),d()}}function w(){if(o)for(var f=0,p=e.length;f<p;++f)r[f]=+n(e[f],f,e)}function d(){if(o)for(var f=0,p=e.length;f<p;++f)a[f]=+s(e[f],f,e)}return g.initialize=function(f,p){o=f,c=p,y()},g.links=function(f){return arguments.length?(e=f,y(),g):e},g.id=function(f){return arguments.length?(t=f,g):t},g.iterations=function(f){return arguments.length?(h=+f,g):h},g.strength=function(f){return arguments.length?(n=typeof f=="function"?f:fe(+f),w(),g):n},g.distance=function(f){return arguments.length?(s=typeof f=="function"?f:fe(+f),d(),g):s},g}const _a=1664525,Na=1013904223,Ft=4294967296;function ja(){let e=1;return()=>(e=(_a*e+Na)%Ft)/Ft}function ka(e){return e.x}function Ca(e){return e.y}var Sa=10,Aa=Math.PI*(3-Math.sqrt(5));function Ta(e){var t,n=1,r=.001,s=1-Math.pow(r,1/300),a=0,o=.6,l=new Map,u=ft(v),c=Te("tick","end"),h=ja();e==null&&(e=[]);function v(){g(),c.call("tick",t),n<r&&(u.stop(),c.call("end",t))}function g(d){var f,p=e.length,N;d===void 0&&(d=1);for(var S=0;S<d;++S)for(n+=(a-n)*s,l.forEach(function(x){x(n)}),f=0;f<p;++f)N=e[f],N.fx==null?N.x+=N.vx*=o:(N.x=N.fx,N.vx=0),N.fy==null?N.y+=N.vy*=o:(N.y=N.fy,N.vy=0);return t}function y(){for(var d=0,f=e.length,p;d<f;++d){if(p=e[d],p.index=d,p.fx!=null&&(p.x=p.fx),p.fy!=null&&(p.y=p.fy),isNaN(p.x)||isNaN(p.y)){var N=Sa*Math.sqrt(.5+d),S=d*Aa;p.x=N*Math.cos(S),p.y=N*Math.sin(S)}(isNaN(p.vx)||isNaN(p.vy))&&(p.vx=p.vy=0)}}function w(d){return d.initialize&&d.initialize(e,h),d}return y(),t={tick:g,restart:function(){return u.restart(v),t},stop:function(){return u.stop(),t},nodes:function(d){return arguments.length?(e=d,y(),l.forEach(w),t):e},alpha:function(d){return arguments.length?(n=+d,t):n},alphaMin:function(d){return arguments.length?(r=+d,t):r},alphaDecay:function(d){return arguments.length?(s=+d,t):+s},alphaTarget:function(d){return arguments.length?(a=+d,t):a},velocityDecay:function(d){return arguments.length?(o=1-d,t):1-o},randomSource:function(d){return arguments.length?(h=d,l.forEach(w),t):h},force:function(d,f){return arguments.length>1?(f==null?l.delete(d):l.set(d,w(f)),t):l.get(d)},find:function(d,f,p){var N=0,S=e.length,x,A,T,I,C;for(p==null?p=1/0:p*=p,N=0;N<S;++N)I=e[N],x=d-I.x,A=f-I.y,T=x*x+A*A,T<p&&(C=I,p=T);return C},on:function(d,f){return arguments.length>1?(c.on(d,f),t):c.on(d)}}}function Ea(){var e,t,n,r,s=fe(-30),a,o=1,l=1/0,u=.81;function c(y){var w,d=e.length,f=xt(e,ka,Ca).visitAfter(v);for(r=y,w=0;w<d;++w)t=e[w],f.visit(g)}function h(){if(e){var y,w=e.length,d;for(a=new Array(w),y=0;y<w;++y)d=e[y],a[d.index]=+s(d,y,e)}}function v(y){var w=0,d,f,p=0,N,S,x;if(y.length){for(N=S=x=0;x<4;++x)(d=y[x])&&(f=Math.abs(d.value))&&(w+=d.value,p+=f,N+=f*d.x,S+=f*d.y);y.x=N/p,y.y=S/p}else{d=y,d.x=d.data.x,d.y=d.data.y;do w+=a[d.data.index];while(d=d.next)}y.value=w}function g(y,w,d,f){if(!y.value)return!0;var p=y.x-t.x,N=y.y-t.y,S=f-w,x=p*p+N*N;if(S*S/u<x)return x<l&&(p===0&&(p=ue(n),x+=p*p),N===0&&(N=ue(n),x+=N*N),x<o&&(x=Math.sqrt(o*x)),t.vx+=p*y.value*r/x,t.vy+=N*y.value*r/x),!0;if(y.length||x>=l)return;(y.data!==t||y.next)&&(p===0&&(p=ue(n),x+=p*p),N===0&&(N=ue(n),x+=N*N),x<o&&(x=Math.sqrt(o*x)));do y.data!==t&&(S=a[y.data.index]*r/x,t.vx+=p*S,t.vy+=N*S);while(y=y.next)}return c.initialize=function(y,w){e=y,n=w,h()},c.strength=function(y){return arguments.length?(s=typeof y=="function"?y:fe(+y),h(),c):s},c.distanceMin=function(y){return arguments.length?(o=y*y,c):Math.sqrt(o)},c.distanceMax=function(y){return arguments.length?(l=y*y,c):Math.sqrt(l)},c.theta=function(y){return arguments.length?(u=y*y,c):Math.sqrt(u)},c}function Da(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}const Rt=Symbol("implicit");function pn(){var e=new yt,t=[],n=[],r=Rt;function s(a){let o=e.get(a);if(o===void 0){if(r!==Rt)return r;e.set(a,o=t.push(a)-1)}return n[o%n.length]}return s.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new yt;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(a){return arguments.length?(n=Array.from(a),s):n.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return pn(t,n).unknown(r)},Da.apply(s,arguments),s}const Pe=e=>()=>e;function Ma(e,{sourceEvent:t,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function oe(e,t,n){this.k=e,this.x=t,this.y=n}oe.prototype={constructor:oe,scale:function(e){return e===1?this:new oe(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new oe(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var yn=new oe(1,0,0);oe.prototype;function et(e){e.stopImmediatePropagation()}function we(e){e.preventDefault(),e.stopImmediatePropagation()}function $a(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ia(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Bt(){return this.__zoom||yn}function za(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Pa(){return navigator.maxTouchPoints||"ontouchstart"in this}function La(e,t,n){var r=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function Oa(){var e=$a,t=Ia,n=La,r=za,s=Pa,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,u=Ui,c=Te("start","zoom","end"),h,v,g,y=500,w=150,d=0,f=10;function p(b){b.property("__zoom",Bt).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",O).filter(s).on("touchstart.zoom",B).on("touchmove.zoom",V).on("touchend.zoom touchcancel.zoom",G).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(b,j,m,_){var k=b.selection?b.selection():b;k.property("__zoom",Bt),b!==k?A(b,j,m,_):k.interrupt().each(function(){T(this,arguments).event(_).start().zoom(null,typeof j=="function"?j.apply(this,arguments):j).end()})},p.scaleBy=function(b,j,m,_){p.scaleTo(b,function(){var k=this.__zoom.k,D=typeof j=="function"?j.apply(this,arguments):j;return k*D},m,_)},p.scaleTo=function(b,j,m,_){p.transform(b,function(){var k=t.apply(this,arguments),D=this.__zoom,E=m==null?x(k):typeof m=="function"?m.apply(this,arguments):m,$=D.invert(E),P=typeof j=="function"?j.apply(this,arguments):j;return n(S(N(D,P),E,$),k,o)},m,_)},p.translateBy=function(b,j,m,_){p.transform(b,function(){return n(this.__zoom.translate(typeof j=="function"?j.apply(this,arguments):j,typeof m=="function"?m.apply(this,arguments):m),t.apply(this,arguments),o)},null,_)},p.translateTo=function(b,j,m,_,k){p.transform(b,function(){var D=t.apply(this,arguments),E=this.__zoom,$=_==null?x(D):typeof _=="function"?_.apply(this,arguments):_;return n(yn.translate($[0],$[1]).scale(E.k).translate(typeof j=="function"?-j.apply(this,arguments):-j,typeof m=="function"?-m.apply(this,arguments):-m),D,o)},_,k)};function N(b,j){return j=Math.max(a[0],Math.min(a[1],j)),j===b.k?b:new oe(j,b.x,b.y)}function S(b,j,m){var _=j[0]-m[0]*b.k,k=j[1]-m[1]*b.k;return _===b.x&&k===b.y?b:new oe(b.k,_,k)}function x(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function A(b,j,m,_){b.on("start.zoom",function(){T(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(_).end()}).tween("zoom",function(){var k=this,D=arguments,E=T(k,D).event(_),$=t.apply(k,D),P=m==null?x($):typeof m=="function"?m.apply(k,D):m,F=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),L=k.__zoom,U=typeof j=="function"?j.apply(k,D):j,X=u(L.invert(P).concat(F/L.k),U.invert(P).concat(F/U.k));return function(K){if(K===1)K=U;else{var Z=X(K),M=F/Z[2];K=new oe(M,P[0]-Z[0]*M,P[1]-Z[1]*M)}E.zoom(null,K)}})}function T(b,j,m){return!m&&b.__zooming||new I(b,j)}function I(b,j){this.that=b,this.args=j,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,j),this.taps=0}I.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,j){return this.mouse&&b!=="mouse"&&(this.mouse[1]=j.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=j.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=j.invert(this.touch1[0])),this.that.__zoom=j,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var j=ne(this.that).datum();c.call(b,this.that,new Ma(b,{sourceEvent:this.sourceEvent,target:p,transform:this.that.__zoom,dispatch:c}),j)}};function C(b,...j){if(!e.apply(this,arguments))return;var m=T(this,j).event(b),_=this.__zoom,k=Math.max(a[0],Math.min(a[1],_.k*Math.pow(2,r.apply(this,arguments)))),D=ae(b);if(m.wheel)(m.mouse[0][0]!==D[0]||m.mouse[0][1]!==D[1])&&(m.mouse[1]=_.invert(m.mouse[0]=D)),clearTimeout(m.wheel);else{if(_.k===k)return;m.mouse=[D,_.invert(D)],Re(this),m.start()}we(b),m.wheel=setTimeout(E,w),m.zoom("mouse",n(S(N(_,k),m.mouse[0],m.mouse[1]),m.extent,o));function E(){m.wheel=null,m.end()}}function R(b,...j){if(g||!e.apply(this,arguments))return;var m=b.currentTarget,_=T(this,j,!0).event(b),k=ne(b.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",F,!0),D=ae(b,m),E=b.clientX,$=b.clientY;tn(b.view),et(b),_.mouse=[D,this.__zoom.invert(D)],Re(this),_.start();function P(L){if(we(L),!_.moved){var U=L.clientX-E,X=L.clientY-$;_.moved=U*U+X*X>d}_.event(L).zoom("mouse",n(S(_.that.__zoom,_.mouse[0]=ae(L,m),_.mouse[1]),_.extent,o))}function F(L){k.on("mousemove.zoom mouseup.zoom",null),nn(L.view,_.moved),we(L),_.event(L).end()}}function O(b,...j){if(e.apply(this,arguments)){var m=this.__zoom,_=ae(b.changedTouches?b.changedTouches[0]:b,this),k=m.invert(_),D=m.k*(b.shiftKey?.5:2),E=n(S(N(m,D),_,k),t.apply(this,j),o);we(b),l>0?ne(this).transition().duration(l).call(A,E,_,b):ne(this).call(p.transform,E,_,b)}}function B(b,...j){if(e.apply(this,arguments)){var m=b.touches,_=m.length,k=T(this,j,b.changedTouches.length===_).event(b),D,E,$,P;for(et(b),E=0;E<_;++E)$=m[E],P=ae($,this),P=[P,this.__zoom.invert(P),$.identifier],k.touch0?!k.touch1&&k.touch0[2]!==P[2]&&(k.touch1=P,k.taps=0):(k.touch0=P,D=!0,k.taps=1+!!h);h&&(h=clearTimeout(h)),D&&(k.taps<2&&(v=P[0],h=setTimeout(function(){h=null},y)),Re(this),k.start())}}function V(b,...j){if(this.__zooming){var m=T(this,j).event(b),_=b.changedTouches,k=_.length,D,E,$,P;for(we(b),D=0;D<k;++D)E=_[D],$=ae(E,this),m.touch0&&m.touch0[2]===E.identifier?m.touch0[0]=$:m.touch1&&m.touch1[2]===E.identifier&&(m.touch1[0]=$);if(E=m.that.__zoom,m.touch1){var F=m.touch0[0],L=m.touch0[1],U=m.touch1[0],X=m.touch1[1],K=(K=U[0]-F[0])*K+(K=U[1]-F[1])*K,Z=(Z=X[0]-L[0])*Z+(Z=X[1]-L[1])*Z;E=N(E,Math.sqrt(K/Z)),$=[(F[0]+U[0])/2,(F[1]+U[1])/2],P=[(L[0]+X[0])/2,(L[1]+X[1])/2]}else if(m.touch0)$=m.touch0[0],P=m.touch0[1];else return;m.zoom("touch",n(S(E,$,P),m.extent,o))}}function G(b,...j){if(this.__zooming){var m=T(this,j).event(b),_=b.changedTouches,k=_.length,D,E;for(et(b),g&&clearTimeout(g),g=setTimeout(function(){g=null},y),D=0;D<k;++D)E=_[D],m.touch0&&m.touch0[2]===E.identifier?delete m.touch0:m.touch1&&m.touch1[2]===E.identifier&&delete m.touch1;if(m.touch1&&!m.touch0&&(m.touch0=m.touch1,delete m.touch1),m.touch0)m.touch0[1]=this.__zoom.invert(m.touch0[0]);else if(m.end(),m.taps===2&&(E=ae(E,this),Math.hypot(v[0]-E[0],v[1]-E[1])<f)){var $=ne(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return p.wheelDelta=function(b){return arguments.length?(r=typeof b=="function"?b:Pe(+b),p):r},p.filter=function(b){return arguments.length?(e=typeof b=="function"?b:Pe(!!b),p):e},p.touchable=function(b){return arguments.length?(s=typeof b=="function"?b:Pe(!!b),p):s},p.extent=function(b){return arguments.length?(t=typeof b=="function"?b:Pe([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),p):t},p.scaleExtent=function(b){return arguments.length?(a[0]=+b[0],a[1]=+b[1],p):[a[0],a[1]]},p.translateExtent=function(b){return arguments.length?(o[0][0]=+b[0][0],o[1][0]=+b[1][0],o[0][1]=+b[0][1],o[1][1]=+b[1][1],p):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},p.constrain=function(b){return arguments.length?(n=b,p):n},p.duration=function(b){return arguments.length?(l=+b,p):l},p.interpolate=function(b){return arguments.length?(u=b,p):u},p.on=function(){var b=c.on.apply(c,arguments);return b===c?p:b},p.clickDistance=function(b){return arguments.length?(d=(b=+b)*b,p):Math.sqrt(d)},p.tapDistance=function(b){return arguments.length?(f=+b,p):f},p}class ge{constructor(){this.ollamaUrl="http://localhost:11434",this.model="mistral",this.cache=new Map}static getInstance(){return ge.instance||(ge.instance=new ge),ge.instance}async checkOllamaConnection(){try{const t=new AbortController,n=setTimeout(()=>t.abort(),5e3),r=await fetch(`${this.ollamaUrl}/api/tags`,{method:"GET",headers:{"Content-Type":"application/json"},signal:t.signal,mode:"cors"});if(clearTimeout(n),r.ok){const a=(await r.json()).models||[],o=a.some(l=>l.name&&(l.name.toLowerCase().includes("mistral")||l.name.toLowerCase().includes("llama")||l.name.toLowerCase().includes("phi3")));return console.log("Ollama models available:",a.map(l=>l.name)),o}return!1}catch(t){return t instanceof Error?t.name==="AbortError"?console.log("Ollama connection timeout after 5 seconds"):t.message.includes("CORS")?console.log('CORS error - make sure Ollama is running with OLLAMA_ORIGINS="*"'):t.message.includes("NetworkError")||t.message.includes("Failed to fetch")?console.log("Network error - Ollama not running on localhost:11434"):console.log("Ollama connection failed:",t.message):console.log("Ollama connection failed:",t),!1}}async generateEmbedding(t){const n=this.hashString(t).toString();if(this.cache.has(n))return this.cache.get(n);try{const r=await fetch(`${this.ollamaUrl}/api/embeddings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,prompt:t})});if(!r.ok)throw new Error(`Ollama API error: ${r.status}`);const s=await r.json();return this.cache.set(n,s.embedding),s.embedding}catch(r){return console.warn("Failed to generate embedding via Ollama:",r),this.generateFallbackEmbedding(t)}}async generateDocumentEmbedding(t){const n=`${t.title} ${t.summary} ${t.keywords.join(" ")} ${t.category}`;return this.generateEmbedding(n)}async detectTopic(t){try{const n=`Analyze this document and classify it into ONE of these categories: Machine Learning, Deep Learning, Data Science, AI Ethics, Business Intelligence, Natural Language Processing, Computer Vision, Reinforcement Learning, Statistics, Programming, Business Strategy, or Other.

Document: ${t.title}
Summary: ${t.summary}
Keywords: ${t.keywords.join(", ")}

Respond with only the category name:`,r=await fetch(`${this.ollamaUrl}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,prompt:n,stream:!1})});if(r.ok){const a=(await r.json()).response.trim();return this.validateTopic(a)}}catch(n){console.warn("Failed to detect topic via Ollama:",n)}return this.detectTopicFallback(t)}validateTopic(t){const n=["Machine Learning","Deep Learning","Data Science","AI Ethics","Business Intelligence","Natural Language Processing","Computer Vision","Reinforcement Learning","Statistics","Programming","Business Strategy"],r=t.trim();return n.find(a=>a.toLowerCase()===r.toLowerCase()||r.toLowerCase().includes(a.toLowerCase()))||"Other"}detectTopicFallback(t){const n=`${t.title} ${t.summary} ${t.keywords.join(" ")}`.toLowerCase(),r={"Machine Learning":["machine learning","ml","algorithm","model","training","supervised","unsupervised"],"Deep Learning":["deep learning","neural network","cnn","rnn","transformer","pytorch","tensorflow"],"Data Science":["data science","analytics","visualization","pandas","numpy","statistics"],"AI Ethics":["ethics","bias","fairness","responsible ai","governance","regulation"],"Business Intelligence":["business","strategy","management","leadership","productivity"],"Natural Language Processing":["nlp","text","language","chatbot","sentiment","tokenization"],"Computer Vision":["computer vision","image","opencv","detection","recognition"],Programming:["python","code","programming","development","software"],Statistics:["statistics","probability","regression","hypothesis","distribution"]};let s="Other",a=0;for(const[o,l]of Object.entries(r)){const u=l.reduce((c,h)=>c+(n.includes(h)?1:0),0);u>a&&(a=u,s=o)}return s}generateFallbackEmbedding(t){const n=t.toLowerCase().split(/\s+/),r=new Array(384).fill(0);n.forEach((a,o)=>{const l=this.hashString(a);for(let u=0;u<r.length;u++)r[u]+=Math.sin(l+u+o)*.1});const s=Math.sqrt(r.reduce((a,o)=>a+o*o,0));return r.map(a=>a/(s||1))}hashString(t){let n=0;for(let r=0;r<t.length;r++){const s=t.charCodeAt(r);n=(n<<5)-n+s,n=n&n}return Math.abs(n)}calculateSimilarity(t,n){if(t.length!==n.length)return 0;let r=0,s=0,a=0;for(let l=0;l<t.length;l++)r+=t[l]*n[l],s+=t[l]*t[l],a+=n[l]*n[l];const o=Math.sqrt(s)*Math.sqrt(a);return o===0?0:r/o}async processDocuments(t){const n={};for(const r of t)try{const[s,a]=await Promise.all([this.generateDocumentEmbedding(r),this.detectTopic(r)]);n[r.id]={embedding:s,topic:a,topicConfidence:.8}}catch(s){console.warn(`Failed to process document ${r.id}:`,s),n[r.id]={embedding:this.generateFallbackEmbedding(r.summary),topic:this.detectTopicFallback(r),topicConfidence:.5}}return n}generateTopicClusters(t){const n={};Object.entries(t).forEach(([s,a])=>{n[a.topic]||(n[a.topic]=[]),n[a.topic].push(s)});const r=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE","#85C1E9","#F8C471","#82E0AA","#F1948A","#85C1E9","#D7BDE2"];return Object.entries(n).map(([s,a],o)=>{const l=a.map(c=>t[c].embedding),u=this.calculateCentroid(l);return{topic:s,color:r[o%r.length],documents:a,centroid:u}})}calculateCentroid(t){if(t.length===0)return[];const n=t[0].length,r=new Array(n).fill(0);return t.forEach(s=>{s.forEach((a,o)=>{r[o]+=a})}),r.map(s=>s/t.length)}async saveEmbeddings(t){try{localStorage.setItem("document-embeddings",JSON.stringify(t)),console.log("Embeddings saved to cache successfully")}catch(n){console.warn("Failed to save embeddings to cache:",n)}}loadCachedEmbeddings(){try{const t=localStorage.getItem("document-embeddings");return t?JSON.parse(t):null}catch{return null}}}const Fa=({documents:e,width:t=800,height:n=600,onNodeClick:r,onNodeHover:s})=>{const a=z.useRef(null),[o,l]=z.useState(!1),[u,c]=z.useState(null),[h,v]=z.useState([]),[g,y]=z.useState(null),[w,d]=z.useState(null),[f,p]=z.useState([]),[N,S]=z.useState(null),[x,A]=z.useState(!1),[T,I]=z.useState([]),C=ge.getInstance();z.useEffect(()=>{(async()=>{const _=await C.checkOllamaConnection();A(_)})()},[C]),z.useEffect(()=>{let m=e;e.length>100&&(w&&(m=m.filter(_=>_.category===w)),f.length>0&&(m=m.filter(_=>f.some(k=>_.keywords.some(D=>D.toLowerCase().includes(k.toLowerCase()))))),m.length>50&&(m=m.sort((_,k)=>k.file_size-_.file_size).slice(0,50))),I(m)},[e,w,f]);const R=[...new Set(e.map(m=>m.category))],B=e.flatMap(m=>m.keywords).reduce((m,_)=>(m[_]=(m[_]||0)+1,m),{}),V=Object.entries(B).sort(([,m],[,_])=>_-m).map(([m])=>m);z.useEffect(()=>{(async()=>{if(e.length===0)return;l(!0);const _=C.loadCachedEmbeddings();if(_&&Object.keys(_).length>0){c(_);const k=C.generateTopicClusters(_);v(k),l(!1);return}try{const k=await C.processDocuments(e);c(k);const D=C.generateTopicClusters(k);v(D),await C.saveEmbeddings(k)}catch(k){console.error("Failed to generate embeddings:",k)}finally{l(!1)}})()},[e]);const G=z.useCallback(()=>{if(!u)return{nodes:[],links:[]};const _=(T.length>0?T:e).map(E=>{const $=u[E.id];return{...E,embedding:$?.embedding,topic:$?.topic||"Other"}}),k=[],D=.3;for(let E=0;E<_.length;E++)for(let $=E+1;$<_.length;$++){const P=_[E],F=_[$];if(P.embedding&&F.embedding){const L=C.calculateSimilarity(P.embedding,F.embedding);L>D&&k.push({source:P.id,target:F.id,similarity:L,weight:L})}}return{nodes:_,links:k}},[e,u,h,T,C]);z.useEffect(()=>{if(!a.current||!u)return;const m=ne(a.current);m.selectAll("*").remove();const _=G();if(_.nodes.length===0)return;const k={top:20,right:20,bottom:20,left:20},D=t-k.left-k.right,E=n-k.top-k.bottom,$=m.attr("width",t).attr("height",n).append("g").attr("transform",`translate(${k.left},${k.top})`),P=Oa().scaleExtent([.1,4]).on("zoom",M=>{$.attr("transform",M.transform)});m.call(P);const F=Ta(_.nodes).force("link",wa(_.links).id(M=>M.id).distance(M=>80/(M.weight+.1)).strength(M=>M.weight*.5)).force("charge",Ea().strength(-200)).force("center",ea(D/2,E/2)).force("collision",ba().radius(20)).alphaDecay(.05).velocityDecay(.8),L=pn().domain(h.map(M=>M.topic)).range(h.map(M=>M.color)),U=$.append("g").attr("class","links").selectAll("line").data(_.links).enter().append("line").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",M=>Math.sqrt(M.weight*5)),X=$.append("g").attr("class","nodes").selectAll("circle").data(_.nodes).enter().append("circle").attr("r",M=>Math.sqrt(M.file_size/1e5)+8).attr("fill",M=>L(M.topic||"Other")).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer").style("opacity",M=>g?M.topic===g?1:.3:1),K=$.append("g").attr("class","labels").selectAll("text").data(_.nodes).enter().append("text").text(M=>M.title.length>20?M.title.substring(0,20)+"...":M.title).attr("font-size","10px").attr("font-family","Arial, sans-serif").attr("text-anchor","middle").attr("dy","0.35em").attr("pointer-events","none").style("opacity",M=>g?M.topic===g?1:.3:.8),Z=xi().on("start",(M,H)=>{M.active||F.alphaTarget(.3).restart(),H.fx=H.x,H.fy=H.y}).on("drag",(M,H)=>{H.fx=M.x,H.fy=M.y}).on("end",(M,H)=>{M.active||F.alphaTarget(0),H.fx=null,H.fy=null});return X.call(Z),X.on("mouseover",(M,H)=>{S(H),s?.(H);const We=new Set;_.links.forEach(q=>{(q.source===H.id||typeof q.source=="object"&&q.source.id===H.id)&&We.add(typeof q.target=="string"?q.target:q.target.id),(q.target===H.id||typeof q.target=="object"&&q.target.id===H.id)&&We.add(typeof q.source=="string"?q.source:q.source.id)}),X.style("opacity",q=>q.id===H.id||We.has(q.id)?1:.3),U.style("opacity",q=>{const bn=typeof q.source=="string"?q.source:q.source.id,vn=typeof q.target=="string"?q.target:q.target.id;return bn===H.id||vn===H.id?1:.1})}).on("mouseout",()=>{S(null),s?.(null),X.style("opacity",M=>g?M.topic===g?1:.3:1),U.style("opacity",.6)}).on("click",(M,H)=>{M.stopPropagation(),r?.(H)}),F.on("tick",()=>{U.attr("x1",M=>M.source.x).attr("y1",M=>M.source.y).attr("x2",M=>M.target.x).attr("y2",M=>M.target.y),X.attr("cx",M=>M.x).attr("cy",M=>M.y),K.attr("x",M=>M.x).attr("y",M=>M.y+30)}),()=>{F.stop()}},[u,G,t,n,g,r,s,h]);const b=m=>{y(g===m?null:m)},j=async()=>{l(!0);try{localStorage.removeItem("document-embeddings");const m=await C.processDocuments(e);c(m);const _=C.generateTopicClusters(m);v(_),await C.saveEmbeddings(m)}catch(m){console.error("Failed to regenerate embeddings:",m)}finally{l(!1)}};return i.jsxs("div",{className:"knowledge-graph-container w-full",children:[e.length>100&&i.jsx("div",{className:"mb-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center gap-2 text-orange-800",children:[i.jsx("span",{className:"text-sm font-medium",children:"⚡ Performance Mode:"}),i.jsxs("span",{className:"text-sm",children:["Large dataset detected (",e.length," documents).",T.length>0?` Showing ${T.length} filtered documents for optimal performance.`:" Use filters below to improve performance."]})]})}),e.length>100&&i.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg border",children:[i.jsx("div",{className:"text-sm font-medium mb-3",children:"📊 Performance Filters (Required for large datasets):"}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:"Filter by Category:"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>d(null),className:`px-3 py-1 text-xs rounded border ${w===null?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"All Categories"}),R.map(m=>i.jsx("button",{onClick:()=>d(m),className:`px-3 py-1 text-xs rounded border ${w===m?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:m},m))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block",children:"Filter by Tags:"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>p([]),className:`px-3 py-1 text-xs rounded border ${f.length===0?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Clear Tags"}),V.map(m=>i.jsxs("button",{onClick:()=>{f.includes(m)?p(f.filter(_=>_!==m)):p([...f,m])},className:`px-3 py-1 text-xs rounded border ${f.includes(m)?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[m," (",B[m],")"]},m))]})]})]}),!u&&!o&&i.jsx("div",{className:"mb-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"🚀 Generate Knowledge Graph Connections"}),i.jsx("p",{className:"text-gray-700 mb-4 max-w-2xl mx-auto",children:"Click the button below to analyze your documents with AI and create intelligent connections. This will generate embeddings that power the knowledge graph visualization."})]}),i.jsxs("button",{onClick:j,disabled:o,className:"inline-flex items-center gap-2 px-8 py-4 text-lg font-semibold bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),o?"Generating Connections...":"Generate Embeddings & Connections"]}),i.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:["⚡ This process analyzes ",e.length," documents and may take a few moments"]})]})}),u&&i.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium",children:"AI Status:"}),i.jsx("span",{className:`text-sm px-2 py-1 rounded ${x?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:x?"✅ Ollama Connected":"⚠️ Offline Mode"}),i.jsx("span",{className:"text-xs text-gray-500",children:x?"Using Mistral AI for high-quality embeddings":"Using keyword-based fallback embeddings"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:j,disabled:o,className:"inline-flex items-center gap-1 px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),o?"Regenerating...":"Regenerate Connections"]}),i.jsx("span",{className:"text-xs text-gray-500",children:"Click to refresh embeddings and update connections"})]})]}),h.length>0&&i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"text-sm font-medium mb-2",children:"Filter by Topic:"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>b(null),className:`px-3 py-1 text-sm rounded border ${g===null?"bg-gray-800 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"All Topics"}),h.map(m=>i.jsxs("button",{onClick:()=>b(m.topic),className:`px-3 py-1 text-sm rounded border ${g===m.topic?"text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,style:{backgroundColor:g===m.topic?m.color:void 0,borderColor:m.color},children:[m.topic," (",m.documents.length,")"]},m.topic))]})]}),o&&i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),i.jsx("div",{className:"text-sm text-gray-600",children:x?"Generating AI embeddings...":"Processing documents..."})]})}),!o&&u&&i.jsxs("div",{className:"relative",children:[i.jsx("svg",{ref:a,className:"border rounded-lg bg-white"}),N&&i.jsxs("div",{className:"absolute top-4 left-4 bg-white p-3 rounded-lg shadow-lg border max-w-xs z-10",children:[i.jsx("h4",{className:"font-semibold text-sm mb-1",children:N.title}),i.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[N.summary.substring(0,100),"..."]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[i.jsx("span",{className:"px-2 py-1 rounded",style:{backgroundColor:h.find(m=>m.topic===N.topic)?.color+"20",color:h.find(m=>m.topic===N.topic)?.color},children:N.topic}),i.jsxs("span",{className:"text-gray-500",children:[(N.file_size/1024/1024).toFixed(1)," MB"]})]})]})]}),h.length>0&&!o&&i.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[i.jsx("div",{className:"text-sm font-medium mb-2",children:"Topic Legend:"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 text-xs",children:h.map(m=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:m.color}}),i.jsx("span",{children:m.topic})]},m.topic))})]})]})};class Ra extends z.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("ErrorBoundary caught an error:",t,n)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:i.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 text-red-800 mb-2",children:[i.jsx("span",{className:"text-lg",children:"⚠️"}),i.jsx("h3",{className:"font-semibold",children:"Something went wrong"})]}),i.jsx("p",{className:"text-red-700 text-sm mb-3",children:this.state.error?.message||"An unexpected error occurred"}),i.jsx("button",{onClick:()=>this.setState({hasError:!1,error:void 0}),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Try Again"})]}):this.props.children}}const Ga=({initialView:e="library"})=>{const[t,n]=z.useState([]),[r,s]=z.useState([]),[a,o]=z.useState(e),[l,u]=z.useState(null),[c,h]=z.useState(!0),[v,g]=z.useState(!1),[y,w]=z.useState(null),d=r.length>0?r.length<=50:t.length<=50;z.useEffect(()=>{(async()=>{try{const O=["/tech_documents/data/documents.json","/data/documents.json","./data/documents.json"];let B=null;for(const V of O)try{const G=await fetch(V);if(G.ok){B=await G.json();break}}catch(G){console.warn(`Failed to load from ${V}:`,G)}B?n(B):(console.error("Could not load documents from any path"),n([]))}catch(C){console.error("Error loading documents:",C),n([])}finally{h(!1)}})()},[]),z.useEffect(()=>{typeof window<"u"&&"serviceWorker"in navigator&&navigator.serviceWorker.register("/tech_documents/sw.js").then(C=>{console.log("Service Worker registered:",C)}).catch(C=>{console.warn("Service Worker registration failed:",C)})},[]);const f=I=>I.map(C=>({...C,title:C.title||C.filename,authors:C.authors||[],content_preview:C.content_preview||C.summary.substring(0,200)+"..."})),p=I=>{u(I);const C=t.find(R=>R.id===I.id);C&&(w(C),g(!0))},N=()=>{g(!1),w(null)},S=I=>{},x=()=>{o("graph")},A=I=>{const C=`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${I}`;return`https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(C)}`},T=I=>`https://github.com/lonardonifabio/tech_documents/blob/main/${I}`;return c?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("div",{className:"text-lg text-gray-600",children:"Loading document library..."})]})}):i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("header",{className:"bg-white shadow-sm border-b",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center py-4 gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"AI & Data Science Document Library"}),i.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:[t.length," documents • Interactive knowledge graph powered by AI"]})]}),i.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 rounded-lg p-1 w-full sm:w-auto",children:[i.jsxs("button",{onClick:()=>o("library"),className:`flex-1 sm:flex-none px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors ${a==="library"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[i.jsx("span",{className:"hidden sm:inline",children:"📚 Library View"}),i.jsx("span",{className:"sm:hidden",children:"📚 Library"})]}),i.jsxs("button",{onClick:()=>o("graph"),disabled:!d,className:`flex-1 sm:flex-none px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors ${a==="graph"?"bg-white text-gray-900 shadow-sm":d?"text-gray-600 hover:text-gray-900":"text-gray-400 cursor-not-allowed"}`,title:d?"Open Knowledge Graph":`Knowledge Graph unavailable (${r.length>0?r.length:t.length} results > 50 limit)`,children:[i.jsxs("span",{className:"hidden sm:inline",children:["🕸️ Knowledge Graph",!d&&i.jsxs("span",{className:"ml-1 text-xs",children:["(",r.length>0?r.length:t.length,"/50)"]})]}),i.jsxs("span",{className:"sm:hidden",children:["🕸️ Graph",!d&&i.jsxs("span",{className:"ml-1 text-xs",children:["(",r.length>0?r.length:t.length,"/50)"]})]})]})]})]})})}),i.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a==="library"?i.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:i.jsx(kn,{onKnowledgeGraphClick:x,onFilteredDocumentsChange:s})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("button",{onClick:()=>o("library"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:text-blue-800 transition-colors",children:"← Back to Library"}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Showing knowledge graph for ",r.length>0?r.length:t.length," documents",r.length>0&&r.length!==t.length&&i.jsxs("span",{className:"text-gray-400",children:[" (filtered from ",t.length," total)"]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Interactive Knowledge Graph"}),i.jsxs("p",{className:"text-gray-600 text-sm mb-4",children:["Explore document relationships based on AI-generated embeddings. Documents are clustered by topic and connected by semantic similarity.",i.jsxs("span",{className:"block mt-2 text-blue-600 font-medium",children:["📊 Input: ",t.length," documents from search results"]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsx("span",{children:"Node size = File size"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),i.jsx("span",{children:"Colors = AI-detected topics"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-8 h-0.5 bg-gray-400"}),i.jsx("span",{children:"Links = Semantic similarity"})]})]})]}),l&&i.jsxs("div",{className:"ml-6 p-4 bg-gray-50 rounded-lg max-w-sm",children:[i.jsx("h3",{className:"font-medium text-sm mb-2",children:"Selected Document:"}),i.jsx("p",{className:"text-sm font-semibold mb-1",children:l.title}),i.jsxs("p",{className:"text-xs text-gray-600 mb-3",children:[l.summary.substring(0,100),"..."]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("a",{href:A(l.filepath),target:"_blank",rel:"noopener noreferrer",className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",children:"View PDF"}),i.jsx("a",{href:T(l.filepath),target:"_blank",rel:"noopener noreferrer",className:"text-xs border border-gray-300 text-gray-700 px-2 py-1 rounded hover:bg-gray-50",children:"GitHub"})]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-6",children:i.jsx(Ra,{fallback:i.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 text-red-800 mb-3",children:[i.jsx("span",{className:"text-lg",children:"⚠️"}),i.jsx("h3",{className:"font-semibold",children:"Knowledge Graph Error"})]}),i.jsx("p",{className:"text-red-700 text-sm mb-4",children:"The knowledge graph failed to load. This might be due to:"}),i.jsxs("ul",{className:"text-red-700 text-sm mb-4 list-disc list-inside",children:[i.jsx("li",{children:"Ollama not running locally (required for AI embeddings)"}),i.jsx("li",{children:"CORS configuration issues"}),i.jsx("li",{children:"Large dataset processing errors"}),i.jsx("li",{children:"Browser compatibility issues"})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>typeof window<"u"?window.location.reload():void 0,className:"px-4 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Reload Page"}),i.jsx("button",{onClick:()=>o("library"),className:"px-4 py-2 border border-red-300 text-red-700 text-sm rounded hover:bg-red-50 transition-colors",children:"Back to Library"})]})]}),children:i.jsx(Fa,{documents:f(r.length>0?r:t),width:typeof window<"u"?Math.min(window.innerWidth-100,1e3):1e3,height:typeof window<"u"?Math.min(window.innerHeight-300,700):700,onNodeClick:p,onNodeHover:S})})}),i.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"How to Use the Knowledge Graph"}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-800",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"🖱️ Interactions:"}),i.jsxs("ul",{className:"space-y-1 text-blue-700",children:[i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Click"})," nodes to open document preview popup"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Hover"})," to see document previews"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Drag"})," nodes to reposition them"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Scroll"})," to zoom in/out"]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"🎯 Features:"}),i.jsxs("ul",{className:"space-y-1 text-blue-700",children:[i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Category filtering"})," to focus on specific areas"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Tag filtering"})," based on available keywords"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Topic filtering"})," by AI-detected themes"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Semantic connections"})," show related documents"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"Offline support"})," via service worker caching"]}),i.jsxs("li",{children:["• ",i.jsx("strong",{children:"AI-powered"})," topic detection and clustering"]})]})]})]})]})]})}),i.jsx("footer",{className:"bg-white border-t mt-12",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:i.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center text-sm text-gray-600",children:[i.jsx("div",{children:i.jsxs("p",{children:["Powered by"," ",i.jsx("a",{href:"https://d3js.org/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"D3.js"})," ","and"," ",i.jsx("a",{href:"https://ollama.ai/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Ollama"})," ","• Built with"," ",i.jsx("a",{href:"https://astro.build/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Astro"})," ","and"," ",i.jsx("a",{href:"https://reactjs.org/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"React"})]})}),i.jsx("div",{className:"mt-2 md:mt-0",children:i.jsx("p",{children:"Interactive Knowledge Graph • Bundle size optimized • Works offline"})})]})})}),y&&i.jsx(Ut,{doc:y,isOpen:v,onClose:N})]})};export{Ga as default};
