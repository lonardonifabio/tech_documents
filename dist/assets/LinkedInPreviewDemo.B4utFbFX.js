import{j as o}from"./jsx-runtime.TBa3i5EZ.js";import{r as b}from"./index.CVf8TyFT.js";class u{constructor(){this.cache=new Map}static getInstance(){return u.instance||(u.instance=new u),u.instance}async generateDocumentPreview(e,i={}){const{width:t=1200,height:s=630,quality:r=.9}=i,n=`${e.id}_${t}_${s}`;if(this.cache.has(n))return this.cache.get(n);const l=document.createElement("canvas"),a=l.getContext("2d");if(!a)throw new Error("Could not get canvas context");l.width=t,l.height=s;const c={AI:{gradient:["#667eea","#764ba2"],icon:"🤖",accent:"#667eea"},"Machine Learning":{gradient:["#f093fb","#f5576c"],icon:"🧠",accent:"#f093fb"},"Data Science":{gradient:["#4facfe","#00f2fe"],icon:"📊",accent:"#4facfe"},Business:{gradient:["#43e97b","#38f9d7"],icon:"💼",accent:"#43e97b"},Technology:{gradient:["#fa709a","#fee140"],icon:"⚙️",accent:"#fa709a"},Research:{gradient:["#a8edea","#fed6e3"],icon:"🔬",accent:"#a8edea"}},h=c[e.category]||c.Technology,d=a.createLinearGradient(0,0,t,s);d.addColorStop(0,h.gradient[0]),d.addColorStop(1,h.gradient[1]),a.fillStyle=d,a.fillRect(0,0,t,s),a.fillStyle="rgba(0, 0, 0, 0.2)",a.fillRect(0,0,t,s),this.addDecorativeElements(a,t,s,h.accent),a.fillStyle="#ffffff",a.textAlign="center",a.textBaseline="middle",a.font="100px Arial",a.fillText(h.icon,t/2,s/2-120);const m=e.title||e.filename;if(this.drawWrappedText(a,m,t/2,s/2-40,900,"bold 42px Arial",50),this.drawBadge(a,e.category,t/2-100,s/2+40,h.accent),this.drawBadge(a,e.difficulty,t/2+100,s/2+40,"#ff6b6b"),e.keywords&&e.keywords.length>0){const w=e.keywords.slice(0,3).join(" • ");a.font="18px Arial",a.fillStyle="rgba(255, 255, 255, 0.9)",this.drawWrappedText(a,w,t/2,s/2+100,800,"18px Arial",25)}a.font="bold 16px Arial",a.fillStyle="rgba(255, 255, 255, 0.8)",a.textAlign="right",a.fillText("AI & Data Science Document Library",t-40,s-30);const p=l.toDataURL("image/jpeg",r);return this.cache.set(n,p),p}addDecorativeElements(e,i,t,s){e.save(),e.globalAlpha=.1,e.fillStyle="#ffffff",e.beginPath(),e.arc(100,100,80,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(i-100,t-100,60,0,Math.PI*2),e.fill(),e.globalAlpha=.05,e.fillStyle=s;for(let r=0;r<3;r++){const n=i*.8+r*40,l=t*.3+r*30;this.drawHexagon(e,n,l,20)}e.restore()}drawHexagon(e,i,t,s){e.beginPath();for(let r=0;r<6;r++){const n=r*Math.PI/3,l=i+s*Math.cos(n),a=t+s*Math.sin(n);r===0?e.moveTo(l,a):e.lineTo(l,a)}e.closePath(),e.fill()}drawWrappedText(e,i,t,s,r,n,l){e.font=n;const a=i.split(" ");let c="",h=s;for(let d=0;d<a.length;d++){const m=c+a[d]+" ";e.measureText(m).width>r&&d>0?(e.fillText(c,t,h),c=a[d]+" ",h+=l):c=m}e.fillText(c,t,h)}drawBadge(e,i,t,s,r){e.save(),e.font="bold 16px Arial";const a=e.measureText(i).width+20*2,c=32;e.fillStyle=r,e.globalAlpha=.9,this.drawRoundedRect(e,t-a/2,s-c/2,a,c,16),e.fill(),e.globalAlpha=1,e.fillStyle="#ffffff",e.textAlign="center",e.textBaseline="middle",e.fillText(i,t,s),e.restore()}drawRoundedRect(e,i,t,s,r,n){e.beginPath(),e.moveTo(i+n,t),e.lineTo(i+s-n,t),e.quadraticCurveTo(i+s,t,i+s,t+n),e.lineTo(i+s,t+r-n),e.quadraticCurveTo(i+s,t+r,i+s-n,t+r),e.lineTo(i+n,t+r),e.quadraticCurveTo(i,t+r,i,t+r-n),e.lineTo(i,t+n),e.quadraticCurveTo(i,t,i+n,t),e.closePath()}clearCache(){this.cache.clear()}}class f{constructor(){this.previewGenerator=u.getInstance()}static getInstance(){return f.instance||(f.instance=new f),f.instance}async shareOnLinkedIn(e,i={}){const{useCustomPreview:t=!0,downloadDocument:s=!1,shareAsAttachment:r=!1}=i;try{let n=null;t&&(n=await this.previewGenerator.generateDocumentPreview(e));const l=await this.prepareShareContent(e,n,s);r&&s?await this.shareWithDocumentAttachment(e,l):await this.shareWithPreview(e,l,n)}catch(n){console.error("Error sharing on LinkedIn:",n),await this.fallbackShare(e)}}async prepareShareContent(e,i,t){const s=e.title||e.filename,r=`https://lonardonifabio.github.io/tech_documents/document/${e.id}`;let n=`🚀 Sharing an insightful AI/Data Science resource!

`;if(n+=`📄 **${s}**

`,e.summary){const a=e.summary.length>200?e.summary.substring(0,197)+"...":e.summary;n+=`📝 **Summary:**
${a}

`}e.key_concepts&&e.key_concepts.length>0&&(n+=`💡 **Key Concepts:**
`,e.key_concepts.slice(0,3).forEach(a=>{n+=`• ${a}
`}),n+=`
`),e.target_audience&&(n+=`🎯 **Target Audience:** ${e.target_audience}

`),e.use_cases&&e.use_cases.length>0&&(n+=`💼 **Use Cases:**
`,e.use_cases.slice(0,2).forEach(a=>{n+=`• ${a}
`}),n+=`
`),n+=`📊 **Category:** ${e.category} | **Level:** ${e.difficulty}

`,n+=`🤖 Explore with AI assistance: ${r}

`,n+=`📚 **Discover 1100+ AI & Data Science Documents:**
`,n+=`🌐 https://lonardonifabio.github.io/tech_documents/

`;const l=this.generateHashtags(e);return n+=l,n}async shareWithPreview(e,i,t){const s=`https://lonardonifabio.github.io/tech_documents/document/${e.id}`;if(this.isMobileDevice()&&navigator.share)try{const n={title:e.title||e.filename,text:i,url:s};if(t&&this.supportsFileSharing()){const l=await this.dataUrlToBlob(t),a=new File([l],`${e.id}_preview.jpg`,{type:"image/jpeg"});n.files=[a]}await navigator.share(n)}catch{console.log("Native sharing failed, falling back to LinkedIn URL"),this.openLinkedInShare(s,i)}else this.openLinkedInShare(s,i)}async shareWithDocumentAttachment(e,i){try{const t=await this.downloadDocument(e),s=new File([t],`${e.filename}`,{type:"application/pdf"}),r=await this.previewGenerator.generateDocumentPreview(e),n=await this.dataUrlToBlob(r),l=new File([n],`${e.id}_preview.jpg`,{type:"image/jpeg"});if(navigator.share&&this.supportsFileSharing())await navigator.share({title:e.title||e.filename,text:i,files:[s,l]});else{this.downloadFile(s),this.downloadFile(l);const a=`Files downloaded! To share on LinkedIn:

1. Create a new LinkedIn post
2. Attach the downloaded PDF: ${e.filename}
3. Add the preview image: ${e.id}_preview.jpg
4. Copy and paste this text:

${i}`;alert(a)}}catch(t){console.error("Error sharing with attachment:",t),await this.shareWithPreview(e,i,null)}}async downloadDocument(e){const i=`https://raw.githubusercontent.com/lonardonifabio/tech_documents/main/${e.filepath}`,t=await fetch(i);if(!t.ok)throw new Error(`Failed to download document: ${t.statusText}`);return await t.blob()}async dataUrlToBlob(e){return await(await fetch(e)).blob()}downloadFile(e){const i=URL.createObjectURL(e),t=document.createElement("a");t.href=i,t.download=e.name,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(i)}generateHashtags(e){const i=["#ArtificialIntelligence","#DataScience","#MachineLearning","#AI","#TechResources"],t={AI:["#ArtificialIntelligence","#AIResearch","#AITechnology"],"Machine Learning":["#MachineLearning","#MLAlgorithms","#DeepLearning"],"Data Science":["#DataScience","#DataAnalytics","#BigData"],Business:["#BusinessIntelligence","#DigitalTransformation","#Innovation"],Technology:["#Technology","#TechTrends","#DigitalInnovation"],Research:["#Research","#AcademicResearch","#TechResearch"]};let s=[...i];return t[e.category]&&(s=[...s,...t[e.category]]),e.keywords&&e.keywords.length>0&&e.keywords.slice(0,3).forEach(n=>{const l=n.replace(/[^a-zA-Z0-9]/g,"");l.length>2&&s.push(`#${l}`)}),[...new Set(s)].slice(0,10).join(" ")}openLinkedInShare(e,i){const t=encodeURIComponent(i),r=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(e)}&text=${t}`;this.isMobileDevice()?window.open(r,"_blank"):window.open(r,"_blank","width=600,height=600")}async fallbackShare(e){const i=`https://lonardonifabio.github.io/tech_documents/document/${e.id}`,t=`Check out this AI/Data Science resource: ${e.title||e.filename}

${i}`;this.openLinkedInShare(i,t)}isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}supportsFileSharing(){return"canShare"in navigator&&navigator.canShare({files:[new File([],"test")]})}}const k=({doc:g})=>{const[e,i]=b.useState(null),[t,s]=b.useState(!1),r=async()=>{s(!0);try{const c=await u.getInstance().generateDocumentPreview(g);i(c)}catch(a){console.error("Error generating preview:",a),alert("Failed to generate preview. Please try again.")}finally{s(!1)}},n=async()=>{try{await f.getInstance().shareOnLinkedIn(g,{useCustomPreview:!0,downloadDocument:!1,shareAsAttachment:!1})}catch(a){console.error("Error sharing:",a),alert("Failed to share. Please try again.")}},l=()=>{if(e){const a=document.createElement("a");a.href=e,a.download=`${g.id}_preview.jpg`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}};return o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"🚀 Enhanced LinkedIn Sharing Preview"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Document:"}),o.jsx("p",{className:"text-sm text-gray-600",children:g.title||g.filename}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Category: ",g.category," | Difficulty: ",g.difficulty]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:r,disabled:t,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"🔄 Generating...":"🎨 Generate Custom Preview"}),o.jsx("button",{onClick:n,className:"flex-1 bg-linkedin text-white px-4 py-2 rounded-lg hover:bg-linkedin-dark transition-colors duration-200",children:"📤 Share on LinkedIn"})]}),e&&o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"border rounded-lg overflow-hidden",children:o.jsx("img",{src:e,alt:"Generated preview",className:"w-full h-auto",style:{maxHeight:"315px",objectFit:"contain"}})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:l,className:"flex-1 bg-green-600 text-white px-3 py-2 rounded text-sm hover:bg-green-700 transition-colors duration-200",children:"📥 Download Preview"}),o.jsx("button",{onClick:()=>i(null),className:"flex-1 bg-gray-500 text-white px-3 py-2 rounded text-sm hover:bg-gray-600 transition-colors duration-200",children:"🗑️ Clear Preview"})]})]}),o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"✨ Enhanced Features:"}),o.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[o.jsx("li",{children:"• Custom preview images with document metadata"}),o.jsx("li",{children:"• Category-based color schemes and icons"}),o.jsx("li",{children:"• Enhanced LinkedIn post content with key concepts"}),o.jsx("li",{children:"• Mobile-optimized sharing with native APIs"}),o.jsx("li",{children:"• Document attachment sharing (when supported)"}),o.jsx("li",{children:"• Fallback to standard sharing if needed"})]})]})]})]})};export{k as default};
