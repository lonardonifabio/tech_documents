<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="description" content="This document provides a concise cheat sheet for learning PySpark SQL. It covers fundamental concepts and provides a basic example demonstrating how to create and manipulate dataframes using SparkSession. The key topics include initializing a SparkSession, handling duplicate values, executing que..."><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/tech_documents/favicon.svg"><link rel="manifest" href="/tech_documents/manifest.json"><title>PySpark SQL Basics Cheat Sheet</title><!-- Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-G7VY771Q53"></script><!-- PWA Meta Tags --><!-- <meta name="theme-color" content="#667eea"> --><!-- <meta name="apple-mobile-web-app-capable" content="yes"> --><!-- <meta name="apple-mobile-web-app-status-bar-style" content="default"> --><!-- <meta name="apple-mobile-web-app-title" content="AI Doc Library"> --><!-- Enhanced Open Graph for LinkedIn sharing --><meta property="og:title" content="PySpark SQL Basics Cheat Sheet"><meta property="og:description" content="This document provides a concise cheat sheet for learning PySpark SQL. It covers fundamental concepts and provides a basic example demonstrating how to create and manipulate dataframes using SparkSession. The key topics include initializing a SparkSession, handling duplicate values, executing que..."><meta property="og:type" content="article"><meta property="og:url" content="https://lonardonifabio.github.io/tech_documents/document/1508e1d88f59d1fdb50589a7c584f0a5"><meta property="og:image" content="https://lonardonifabio.github.io/tech_documents/preview/1508e1d88f59d1fdb50589a7c584f0a5.jpg?v=1751961065959"><meta property="og:image:secure_url" content="https://lonardonifabio.github.io/tech_documents/preview/1508e1d88f59d1fdb50589a7c584f0a5.jpg?v=1751961065959"><meta property="og:image:type" content="image/svg+xml"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="og:image:alt" content="PySpark SQL Basics Cheat Sheet - AI &#38; Data Science Document Library"><meta property="og:site_name" content="AI & Data Science Document Library"><meta property="og:locale" content="en_US"><meta property="article:author" content="Fabio Lonardoni"><meta property="article:section" content="AI"><meta property="article:tag" content="PySpark, Spark SQL, SparkSession, DataFrames, SQL, Python, DataCamp"><meta property="article:published_time" content="2025-07-03T22:49:31.873328"><!-- Enhanced Twitter Card --><!-- <meta name="twitter:card" content="summary_large_image"> --><!-- <meta name="twitter:title" content={title}> --><!-- <meta name="twitter:description" content={description}> --><!-- <meta name="twitter:image" content={imageUrl}> --><!-- <meta name="twitter:image:alt" content={`${doc.title || doc.filename} - AI & Data Science Document Library`}> --><!-- <meta name="twitter:site" content="@fabiolonardoni"> --><!-- <meta name="twitter:creator" content="@fabiolonardoni"> --><!-- LinkedIn specific meta tags --><meta property="linkedin:owner" content="Fabio Lonardoni"><!-- Additional meta for mobile sharing --><meta name="author" content="Unknown"><meta name="keywords" content="PySpark, Spark SQL, SparkSession, DataFrames, SQL, Python, DataCamp"><meta name="robots" content="index, follow"><link rel="canonical" href="https://lonardonifabio.github.io/tech_documents/document/1508e1d88f59d1fdb50589a7c584f0a5"><!-- Additional LinkedIn optimization --><meta property="og:rich_attachment" content="true"><!-- Structured Data for better SEO --><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"PySpark SQL Basics Cheat Sheet","description":"This document provides a concise cheat sheet for learning PySpark SQL. It covers fundamental concepts and provides a basic example demonstrating how to create and manipulate dataframes using SparkSession. The key topics include initializing a SparkSession, handling duplicate values, executing que...","author":{"@type":"Person","name":"Unknown"},"publisher":{"@type":"Organization","name":"AI & Data Science Document Library","logo":{"@type":"ImageObject","url":"https://lonardonifabio.github.io/tech_documents/preview/1508e1d88f59d1fdb50589a7c584f0a5.jpg?v=1751961065959"}},"url":"https://lonardonifabio.github.io/tech_documents/document/1508e1d88f59d1fdb50589a7c584f0a5","datePublished":"2025-07-03T22:49:31.873328","image":"https://lonardonifabio.github.io/tech_documents/preview/1508e1d88f59d1fdb50589a7c584f0a5.jpg?v=1751961065959","keywords":"PySpark, Spark SQL, SparkSession, DataFrames, SQL, Python, DataCamp"}</script><!-- Simple redirect script --><script>(function(){const mainAppUrl = "https://lonardonifabio.github.io/tech_documents/?doc=1508e1d88f59d1fdb50589a7c584f0a5";

      // Manual redirect only - no automatic redirects that interfere with crawlers
      if (typeof window !== 'undefined') {
        // Add click handler for manual redirect button
        document.addEventListener('DOMContentLoaded', () => {
          const redirectButton = document.getElementById('manual-redirect');
          if (redirectButton) {
            redirectButton.addEventListener('click', () => {
              window.location.href = mainAppUrl;
            });
          }
        });
      }
    })();</script><link rel="stylesheet" href="/tech_documents/assets/_id_.B2K7fHu1.css">
<style>html{font-family:system-ui,sans-serif}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}::-webkit-scrollbar-thumb:hover{background:#a8a8a8}
</style><script type="module">"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/tech_documents/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})});window.dataLayer=window.dataLayer||[];function a(){dataLayer.push(arguments)}a("js",new Date);a("config","G-G7VY771Q53");
</script></head> <body class="bg-gray-50 min-h-screen"> <!-- Fallback content for crawlers and users with JS disabled --> <div class="max-w-4xl mx-auto p-8"> <div class="bg-white rounded-lg shadow-lg p-6"> <h1 class="text-3xl font-bold text-gray-900 mb-4">PySpark SQL Basics Cheat Sheet</h1> <div class="mb-4"> <p class="text-gray-600"> <strong>Authors:</strong> Unknown </p> </div> <div class="mb-6"> <p class="text-gray-700 leading-relaxed">This document provides a concise cheat sheet for learning PySpark SQL. It covers fundamental concepts and provides a basic example demonstrating how to create and manipulate dataframes using SparkSession. The key topics include initializing a SparkSession, handling duplicate values, executing queries, creating dataframes, adding, updating, and removing columns, outputting data, and stopping the SparkSession. The example showcases how to read data from a text file (&#39;people.txt&#39;), split the lines based on commas, and create a Spark DataFrame with columns for name and age.  It then demonstrates how to add columns for address components (city, postal code, state) to the DataFrame. The document highlights the use of SparkSession for creating dataframes, registering them as tables, and executing SQL queries. It also touches upon the configuration options within SparkSession using `spark.some.config.option` and demonstrates the use of functions from `pyspark.sql` for data manipulation. The example provides a practical illustration of how to perform basic data transformations and aggregations within a PySpark environment. The document is geared towards beginners learning PySpark SQL and provides a quick reference for common operations.</p> </div> <div class="flex flex-wrap gap-2 mb-6"> <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"> PySpark </span><span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"> Spark SQL </span><span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"> SparkSession </span><span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"> DataFrames </span><span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"> SQL </span><span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"> Python </span><span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium"> DataCamp </span> </div> <div class="flex items-center justify-between text-sm text-gray-500 mb-6"> <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full"> AI </span> <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full"> Intermediate </span> </div> <div class="flex gap-4"> <a href="https://lonardonifabio.github.io/tech_documents/?doc=1508e1d88f59d1fdb50589a7c584f0a5" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors">
üîç View in the library powered by AI
</a> </div> <div class="mt-6 p-4 bg-blue-50 rounded-lg"> <p class="text-blue-800 text-sm"> <strong>Note:</strong> This is a static page optimized for social media sharing.
<a href="https://lonardonifabio.github.io/tech_documents/?doc=1508e1d88f59d1fdb50589a7c584f0a5" class="underline font-semibold">Click here to view this document in the interactive library</a>.
</p> </div> </div> </div> <!-- Service Worker Registration -->  </body> </html> 